,identifier,language,code,label
0,146505-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1,146505-v1.0.0,good,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
sqlStatement.executeBatch();
",good
2,147769-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3,147769-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4,147769-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5,147769-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
6,147769-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
7,147769-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
8,146997-v1.0.0,java,"data = request.getParameter(""name"");
",bad
9,146997-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
10,146997-v1.0.0,java,"badSink(data);
",bad
11,146997-v1.0.0,good,"private void badSink(String data) {
    // Assuming the use of a JDBC connection
    String query = ""SELECT * FROM table WHERE column = ?"";
    try (PreparedStatement statement = connection.prepareStatement(query)) {
        statement.setString(1, data);
        // Execute the query
    } catch (SQLException e) {
        // Handle exception
    }
}
",good
12,147721-v1.0.0,java,"data = readerBuffered.readLine();
",bad
13,148028-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_22b()).badSink(data );
",bad
14,148028-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
15,147967-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
16,147967-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
17,147967-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
18,147967-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
19,147967-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
20,147967-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
21,147210-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
22,147210-v1.0.0,good,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Add this line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
23,146206-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
24,146206-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
25,147885-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
26,147885-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
27,147885-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
28,147885-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to the following to prevent SQL injection
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput is a function that sanitizes the input to prevent SQL injection
",good
29,147885-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
30,147885-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
31,146699-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
32,146699-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
33,146699-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
34,146699-v1.0.0,good,"// Validate and sanitize the data before using it in the SQL query
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
35,148162-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
36,148162-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
37,146378-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
38,146378-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
39,147623-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
40,147623-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
41,147623-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
42,147623-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
43,147623-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
44,148289-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
45,148289-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
46,147455-v1.0.0,java,"data = token.substring(3);
",bad
47,147455-v1.0.0,good,"data = request.getParameter(""id"");
",good
48,148226-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
49,148226-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
50,148226-v1.0.0,java,"data = readerBuffered.readLine();
",bad
51,148226-v1.0.0,good,"// Use a PreparedStatement with parameters instead of concatenating the data into the query string
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
52,148226-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
53,148226-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
54,147909-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
55,147909-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
56,146737-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
57,146737-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
58,146737-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_52b()).badSink(data );
",bad
59,146737-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
60,146737-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
61,146737-v1.0.0,good,"// Use a whitelist or a pattern to validate the user input before using it in the SQL query
String pattern = ""^[a-zA-Z0-9]+$"";
if (!data.matches(pattern)) {
    throw new IllegalArgumentException(""Invalid input"");
}
sqlStatement.setString(1, data);
",good
62,147864-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
63,147864-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
64,146544-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
65,146544-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));

// Add a method to sanitize user input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, whitelisting allowed characters, etc.
    // For example, using a library like OWASP's ESAPI could help with this.
}
",good
66,146730-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
67,146730-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
68,146686-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
69,146686-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
70,147122-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
71,147440-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
72,147440-v1.0.0,good,"String id = ""0""; // Assume this value comes from user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
73,147440-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
74,147440-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
75,147440-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_22b()).goodB2G2Sink(data );
",bad
76,147440-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
77,147604-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_22b()).badSink(data);
",bad
78,147604-v1.0.0,good,"public void badSink(Connection conn, String data) throws SQLException {
    String sql = ""SELECT * FROM table WHERE column = ?"";
    PreparedStatement stmt = conn.prepareStatement(sql);
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process results
    stmt.close();
}
",good
79,147985-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_22b()).goodB2G1Sink(data );
",bad
80,146727-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
81,146727-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    pstmt.setString(1, names[i]);
    pstmt.addBatch();
}
int resultsArray[] = pstmt.executeBatch();
",good
82,148352-v1.0.0,java,"data = readerBuffered.readLine();
",bad
83,148352-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
84,148326-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
85,148326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
86,148326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
87,148326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
// Validate and sanitize the data before using it in the prepared statement
data = sanitizeInput(data);
sqlStatement.setString(1, data);
",good
88,148326-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
89,148326-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
90,146217-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
91,146217-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
92,146217-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
93,146217-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
94,146217-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
95,146217-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
96,146354-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
97,146354-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
98,148299-v1.0.0,java,"baseObject.action(data);
",bad
99,148299-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_71b()).badSink((Object)data);
",bad
100,140883-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
101,140883-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
102,147355-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
103,147355-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
104,146674-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
105,146674-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
106,147874-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
107,147874-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
108,147191-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
109,147659-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
110,147659-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
111,147659-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
112,147659-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
113,147659-v1.0.0,good,"// Use a whitelist or other input validation to ensure that the data variable only contains safe input
String safeData = validateInput(data);
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, safeData);
",good
114,146429-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
115,146429-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
116,147047-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
117,148187-v1.0.0,java,"data = request.getParameter(""name"");
baseObject.action(data , request, response);
",bad
118,148187-v1.0.0,good,"public void action(String data, HttpServletRequest request, HttpServletResponse response) throws SQLException {
    String sql = ""SELECT * FROM users WHERE name = ?"";
    try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
         PreparedStatement pstmt = conn.prepareStatement(sql)) {
        pstmt.setString(1, data);
        ResultSet rs = pstmt.executeQuery();
        // process result set
    }
}
",good
119,148187-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
120,148187-v1.0.0,good,"// Instead of using the first cookie value, loop through all cookies and validate/sanitize each value before using it.
for (Cookie cookie : cookieSources) {
    String value = cookie.getValue();
    // Validate and sanitize the value here before using it in a SQL query.
    // For example, you could use a prepared statement with parameterized queries.
}
",good
121,148187-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_67b()).badSink(dataContainer , request, response );
",bad
122,148187-v1.0.0,good,"// Use getParameter() method to retrieve the 'id' parameter
String id = request.getParameter(""id"");

// Validate and sanitize the 'id' parameter before using it in a SQL query
// This can be done using prepared statements or other methods to prevent SQL injection

// Example using prepared statements
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, id);
ResultSet rs = pstmt.executeQuery();
",good
123,148198-v1.0.0,java,"data = request.getParameter(""name"");
",bad
124,148198-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
125,147185-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
126,147185-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
127,147185-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
128,147185-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
129,147185-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
130,147185-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
131,147891-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
132,147891-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
133,147891-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
134,147891-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
135,147891-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
136,147112-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
137,147112-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
138,147112-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
139,147112-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
140,147112-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
141,147112-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
142,148020-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
143,148020-v1.0.0,good,"String id = request.getParameter(""id"");
data = id != null ? id : """";
",good
144,140885-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
145,146186-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
146,146186-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
147,146186-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
148,146186-v1.0.0,good,"String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
149,146186-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
150,146186-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
151,146639-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
152,146639-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
153,146639-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
154,146639-v1.0.0,good,"// Validate and sanitize the input
String names[] = data.split(""-"");
for (int i = 0; i < names.length; i++) {
    names[i] = sanitizeInput(names[i]);
}
...
sqlStatement.setString(1, names[i]);
",good
155,146639-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
156,146639-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
157,146932-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
158,146932-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
159,146406-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
160,146406-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
161,146406-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
162,146406-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
163,146406-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
164,146406-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
165,148246-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
166,148246-v1.0.0,good,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is sanitized or validated before using it in the SQL query
",good
167,147231-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
168,147231-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
sqlStatement.executeBatch();
",good
169,147231-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
170,147231-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
171,147231-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
172,147231-v1.0.0,good,"// Validate and sanitize the input to prevent SQL injection
String[] names = data.split(""-"");
for (int i = 0; i < names.length; i++) {
    names[i] = names[i].replaceAll(""[^a-zA-Z0-9_-]"", """"); // Remove any non-alphanumeric characters except underscore and hyphen
}
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
173,148219-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_75b()).badSink(dataSerialized);
",bad
174,148219-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_71b()).badSink((Object)data);
",bad
175,148219-v1.0.0,java,"goodB2G2Sink(data);
",bad
176,148219-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
177,146754-v1.0.0,java,"data = readerBuffered.readLine();
",bad
178,147965-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_53b()).badSink(data );
",bad
179,147965-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens()) {
    String token = tokenizer.nextToken();
    if(token.startsWith(""id="")) {
        data = token.substring(3);
        break;
    }
}
",bad
180,147965-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
181,147965-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
182,147965-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
183,147194-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken(); /* a token will be like ""id=foo"" */
    if(token.startsWith(""id="")) /* check if we have the ""id"" parameter"" */
    {
        data = token.substring(3); /* set data to ""foo"" */
        break; /* exit while loop */
    }
}
",bad
184,147194-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
185,147194-v1.0.0,java,"dataArray[2] = data;
(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_66b()).badSink(dataArray , request, response );
",bad
186,147194-v1.0.0,good,"// Use a PreparedStatement to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table_name (column1, column2, column3) VALUES (?, ?, ?)"");
pstmt.setString(1, dataArray[0]);
pstmt.setString(2, dataArray[1]);
pstmt.setString(3, dataArray[2]);
pstmt.executeUpdate();
",good
187,147194-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
188,147194-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
189,147334-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
190,147334-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
191,147334-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
192,147334-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
193,147334-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
194,147334-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
195,146350-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
196,146350-v1.0.0,good,"PreparedStatement preparedStatement = null;
ResultSet resultSet = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
    preparedStatement.setString(1, data);
    resultSet = preparedStatement.executeQuery();
    IO.writeLine(resultSet.getRow());
}
catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
}
finally {
    // Close resources...
}
",good
197,146315-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
198,146315-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change to the following to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
199,146161-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
200,146161-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (String name : names) {
    sqlStatement.setString(1, sanitizeInput(name));
    sqlStatement.addBatch();
}
",good
201,147918-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
202,147918-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
203,147918-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement.setString(1, names[i]);
",bad
204,147918-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement.setString(1, names[i].replaceAll(""'"", ""''""));
",good
205,147918-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
206,147918-v1.0.0,good,"if (cookieSources != null && cookieSources.length > 0) {
    data = cookieSources[0].getValue();
    // Validate and sanitize the input
    if (!isValidInput(data)) {
        // Handle invalid input
    }
}
",good
207,147040-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
208,147040-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
209,147040-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_52b()).badSink(data );
",bad
210,147040-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // Process result set
} catch (SQLException e) {
    // Handle exception
} finally {
    // Close statement and connection
}
",good
211,147040-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
212,147040-v1.0.0,good,"// Validate and sanitize the data before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
data = sanitizedData;
",good
213,146422-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_51b()).badSink(data);
",bad
214,146422-v1.0.0,good,"PreparedStatement stmt = null;
try {
    stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    stmt.setString(1, data);
    stmt.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (stmt != null) {
        stmt.close();
    }
}
",good
215,146294-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_51b()).badSink(data);
",bad
216,146294-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
217,146294-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
218,146294-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
219,146294-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
220,146590-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
221,146590-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
222,146590-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add the following line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
223,146590-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
224,146590-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
225,146288-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
226,146288-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
227,146675-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_71b()).badSink((Object)data);
",bad
228,146675-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
229,146675-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
230,146675-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
231,147121-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
232,146732-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
233,146732-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
234,147201-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
235,147201-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
236,146896-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
237,146896-v1.0.0,good,"String sanitizedData = new HtmlSanitizer().sanitize(data);
sqlStatement.setString(1, sanitizedData);
",good
238,148111-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
239,148111-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
240,148111-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
241,148111-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
242,148111-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
243,148111-v1.0.0,good,"// Use a whitelist or validation to ensure that the names array only contains valid names.
// For example, you could use a regular expression to ensure that the names only contain alphanumeric characters.
String pattern = ""^[a-zA-Z0-9]+$"";
for (int i = 0; i < names.length; i++) {
    if (names[i].matches(pattern)) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    } else {
        // Handle invalid input
    }
}
",good
244,148159-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_73b()).badSink(dataLinkedList);
",bad
245,148159-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
statement.setString(1, data);
statement.executeUpdate();
",good
246,146795-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_66b()).badSink(dataArray);
",bad
247,147150-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_75b()).badSink(dataSerialized);
",bad
248,148333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
249,148333-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
250,148333-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
251,148333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
252,147728-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_68b()).badSink();
",bad
253,147184-v1.0.0,java,"data = token.substring(3);
",bad
254,147184-v1.0.0,good,"data = request.getParameter(""id"");
",good
255,147184-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
256,147184-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
257,147184-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
258,147184-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
259,147815-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
260,147815-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
261,147815-v1.0.0,java,"data = readerBuffered.readLine();
",bad
262,147815-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
263,147815-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
264,147815-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
265,146915-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
266,146915-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
267,147049-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
268,147049-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, java.net.URLDecoder.decode(data, ""UTF-8""));
",good
269,146181-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
270,146181-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
271,146181-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
272,146181-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
273,146181-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
274,146799-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
275,146799-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
276,146440-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_execute_51b()).badSink(data , request, response );
",bad
277,146440-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
// Process the result set...
",good
278,146440-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
279,146440-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
280,146440-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
281,146440-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
282,146946-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
283,146946-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
284,146267-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
285,146267-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
286,146750-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
287,146750-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
288,146750-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
289,146750-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
290,146750-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_51b()).badSink(data);
",bad
291,146811-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
292,146811-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
293,146592-v1.0.0,java,"data = readerBuffered.readLine();
",bad
294,146592-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
295,146592-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
296,147146-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
297,147146-v1.0.0,good,"// Validate and sanitize the cookie value before assigning it to the data variable
if (cookieSources != null && cookieSources.length > 0) {
    String cookieValue = cookieSources[0].getValue();
    // Add validation and sanitization logic here
    data = sanitizeInput(cookieValue);
}
",good
298,147146-v1.0.0,java,"data = token.substring(3);
",bad
299,147146-v1.0.0,good,"data = request.getParameter(""id"");
",good
300,147146-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__listen_tcp_executeUpdate_66b()).badSink(dataArray);
",bad
301,147146-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
statement.setString(1, data);
statement.executeUpdate();
",good
302,146224-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_54b()).badSink(data );
",bad
303,146224-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
304,146224-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
305,146151-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
306,146151-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
307,140912-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
308,140912-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
309,146976-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
310,146976-v1.0.0,good,"// Validate and sanitize the data variable before using it in the query
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
311,147456-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
312,147456-v1.0.0,good,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Add this line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
313,147710-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
314,147710-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
315,147143-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
316,147143-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
317,147143-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
318,147143-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
319,147893-v1.0.0,java,"String data = System.getenv(""ADD"");
String names[] = data.split(""-"");
PreparedStatement sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
320,147893-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
321,147893-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_52b()).badSink(data );
",bad
322,147893-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
323,147893-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
324,146849-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
325,146849-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
326,146849-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
327,146849-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
328,146849-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__console_readLine_executeBatch_67b()).badSink(dataContainer);
",bad
329,146849-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String sql = ""INSERT INTO table_name (column_name) VALUES (?)"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
330,147690-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
331,147314-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
332,147314-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
333,148170-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
334,148084-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
335,148084-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
336,147139-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
337,147139-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
338,147914-v1.0.0,java,"data = token.substring(3);
",bad
339,147914-v1.0.0,good,"data = request.getParameter(""id"");
",good
340,146343-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_22b()).goodB2G2Sink(data );
",bad
341,146343-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
342,146343-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_22b()).badSink(data);
",bad
343,146343-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
344,146343-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_22b()).goodB2G1Sink(data );
",bad
345,147120-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
346,147120-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
",good
347,147120-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
348,147120-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
349,147120-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
350,147120-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
351,147610-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_51b()).badSink(data);
",bad
352,147610-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    Connection connection = /* obtain database connection */;
    String sql = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
353,148022-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
354,148022-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
355,147062-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
356,147062-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
357,146408-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
358,146408-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
359,146408-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
360,146408-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
361,146408-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
362,146408-v1.0.0,good,"String id = ""0""; // This should be replaced with the actual user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
363,147034-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
364,147034-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
365,147034-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
366,147034-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
367,147034-v1.0.0,java,"data = System.getenv(""ADD"");
(new CWE89_SQL_Injection__Environment_prepareStatement_68b()).badSink();
",bad
368,147668-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
369,147668-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
370,147149-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
371,147149-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
372,147149-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
373,147149-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
374,147149-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
375,147149-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
376,147725-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
377,147725-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change the above line to the following to prevent SQL injection
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput is a function that removes or escapes any SQL special characters from the input.
",good
378,146796-v1.0.0,java,"data = token.substring(3);
",bad
379,146796-v1.0.0,good,"data = request.getParameter(""id"");
",good
380,147401-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_75b()).badSink(dataSerialized);
",bad
381,147401-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
382,147401-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
383,147401-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
384,147431-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
385,146523-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_72b()).badSink(dataVector);
",bad
386,146523-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
387,146523-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
388,146523-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
389,146412-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
390,146412-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
391,146412-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
392,146412-v1.0.0,good,"// Use PreparedStatement with placeholders to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
393,146412-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
394,146412-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
395,147811-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
396,147811-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
397,147811-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
398,147811-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
399,147811-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_51b()).badSink(data);
",bad
400,147811-v1.0.0,good,"PreparedStatement preparedStatement = null;
String query = ""SELECT * FROM table WHERE column = ?"";
try {
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
401,148077-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
402,148077-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
403,148077-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
404,148077-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
405,148272-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
406,148272-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
407,146940-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
408,146940-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
409,146923-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
410,146923-v1.0.0,good,"// Validate and sanitize the data before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
411,146923-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
412,146923-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
413,146923-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
414,146923-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
415,147809-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
416,147809-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
417,147809-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
418,147809-v1.0.0,good,"sqlStatement.setString(1, StringEscapeUtils.escapeSql(names[i]));
",good
419,147809-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
420,147809-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
421,147643-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
422,147884-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_51b()).badSink(data);
",bad
423,147884-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
424,147884-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
425,147884-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_67b()).badSink(dataContainer);
",bad
426,147884-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
preparedStatement.setString(1, data);
preparedStatement.executeUpdate();
",good
427,147943-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_72b()).badSink(dataVector);
",bad
428,140916-v1.0.0,java,"data = token.substring(3);
",bad
429,140916-v1.0.0,good,"data = request.getParameter(""id"");
",good
430,146569-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
431,146569-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
432,146507-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
433,146507-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
434,147013-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
435,147256-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
436,147256-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
437,147256-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
438,147256-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
439,147256-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
440,147492-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
441,147492-v1.0.0,good,"// Escape the data variable to prevent SQL injection
String escapedData = escapeSql(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, escapedData);
",good
442,147486-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
443,147486-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
444,147486-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
445,147486-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
446,147486-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
447,147486-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
448,147689-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
449,147689-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
450,147882-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
451,147882-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
452,147882-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_54b()).badSink(data );
",bad
453,147882-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""INSERT INTO table (column) VALUES (?)"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    statement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    // Close statement
}
",good
454,147882-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_52b()).badSink(data );
",bad
455,147867-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_73b()).badSink(dataLinkedList);
",bad
456,147952-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
457,147952-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
458,147152-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
459,147152-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
460,147152-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
461,147152-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
462,147152-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
463,147420-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
464,147420-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
465,147729-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
466,140894-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
467,147745-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
468,147745-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
469,147745-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
470,147745-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""['\"";-]"", """"));
",good
471,146469-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
472,146469-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
473,146595-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
474,146595-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
475,147336-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_74b()).badSink(dataHashMap);
",bad
476,147336-v1.0.0,java,"data = request.getParameter(""id"");
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
477,147336-v1.0.0,good,"try {
    id = Integer.parseInt(data);
    preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
    preparedStatement.setInt(1, id);
    resultSet = preparedStatement.executeQuery();
    IO.writeString(""bad() - result requested: "" + data +""\n"");
} catch (NumberFormatException nfx) {
    // Handle the error appropriately, e.g. by returning an error response to the user
    response.sendError(HttpServletResponse.SC_BAD_REQUEST, ""Invalid id parameter"");
}
",good
478,147336-v1.0.0,java,"goodB2G2Sink(data);
",bad
479,146688-v1.0.0,java,"data = request.getParameter(""name"");
",bad
480,146688-v1.0.0,good,"String data = request.getParameter(""name"");
if (data != null) {
    data = data.replaceAll(""[';\\-]"", """"); // Remove any single quotes, semicolons, or hyphens
}
(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_51b()).badSink(data , request, response );
",good
481,146903-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
482,146903-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
483,147008-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
484,147008-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
485,147008-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
486,147008-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
487,147008-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
488,147008-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
489,147006-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
490,147006-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
491,147097-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
492,147097-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
493,147700-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
494,147700-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
495,147700-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
496,147700-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
497,147700-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
498,147700-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
499,146543-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
500,146543-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
501,146985-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
502,146154-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_53b()).badSink(data );
",bad
503,146154-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    Connection connection = DriverManager.getConnection(url, username, password);
    String sql = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    try {
        if (preparedStatement != null) {
            preparedStatement.close();
        }
    } catch (SQLException e) {
        // handle exception
    }
}
",good
504,146154-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
505,146154-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
506,146154-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
507,146154-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""UPDATE users SET status = ? WHERE name = ?"");
    preparedStatement.setString(1, ""updated"");
    preparedStatement.setString(2, data);

    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
// ... rest of the code
",good
508,147640-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
509,147640-v1.0.0,good,"// Validate and sanitize the cookie value before using it
String cookieValue = cookieSources[0].getValue();
// Use a library or method to validate and sanitize the input
String sanitizedValue = sanitizeInput(cookieValue);
data = sanitizedValue;
",good
510,147886-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
511,147886-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
512,147886-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
513,147886-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
514,147886-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
515,147226-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
516,147226-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
517,147226-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
518,147226-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
519,147226-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
520,147226-v1.0.0,good,"String id = ""0""; // Assume this value is coming from a safe source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
521,146247-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
522,146247-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
523,148210-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
524,148210-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
525,148082-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_53b()).badSink(data );
",bad
526,148082-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
527,148082-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowsAffected = preparedStatement.executeUpdate();
    if(rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error executing SQL statement"", exceptSql);
} finally {
    // Close resources...
}
",good
528,148082-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
529,148082-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
530,147257-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
531,147257-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // ... rest of the code
}
// ... rest of the code
",good
532,147257-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
533,147257-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int[] resultsArray = sqlStatement.executeBatch();
",good
534,147257-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
535,147257-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (name, status) values (?, 'updated')"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
536,147361-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
537,147361-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
538,147042-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
539,147042-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
540,147042-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_53b()).badSink(data );
",bad
541,147042-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_54b()).badSink(data);
",bad
542,147042-v1.0.0,good,"String data = System.getProperty(""user.home"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
543,147182-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_73b()).badSink(dataLinkedList);
",bad
544,147182-v1.0.0,good,"String query = ""INSERT INTO table (column) VALUES (?)"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    pstmt.executeUpdate();
} catch (SQLException e) {
    e.printStackTrace();
}
",good
545,147182-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
546,147182-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
547,147677-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_execute_74b()).badSink(dataHashMap , request, response );
",bad
548,147677-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
549,148338-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
550,148338-v1.0.0,good,"// Use a whitelist or a more secure method to validate and sanitize the 'data' variable before using it in the SQL query.
// This could be done using regular expressions, a library function, or a custom validation method.
// For example, you could use a regular expression to ensure that 'data' only contains alphanumeric characters and underscores.
String sanitizedData = data.replaceAll(""[^a-zA-Z0-9_]"", """");
sqlStatement.setString(1, sanitizedData);
",good
551,146834-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
552,146834-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
553,147342-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
554,147342-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
555,147342-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
556,147342-v1.0.0,good,"// Validate and sanitize the data before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
data = sanitizedData;
",good
557,147342-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_22b()).goodB2G2Sink(data );
",bad
558,147342-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
559,147634-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_22b()).badSink(data );
",bad
560,147634-v1.0.0,good,"Connection conn = null;
PreparedStatement stmt = null;
ResultSet rs = null;
try {
    conn = DriverManager.getConnection(""jdbc:mysql://host.example.org:39544/database"", ""username"", ""password"");
    stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    stmt.setString(1, data);
    rs = stmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
561,147634-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_22b()).goodB2G1Sink(data );
",bad
562,147634-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
563,147634-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_52b()).badSink(data );
",bad
564,146810-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
565,146810-v1.0.0,good,"int id = 0; // This value should be dynamically set
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
566,146810-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
567,146810-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
568,146810-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
569,146810-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
570,140884-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_22b()).goodB2G2Sink(data );
",bad
571,140884-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
572,146420-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_22b()).badSink(data);
",bad
573,146420-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    if (statement != null) {
        statement.close();
    }
}
",good
574,147435-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_22b()).goodB2G1Sink(data );
",bad
575,147435-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
576,148160-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_72b()).badSink(dataVector , request, response );
",bad
577,148160-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
578,146860-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__console_readLine_prepareStatement_66b()).badSink(dataArray);
",bad
579,146860-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
preparedStatement.setString(1, data);
preparedStatement.executeUpdate();
",good
580,146860-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
581,146860-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
582,146860-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
583,146860-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
584,148029-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
585,148029-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""'"", ""''""));
",good
586,148029-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
587,148029-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
588,148029-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_22b()).goodB2G2Sink(data );
",bad
589,148029-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
590,146556-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_22b()).badSink(data);
",bad
591,146556-v1.0.0,good,"public void good() throws Throwable {
    String data = System.getProperty(""user.home"");
    badPublicStatic = true;
    (new CWE89_SQL_Injection__Property_prepareStatement_22b()).goodSink(data);
}

// In the goodSink method
public void goodSink(String data) throws Throwable {
    Connection connection = DriverManager.getConnection(DB_URL, USER, PASS);
    PreparedStatement statement = connection.prepareStatement(""SELECT * FROM users WHERE home = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // Process result set
}
",good
592,146556-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_22b()).goodB2G1Sink(data);
",bad
593,146556-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
594,147233-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
595,147233-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
596,147272-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_74b()).badSink(dataHashMap , request, response );
",bad
597,146547-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
598,146547-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
599,147428-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
600,147428-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
601,140888-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
602,140888-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
603,147951-v1.0.0,java,"data = token.substring(3);
",bad
604,147951-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null && !id.isEmpty()) {
    data = id;
}
",good
605,147569-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
606,147569-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
607,146944-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
608,146944-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
609,147626-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
610,147626-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
611,147626-v1.0.0,java,"data = readerBuffered.readLine();
(new CWE89_SQL_Injection__listen_tcp_prepareStatement_67b()).badSink(dataContainer);
",bad
612,147626-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""INSERT INTO table (column) VALUES (?)"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    statement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    // Close statement and connection
}
",good
613,147626-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
614,147626-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
615,146458-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
616,146458-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
617,148036-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
618,148036-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
619,148036-v1.0.0,java,"data = request.getParameter(""name"");
",bad
620,148036-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
621,148036-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
622,148036-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
623,147712-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
624,147712-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
625,147712-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
626,147712-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
627,147712-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
628,147712-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
629,146633-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
630,146633-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
631,146633-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
632,146633-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
633,146633-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
634,146633-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
635,146826-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
636,146826-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
637,146868-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
638,146868-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
639,147585-v1.0.0,java,"data = properties.getProperty(""data"");
baseObject.action(data);
",bad
640,147585-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response );
",bad
641,147585-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement statement = connection.prepareStatement(""SELECT * FROM users WHERE name = ?"");
statement.setString(1, name);
ResultSet resultSet = statement.executeQuery();
",good
642,147585-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
643,147585-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add input validation to ensure data does not contain malicious SQL code
",good
644,147379-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
645,147379-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
646,147379-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
647,147379-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
648,147379-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_53b()).badSink(data );
",bad
649,147379-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
650,147701-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
651,147701-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that sanitizes the input to prevent SQL injection.
",good
652,147701-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
653,147701-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
654,147701-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
655,147701-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
656,147433-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
657,147654-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
658,147654-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
659,148224-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
660,148224-v1.0.0,good,"String sanitizedData = data.replace(""'"", ""''"");
sqlStatement.setString(1, sanitizedData);
",good
661,148224-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_51b()).badSink(data);
",bad
662,148224-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
663,148224-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
664,148224-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
665,146645-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
666,146645-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
667,147222-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
668,147222-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
669,147222-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
670,147222-v1.0.0,good,"String id = ""0""; // This value should come from a safe source, such as a validated user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
671,147222-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_54b()).badSink(data);
",bad
672,147222-v1.0.0,good,"public void good() throws Throwable {
    String data;

    /* get system property user.home */
    data = System.getProperty(""user.home"");

    /* Use a parameterized query to prevent SQL injection */
    String query = ""SELECT * FROM table WHERE column = ?"";
    PreparedStatement stmt = connection.prepareStatement(query);
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // Process the result set
}
",good
673,147972-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
674,147972-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
675,146516-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
676,146516-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
677,146516-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
678,146516-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
679,146516-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
680,146516-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
681,147259-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
682,147259-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
683,147259-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
684,147259-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
685,147259-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
686,147259-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
687,146752-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
688,146752-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
689,147039-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
690,147039-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
691,147332-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_75b()).badSink(dataSerialized , request, response );
",bad
692,147332-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
693,147332-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
    preparedStatement.setString(1, data);
    resultSet = preparedStatement.executeQuery();
    // Rest of the code...
}
// Rest of the code...
",good
694,146717-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
695,146717-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or escaped before inserting into the query
",good
696,146950-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
697,146950-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
698,146250-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
699,146250-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
700,147617-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
701,147617-v1.0.0,good,"String id = request.getParameter(""id"");
",good
702,147167-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
703,147167-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
704,146230-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
705,146230-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    try {
        dbConnection = IO.getDBConnection();
        sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
        sqlStatement.setString(1, id);
        resultSet = sqlStatement.executeQuery();
        IO.writeLine(resultSet.getRow());
    }
    catch (SQLException exceptSql) {
        IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
    }
    // ... rest of the code
}
",good
706,148329-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
707,148329-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
708,148329-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
709,148329-v1.0.0,java,"data = System.getenv(""ADD"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
710,148329-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
711,146534-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_22b()).goodB2G2Sink(data);
",bad
712,146899-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_22b()).badSink(data );
",bad
713,148067-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_22b()).goodB2G1Sink(data );
",bad
714,148067-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
715,148067-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
716,148067-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
717,148067-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
718,146284-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
719,146284-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
720,148242-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
721,148242-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
722,146906-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
723,147381-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
724,147381-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
725,147055-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
726,147028-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
727,147028-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
728,147750-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
729,147750-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
730,146681-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
731,146681-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
732,146914-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
733,147482-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
734,147482-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
735,147482-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
736,147482-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
737,147482-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
738,147628-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
739,147628-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
740,147628-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
741,147628-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
742,147628-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
743,147628-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
744,147130-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
745,147130-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE cookie_value = ?"");
pstmt.setString(1, cookieSources[0].getValue());
",good
746,147466-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_72b()).badSink(dataVector);
",bad
747,147955-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
748,147955-v1.0.0,good,"Pattern pattern = Pattern.compile(""[a-zA-Z0-9_-]+"");
for (int i = 0; i < names.length; i++) {
    if (pattern.matcher(names[i]).matches()) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    } else {
        // log or handle invalid input
    }
}
",good
749,147955-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
750,147955-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
751,147955-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
752,147632-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
753,147632-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
754,147632-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
755,147632-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
756,147632-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
757,148083-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
758,148083-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""expectedCookieName"")) {
        data = cookie.getValue();
        break;
    }
}
",good
759,140903-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
760,140903-v1.0.0,good,"// Validate and sanitize the cookie value before using it
String data = """";
Cookie[] cookies = request.getCookies();
if (cookies != null) {
    for (Cookie cookie : cookies) {
        if (cookie.getName().equals(""desired_cookie_name"")) {
            data = sanitizeInput(cookie.getValue());
            break;
        }
    }
}
",good
761,146862-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
762,146862-v1.0.0,good,"String data = """";

Cookie[] cookies = request.getCookies();
if (cookies != null) {
    for (Cookie cookie : cookies) {
        if (cookie.getName().equals(""desired_cookie_name"")) {
            data = cookie.getValue();
            // Validate or sanitize the input here
            break;
        }
    }
}

// Use parameterized queries or prepared statements to prevent SQL injection
String sql = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(sql);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
763,147622-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
764,147622-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
765,147622-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
766,147622-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
767,147622-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
768,147622-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
769,147717-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
770,147717-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
771,146610-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
772,146610-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
773,147399-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
774,147399-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add input validation to ensure data is safe for SQL query
if (!isValidInput(data)) {
    throw new IllegalArgumentException(""Invalid input"");
}
",good
775,147399-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_51b()).badSink(data);
",bad
776,147399-v1.0.0,good,"// Use prepared statements or parameterized queries to avoid SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
777,147399-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
778,147399-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
779,148080-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
780,148080-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
781,147923-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
782,147923-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
783,147923-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
784,147923-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
785,147923-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
786,147923-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
787,147214-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
788,147214-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
789,147214-v1.0.0,java,"data = token.substring(3);
",bad
790,147214-v1.0.0,good,"data = request.getParameter(""id"");
",good
791,147214-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_54b()).badSink(data );
",bad
792,147214-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
793,148216-v1.0.0,java,"baseObject.action(data);
",bad
794,148216-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
795,148216-v1.0.0,good,"data = request.getParameter(""name"");
// Escape special characters to prevent SQL injection
data = java.sql.DriverManager.getConnection(dbUrl).prepareStatement("""").quote(data);
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
796,146193-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
797,146193-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
798,148146-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
799,148146-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
800,148146-v1.0.0,java,"data = token.substring(3);
",bad
801,148146-v1.0.0,good,"data = request.getParameter(""id"");
",good
802,147948-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_72b()).badSink(dataVector);
",bad
803,147838-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
804,147838-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
805,146322-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
806,146322-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
807,148322-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
808,148322-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
809,147339-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
810,147339-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
811,148238-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
812,148238-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped to prevent SQL injection
sqlStatement.setString(1, java.sql.DriverManager.getConnection(""jdbc:mysql://localhost:3306/test"", ""user"", ""password"").prepareStatement(""SELECT ?"").setString(1, data).toString());
",good
813,147335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
814,147335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
815,146845-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
816,146845-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped to prevent SQL injection
data = java.sql.DriverManager.getConnection(dbUrl).prepareStatement(""SELECT ?"").setString(1, data).getMoreResults().getStatement().getConnection().nativeSQL(data);
sqlStatement.setString(1, data);
",good
817,146845-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
818,146845-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
819,146845-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
820,146845-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
821,147992-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
822,147992-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
823,147992-v1.0.0,java,"data = request.getParameter(""id"");
",bad
824,147992-v1.0.0,good,"String id = request.getParameter(""id"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE id = ?"");
pstmt.setString(1, id);
ResultSet rs = pstmt.executeQuery();
",good
825,147992-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
826,147992-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
827,146634-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
828,146634-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add this line to sanitize the input
data = data.replace(""'"", ""''"");
",good
829,146634-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
830,146634-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
831,146634-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
832,146634-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
833,147198-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
834,147198-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
835,147787-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
836,147787-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
837,147103-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
838,147103-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
839,147103-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
840,147103-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
841,147103-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
842,147419-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
843,147419-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
844,146967-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
845,146967-v1.0.0,good,"sqlStatement.setString(1, data);
",good
846,146967-v1.0.0,java,"data = System.getenv(""ADD"");
baseObject.action(data);
",bad
847,146967-v1.0.0,good,"public void action(String data) throws SQLException {
    String query = ""SELECT * FROM table WHERE column = ?"";
    PreparedStatement statement = connection.prepareStatement(query);
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
}
",good
848,146967-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_execute_73b()).badSink(dataLinkedList , request, response );
",bad
849,146588-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
850,146588-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""data"")) {
        data = cookie.getValue();
        break;
    }
}
",good
851,146588-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
852,146588-v1.0.0,good,"if (cookieSources != null && cookieSources.length > 0) {
    String cookieName = ""your_cookie_name""; // replace with the actual cookie name
    for (Cookie cookie : cookieSources) {
        if (cookie.getName().equals(cookieName)) {
            data = cookie.getValue();
            break;
        }
    }
}
",good
853,146588-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
854,146588-v1.0.0,good,"// Use a loop to find the specific cookie you need instead of getting the first cookie
for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""yourCookieName"")) {
        data = cookie.getValue();
        break;
    }
}
",good
855,147716-v1.0.0,java,"baseObject.action(data);
",bad
856,146577-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
857,146577-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
858,147651-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
859,147651-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
860,148048-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
861,148048-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
862,147602-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
863,147602-v1.0.0,good,"// Use a whitelist or validation to ensure that the data is safe to use in the SQL statement
String safeData = validate(request.getParameter(""name""));
sqlStatement.setString(1, safeData);
",good
864,146424-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response );
",bad
865,146424-v1.0.0,good,"String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
866,148330-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
867,148330-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
868,148330-v1.0.0,java,"data = token.substring(3);
",bad
869,148330-v1.0.0,good,"data = request.getParameter(""id"");
",good
870,148330-v1.0.0,java,"data = token.substring(3);
",bad
871,148330-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
872,148013-v1.0.0,java,"data = token.substring(3);
",bad
873,148013-v1.0.0,good,"data = request.getParameter(""id"");
",good
874,146574-v1.0.0,java,"data = token.substring(3);
",bad
875,146574-v1.0.0,good,"data = request.getParameter(""id"");
",good
876,146173-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
877,146173-v1.0.0,good,"// Validate and sanitize the data before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
data = sanitizedData;
",good
878,147922-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_68b()).badSink();
",bad
879,147922-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
880,147922-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
881,147922-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
882,147922-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
883,148186-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
884,148186-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
885,147126-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
886,147126-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
887,147105-v1.0.0,java,"data = readerBuffered.readLine();
...
(new CWE89_SQL_Injection__listen_tcp_execute_67b()).badSink(dataContainer);
",bad
888,147105-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
889,147105-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
890,147344-v1.0.0,java,"baseObject.action(data);
",bad
891,147344-v1.0.0,good,"public void action(String data) throws SQLException {
    String sql = ""SELECT * FROM users WHERE username = ?"";
    try (PreparedStatement statement = connection.prepareStatement(sql)) {
        statement.setString(1, data);
        ResultSet resultSet = statement.executeQuery();
        // process result set
    }
}
",good
892,146537-v1.0.0,java,"data = token.substring(3);
",bad
893,146537-v1.0.0,good,"data = request.getParameter(""id"");
",good
894,147578-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_54b()).badSink(data );
",bad
895,147578-v1.0.0,good,"PreparedStatement pstmt = null;
try {
    pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // ...
} catch (SQLException e) {
    // ...
} finally {
    if (pstmt != null) {
        pstmt.close();
    }
}
",good
896,147180-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_54b()).badSink(data );
",bad
897,147180-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process results
} catch (SQLException e) {
    e.printStackTrace();
}
",good
898,147180-v1.0.0,java,"data = System.getenv(""ADD"");
(new CWE89_SQL_Injection__Environment_prepareStatement_71b()).badSink((Object)data);
",bad
899,147180-v1.0.0,good,"String data = System.getenv(""ADD"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
900,147180-v1.0.0,java,"String data = token.substring(3);
sqlStatement.setString(1, data);
",bad
901,147180-v1.0.0,good,"String data = request.getParameter(""id"");
sqlStatement.setString(1, data);
",good
902,146830-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
903,146830-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
904,148051-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
905,148051-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
906,148121-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
907,148121-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
908,147188-v1.0.0,java,"data = request.getParameter(""name"");
",bad
909,147188-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
910,147188-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
911,147188-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
912,147188-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    pstmt.setString(1, names[i]);
    pstmt.addBatch();
}
int resultsArray[] = pstmt.executeBatch();
",good
913,148116-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
914,147680-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
915,147680-v1.0.0,good,"sqlStatement.setString(1, sanitizeInput(data));
",good
916,147850-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
917,147850-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
918,147850-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
919,147850-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
920,147850-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
921,147803-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
922,147803-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
923,147268-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
924,147268-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
925,147268-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
926,147268-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
927,148078-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
928,148078-v1.0.0,good,"/* Use a loop to find the specific cookie you need instead of assuming it's the first one */
Cookie[] cookies = request.getCookies();
if (cookies != null) {
    for (Cookie cookie : cookies) {
        if (cookie.getName().equals(""your_cookie_name"")) {
            data = cookie.getValue();
            break;
        }
    }
}
",good
929,148078-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
930,148078-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
931,146295-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
932,146295-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
933,146295-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
934,146295-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
935,146295-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_68b()).badSink();
",bad
936,140915-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_22b()).goodB2G2Sink(data );
",bad
937,140915-v1.0.0,good,"PreparedStatement statement = null;
try {
    statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
938,146385-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_22b()).badSink(data );
",bad
939,146472-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_22b()).goodB2G1Sink(data );
",bad
940,146472-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // Process the result set
} catch (SQLException e) {
    // Handle exception
} finally {
    // Close resources
}
",good
941,147245-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
942,147245-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
943,147390-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_73b()).badSink(dataLinkedList , request, response );
",bad
944,147390-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
945,147621-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
946,147621-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
947,147621-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
948,147621-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
949,147621-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
950,147621-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
951,148252-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
952,148252-v1.0.0,good,"// Validate and sanitize the data before using it in a SQL query
String data = """";
Cookie cookieSources[] = request.getCookies();
if (cookieSources != null) {
    data = cookieSources[0].getValue();
    // Use a prepared statement or parameterized query to prevent SQL injection
    // Example:
    // PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    // stmt.setString(1, data);
}
",good
953,146360-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
954,146360-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
955,146527-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__listen_tcp_execute_66b()).badSink(dataArray);
",bad
956,146527-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_51b()).badSink(data);
",bad
957,146527-v1.0.0,good,"PreparedStatement stmt = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    stmt = conn.prepareStatement(query);
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    if (stmt != null) {
        stmt.close();
    }
}
",good
958,146527-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_66b()).badSink(dataArray);
",bad
959,147067-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__console_readLine_executeQuery_66b()).badSink(dataArray);
",bad
960,147067-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process the result set
} catch (SQLException e) {
    e.printStackTrace();
}
",good
961,147067-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
962,147067-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
}
finally {
    try {
        if (preparedStatement != null) {
            preparedStatement.close();
        }
    }
    catch (SQLException exceptSql) {
        IO.logger.log(Level.WARNING, ""Error closing PreparedStatement"", exceptSql);
    }
    // rest of the code...
}
",good
963,147067-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_73b()).badSink(dataLinkedList);
",bad
964,147067-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
preparedStatement.setString(1, data);
preparedStatement.executeUpdate();
",good
965,147144-v1.0.0,java,"data = properties.getProperty(""data"");
baseObject.action(data);
",bad
966,147144-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
967,147144-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
968,147144-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data); // No change needed as this is already using a prepared statement with parameter binding
",good
969,147144-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
970,147144-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
971,148341-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
972,148341-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
973,148341-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
974,148341-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
975,148341-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_53b()).badSink(data );
",bad
976,146361-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
977,147807-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
978,147807-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
979,147807-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
980,147807-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
981,147807-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_52b()).badSink(data);
",bad
982,147807-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
983,146407-v1.0.0,java,"(new CWE566_Authorization_Bypass_Through_SQL_Primary__Servlet_74b()).badSink(dataHashMap , request, response );
",bad
984,146407-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
985,146407-v1.0.0,good,"String id = ""0""; // This value should be obtained from a safe source, such as user input with proper validation and sanitization.
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
986,146407-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_67b()).badSink(dataContainer);
",bad
987,146655-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_71b()).badSink((Object)data);
",bad
988,146655-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
preparedStatement.setString(1, data);
preparedStatement.executeUpdate();
",good
989,146870-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
990,146870-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
991,148180-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
992,148180-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
993,148180-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
994,148180-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
995,148180-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
996,148180-v1.0.0,good,"// Add input validation to ensure id is a valid integer
try {
    id = Integer.parseInt(data);
    if (id < 0) {
        throw new NumberFormatException(""Invalid id"");
    }
} catch (NumberFormatException nfx) {
    id = -1;
    // Log the error or handle it appropriately
}
",good
997,148141-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
998,148141-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
999,148141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1000,148141-v1.0.0,good,"// Validate and sanitize the data before using it in the prepared statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1001,148141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1002,148141-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1003,147356-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1004,147356-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1005,147090-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1006,147090-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1007,146901-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1008,146901-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1009,147713-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1010,147713-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1011,147312-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1012,147312-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1013,147290-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1014,147290-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
1015,147290-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1016,147290-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1017,147290-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1018,147290-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1019,146913-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_73b()).badSink(dataLinkedList);
",bad
1020,148095-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1021,148095-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""UPDATE users SET status = 'updated' WHERE name = ?"");
    preparedStatement.setString(1, data);
    int rowsAffected = preparedStatement.executeUpdate();
    if(rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources...
}
",good
1022,147375-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1023,147375-v1.0.0,good,"// Use a whitelist or a more secure method to validate the data before using it in the SQL statement
String id = request.getParameter(""id"");
if (isValidId(id)) {
    sqlStatement.setString(1, id);
    // Rest of the code
} else {
    // Handle invalid input
}
",good
1024,147375-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1025,147375-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1026,147375-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1027,147375-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1028,146529-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1029,146529-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1030,147698-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1031,147698-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1032,147698-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1033,147698-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1034,146709-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1035,146709-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1036,147251-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_71b()).badSink((Object)data);
",bad
1037,147251-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_75b()).badSink(dataSerialized);
",bad
1038,147274-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1039,147274-v1.0.0,good,"int userId = /* get user input */;
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, userId);
",good
1040,146514-v1.0.0,java,"data = properties.getProperty(""data"");
(new CWE89_SQL_Injection__PropertiesFile_executeBatch_68b()).badSink();
",bad
1041,146514-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_52b()).badSink(data );
",bad
1042,146514-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1043,146514-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1044,146514-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1045,146897-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1046,146897-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1047,146897-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1048,146897-v1.0.0,good,"// Sanitize the data variable
String sanitizedData = sanitizeInput(data);

sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizedData);
",good
1049,146897-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1050,146897-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1051,146465-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_73b()).badSink(dataLinkedList);
",bad
1052,146331-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",bad
1053,146331-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1054,146331-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1055,146331-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1056,146331-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
1057,147663-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_75b()).badSink(dataSerialized);
",bad
1058,147663-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1059,147663-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1060,147663-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1061,147663-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1062,146583-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1063,146583-v1.0.0,good,"Boolean result = sqlStatement.executeUpdate();
",good
1064,146225-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1065,146225-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1066,146433-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1067,146433-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1068,148250-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1069,148250-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1070,148250-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1071,148250-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1072,148250-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1073,148250-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1074,148245-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1075,148245-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or escaped before inserting into the SQL query
// This can be done using a library or manually escaping special characters
",good
1076,146470-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1077,146403-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1078,146403-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1079,146403-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1080,146403-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1081,146403-v1.0.0,good,"// Use a library to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE cookie_value = ?"");
pstmt.setString(1, cookieSources[0].getValue());
ResultSet rs = pstmt.executeQuery();
",good
1082,147237-v1.0.0,java,"data = request.getParameter(""id"");
id = Integer.parseInt(data);
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
1083,147237-v1.0.0,good,"String data = request.getParameter(""id"");
int id = -1;
try {
    id = Integer.parseInt(data);
} catch (NumberFormatException nfx) {
    // Handle invalid input, e.g., log an error or return an error response
}

if (id != -1) {
    try {
        preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
        preparedStatement.setInt(1, id);
        resultSet = preparedStatement.executeQuery();
        // Rest of the code...
    } catch (SQLException exceptSql) {
        // Handle SQL exception...
    }
} else {
    // Handle invalid input, e.g., log an error or return an error response
}
",good
1084,146922-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_74b()).badSink(dataHashMap);
",bad
1085,146922-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_66b()).badSink(dataArray);
",bad
1086,146922-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    Connection connection = /* obtain database connection */
    String sql = ""INSERT INTO table_name (column_name) VALUES (?)"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
1087,146922-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_54b()).badSink(data );
",bad
1088,146467-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_75b()).badSink(dataSerialized);
",bad
1089,146871-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1090,146871-v1.0.0,good,"sqlStatement.setString(1, java.sql.DriverManager.getConnection(url, user, password).nativeSQL(data));
",good
1091,147546-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1092,147546-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1093,147234-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1094,147234-v1.0.0,good,"Pattern pattern = Pattern.compile(""[a-zA-Z0-9 ]*"");
Matcher matcher = pattern.matcher(data);
if (matcher.matches()) {
    sqlStatement.setString(1, data);
} else {
    // Handle invalid data
}
",good
1095,147289-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1096,147289-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
1097,147289-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1098,147289-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1099,147289-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1100,147289-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1101,146685-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1102,146685-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1103,146615-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1104,146615-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""expectedCookieName"")) {
        data = cookie.getValue();
        break;
    }
}
",good
1105,147283-v1.0.0,java,"data = request.getParameter(""name"");
",bad
1106,147283-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
1107,147012-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_22b()).goodB2G2Sink(data );
",bad
1108,147012-v1.0.0,good,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_22b()).goodB2G2Sink(DbUtils.escapeString(data));
",good
1109,146485-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_22b()).badSink(data );
",bad
1110,146485-v1.0.0,good,"PreparedStatement statement = null;
try {
    statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    statement.setString(1, data);
    statement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    // Close statement
}
",good
1111,146485-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_22b()).goodB2G1Sink(data );
",bad
1112,146485-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
1113,146485-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
1114,147227-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1115,147227-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1116,147227-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
1117,147227-v1.0.0,good,"String id = request.getParameter(""id"");
data = (id != null) ? id : """";
",good
1118,147227-v1.0.0,java,"baseObject.action(data );
",bad
1119,147227-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet result = statement.executeQuery();
",good
1120,147526-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1121,147526-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1122,147526-v1.0.0,java,"data = token.substring(3);
",bad
1123,147526-v1.0.0,good,"data = request.getParameter(""id"");
",good
1124,147526-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1125,147526-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1126,147630-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1127,147630-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1128,147630-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1129,147630-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is sanitized or validated before inserting into the query
",good
1130,147630-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1131,147630-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1132,148261-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1133,148261-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1134,148261-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1135,148261-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1136,148261-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1137,148261-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1138,146448-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response);
",bad
1139,146448-v1.0.0,java,"goodB2G1Sink(data , request, response);
",bad
1140,146448-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM users WHERE name = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1141,146448-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_54b()).badSink(data );
",bad
1142,146448-v1.0.0,good,"public void good() throws Throwable {
    String data;

    /* get environment variable ADD */
    data = System.getenv(""ADD"");

    Connection conn = /* obtain database connection */
    PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process result set
}
",good
1143,146966-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1144,146966-v1.0.0,good,"String data = request.getParameter(""name"");
// Add input validation to ensure that the data is safe to use in a SQL query
if (!data.matches(""[a-zA-Z0-9_]+"")) {
    throw new IllegalArgumentException(""Invalid name"");
}
sqlStatement.setString(1, data);
",good
1145,146966-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1146,146966-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1147,146966-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1148,146966-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1149,146820-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1150,146820-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1151,146820-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1152,146820-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1153,146820-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1154,147764-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1155,147764-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1156,147416-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1157,147416-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1158,147416-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1159,147416-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1160,147416-v1.0.0,java,"data = readerBuffered.readLine();
badSink(data);
",bad
1161,147416-v1.0.0,good,"PreparedStatement statement = null;
try {
    statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    statement.setString(1, data);
    statement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (statement != null) {
        statement.close();
    }
}
",good
1162,148253-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_53b()).badSink(data);
",bad
1163,148253-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_71b()).badSink((Object)data , request, response );
",bad
1164,148253-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1165,146209-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_66b()).badSink(dataArray);
",bad
1166,148293-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_74b()).badSink(dataHashMap);
",bad
1167,148293-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1168,148293-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1169,148293-v1.0.0,java,"data = request.getParameter(""id"");
",bad
1170,148293-v1.0.0,good,"String id = request.getParameter(""id"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE id = ?"");
pstmt.setString(1, id);
ResultSet rs = pstmt.executeQuery();
",good
1171,146164-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1172,146164-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1173,146844-v1.0.0,java,"data = request.getParameter(""name"");
",bad
1174,146844-v1.0.0,good,"data = request.getParameter(""name"");
// Use PreparedStatement to prevent SQL injection
String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1175,146844-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1176,146844-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1177,146844-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1178,146844-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1179,147359-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1180,147359-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1181,140913-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1182,140913-v1.0.0,good,"String safeData = escapeSpecialCharacters(data);
sqlStatement.setString(1, safeData);
",good
1183,146741-v1.0.0,java,"data = System.getenv(""ADD"");
(new CWE89_SQL_Injection__Environment_execute_68b()).badSink();
",bad
1184,146741-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_72b()).badSink(dataVector);
",bad
1185,146741-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
1186,148062-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1187,148062-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1188,146702-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1189,146702-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1190,146702-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1191,146702-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1192,146702-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_22b()).goodB2G2Sink(data );
",bad
1193,146847-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_22b()).badSink(data );
",bad
1194,146847-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1195,146847-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_22b()).goodB2G1Sink(data );
",bad
1196,146847-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (PreparedStatement statement = connection.prepareStatement(query)) {
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
1197,146847-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1198,146847-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
1199,146842-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1200,146842-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""UPDATE users SET status = ? WHERE name = ?"");
    preparedStatement.setString(1, ""updated"");
    preparedStatement.setString(2, data);

    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
}
finally {
    // Close the preparedStatement and dbConnection here
}
",good
1201,140882-v1.0.0,java,"goodB2G2Sink(data);
",bad
1202,147822-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1203,147822-v1.0.0,good,"// Validate and sanitize the cookie value before using it
String cookieValue = cookieSources[0].getValue();
if (isValidCookieValue(cookieValue)) {
    data = cookieValue;
} else {
    // Handle invalid cookie value
}
",good
1204,147822-v1.0.0,java,"baseObject.action(data );
",bad
1205,147822-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1206,140891-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_74b()).badSink(dataHashMap);
",bad
1207,146974-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1208,148300-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1209,148300-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1210,148300-v1.0.0,java,"String data = request.getParameter(""name"");
String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
...
",bad
1211,148300-v1.0.0,good,"String data = request.getParameter(""name"");
String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """")); // Remove potentially harmful characters
    sqlStatement.addBatch();
}
...
",good
1212,148300-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1213,148300-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1214,148340-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1215,148340-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1216,148340-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1217,148340-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1218,148340-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1219,148340-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1220,146430-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1221,146430-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add input validation and sanitization here to prevent SQL injection
",good
1222,147824-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1223,147824-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1224,147995-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1225,147995-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1226,147995-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1227,147995-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_22b()).goodB2G2Sink(data );
",bad
1228,147470-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_22b()).badSink(data);
",bad
1229,147243-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_22b()).goodB2G1Sink(data );
",bad
1230,147243-v1.0.0,good,"// Use prepared statements or parameterized queries to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1231,146969-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1232,146969-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1233,147598-v1.0.0,java,"data = request.getParameter(""id"");
dataArray[2] = data;
(new CWE566_Authorization_Bypass_Through_SQL_Primary__Servlet_66b()).badSink(dataArray , request, response );
",bad
1234,147598-v1.0.0,good,"String id = request.getParameter(""id"");
PreparedStatement ps = conn.prepareStatement(""SELECT * FROM users WHERE id = ?"");
ps.setString(1, id);
ResultSet rs = ps.executeQuery();
// process result set
",good
1235,147520-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_71b()).badSink((Object)data);
",bad
1236,147520-v1.0.0,good,"// Use PreparedStatement to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1237,146585-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1238,146585-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1239,146585-v1.0.0,java,"data = request.getParameter(""name"");
",bad
1240,146585-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
",good
1241,146585-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1242,146585-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, ""'"" + data.replace(""'"", ""''"") + ""'"");
",good
1243,146658-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1244,146658-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1245,146268-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1246,146268-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1247,146268-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1248,146268-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1249,147894-v1.0.0,java,"data = System.getenv(""ADD"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1250,147894-v1.0.0,good,"String data = System.getenv(""ADD"");
// Add input validation to ensure that the user input is safe to use in the query
if (data != null && !data.matches(""[a-zA-Z0-9]+"")) {
    throw new IllegalArgumentException(""Invalid input: "" + data);
}
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1251,147442-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1252,147442-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1253,147442-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1254,147442-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1255,146598-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1256,146598-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1257,146598-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_68b()).badSink();
",bad
1258,146598-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__console_readLine_executeUpdate_66b()).badSink(dataArray);
",bad
1259,146598-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String sql = ""INSERT INTO table_name (column_name) VALUES (?)"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
1260,146162-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1261,146162-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status='updated' where name=?"");
sqlStatement.setString(1, data);
",good
1262,147927-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1263,147927-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1264,140904-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1265,140904-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1266,147899-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1267,147899-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1268,148109-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_53b()).badSink(data);
",bad
1269,148109-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1270,148109-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__connect_tcp_prepareStatement_66b()).badSink(dataArray);
",bad
1271,148109-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_71b()).badSink((Object)data);
",bad
1272,148109-v1.0.0,good,"public void good() throws Throwable {
    String data;

    /* get system property user.home */
    data = System.getProperty(""user.home"");

    Connection conn = /* obtain database connection */
    PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process results
}
",good
1273,147250-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1274,147250-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1275,148239-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1276,148239-v1.0.0,good,"String sanitizedData = sanitizeString(data);
sqlStatement.setString(1, sanitizedData);
",good
1277,146366-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1278,146366-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1279,146366-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1280,146366-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1281,146366-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_74b()).badSink(dataHashMap);
",bad
1282,148347-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1283,148347-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
1284,146235-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1285,146235-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1286,148241-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
1287,148241-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, java.sql.DriverManager.getConnection(url, user, password).quote(names[i]));
",good
1288,146174-v1.0.0,java,"data = readerBuffered.readLine();
...
dataHashMap.put(0, data);
dataHashMap.put(1, data);
dataHashMap.put(2, data);
(new CWE89_SQL_Injection__listen_tcp_executeBatch_74b()).badSink(dataHashMap);
",bad
1289,148343-v1.0.0,java,"data = System.getenv(""ADD"");
(new CWE89_SQL_Injection__Environment_executeBatch_68b()).badSink();
",bad
1290,148343-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
1291,146955-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
1292,146955-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",good
1293,146955-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1294,146955-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1295,146955-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1296,146955-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1297,147158-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_52b()).badSink(data );
",bad
1298,148091-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1299,148091-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (name, status) values (?, 'updated')"");
sqlStatement.setString(1, data);
",good
1300,147276-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1301,147276-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1302,146745-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1303,146745-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1304,146745-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1305,146745-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1306,146745-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_execute_72b()).badSink(dataVector , request, response );
",bad
1307,148151-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1308,148151-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1309,148151-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1310,148151-v1.0.0,good,"// Use a PreparedStatement with parameter binding to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1311,148151-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1312,148151-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1313,147820-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1314,147820-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1315,146342-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_22b()).badSink(data );
",bad
1316,146342-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_22b()).goodB2G1Sink(data );
",bad
1317,147330-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_67b()).badSink(dataContainer , request, response );
",bad
1318,147330-v1.0.0,good,"String data = request.getParameter(""name"");
Container dataContainer = new Container();
dataContainer.containerOne = data;

// Use a prepared statement to prevent SQL injection
String sql = ""SELECT * FROM table WHERE name = ?"";
PreparedStatement statement = connection.prepareStatement(sql);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();

(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_67b()).badSink(resultSet, request, response);
",good
1319,147330-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1320,147330-v1.0.0,good,"String id = ""0""; // This should be replaced with user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
1321,147391-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_54b()).badSink(data );
",bad
1322,147391-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1323,148181-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1324,148181-v1.0.0,good,"Pattern pattern = Pattern.compile(""[a-zA-Z0-9_-]+"");
Matcher matcher = pattern.matcher(names[i]);
if (matcher.matches()) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
} else {
    // Handle invalid input
}
",good
1325,148181-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1326,148181-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1327,148181-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1328,148181-v1.0.0,good,"// Add input validation
String name = names[i].replaceAll(""[^a-zA-Z0-9_-]"", """");
sqlStatement.setString(1, name);
",good
1329,146918-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1330,146918-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1331,146918-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1332,146918-v1.0.0,good,"String data = """";
Cookie cookieSources[] = request.getCookies();
if (cookieSources != null) {
    data = cookieSources[0].getValue();
    // Validate and sanitize input data here
    // ...
}

PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1333,147255-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1334,147255-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data); // No change needed here, as it's already using parameterized query
",good
1335,147255-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1336,147255-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1337,147255-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1338,147255-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1339,147587-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1340,147587-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1341,147587-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1342,147587-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1343,147587-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1344,146153-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1345,146153-v1.0.0,good,"String id = ""0""; // get the id value from user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
resultSet = preparedStatement.executeQuery();
",good
1346,148112-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1347,148112-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1348,147394-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1349,147394-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values (?) where name=?"");
preparedStatement.setString(1, ""updated"");
preparedStatement.setString(2, data);
int rowCount = preparedStatement.executeUpdate();
",good
1350,147642-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1351,147642-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1352,147826-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1353,147826-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1354,147572-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1355,147572-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1356,147211-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1357,147211-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1358,146806-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1359,146806-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1360,146602-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1361,146602-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1362,146602-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1363,146602-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1364,146602-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__File_executeQuery_66b()).badSink(dataArray);
",bad
1365,146602-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1366,146892-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1367,146892-v1.0.0,good,"// Validate and sanitize the data before using it in the query
String validatedData = validateAndSanitize(data);
sqlStatement.setString(1, validatedData);
",good
1368,146892-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1369,146892-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1370,146888-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1371,146888-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_54b()).badSink(data);
",bad
1372,146888-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_52b()).badSink(data );
",bad
1373,146888-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1374,147603-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1375,147603-v1.0.0,good,"// Use a whitelist or validation to ensure that the data is safe before using it in the SQL statement.
// For example, you could use a regular expression to ensure that the data only contains alphanumeric characters.
String safeData = data.replaceAll(""[^a-zA-Z0-9]"", """");
sqlStatement.setString(1, safeData);
",good
1376,146155-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1377,146155-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1378,147445-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1379,147445-v1.0.0,good,"// Sanitize data before using it in the SQL statement
data = sanitizeInput(data);
sqlStatement.setString(1, data);
",good
1380,147445-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1381,147445-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1382,147445-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1383,147445-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1384,146949-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1385,148315-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1386,148315-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // ... rest of the code
} catch (SQLException exceptSql) {
    // ... handle exception
} finally {
    // ... close resources
}
",good
1387,146669-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1388,146669-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1389,146358-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1390,146358-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1391,147763-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1392,147763-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1393,147009-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_52b()).badSink(data );
",bad
1394,147009-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
1395,147009-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1396,147009-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1397,147009-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1398,147009-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources...
}
",good
1399,146199-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1400,146199-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1401,147030-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1402,147030-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1403,147030-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1404,147030-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1405,147562-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1406,147562-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1407,147937-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1408,147937-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1409,147104-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1410,147104-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1411,147104-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1412,147104-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1413,147104-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1414,148092-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_68b()).badSink();
",bad
1415,147980-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1416,147980-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1417,147282-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1418,147282-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1419,146719-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1420,146719-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1421,146638-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1422,146638-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1423,146638-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1424,146638-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1425,146638-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1426,147865-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1427,147865-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1428,147920-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1429,147920-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1430,147920-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1431,147920-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1432,147920-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1433,147920-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1434,147199-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1435,147199-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput is a function that properly escapes special characters in the input to prevent SQL injection.
",good
1436,147101-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1437,147101-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1438,146320-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1439,148035-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1440,148035-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1441,148035-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1442,148035-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1443,148035-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1444,148035-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1445,146441-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1446,146441-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
1447,146441-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1448,146441-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1449,146441-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1450,147686-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1451,147686-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1452,146600-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1453,148256-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1454,148256-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1455,148256-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1456,148256-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1457,148256-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1458,148256-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1459,146881-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1460,146881-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1461,146881-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1462,146881-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1463,146881-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1464,146881-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1465,148076-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_67b()).badSink(dataContainer);
",bad
1466,148076-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1467,148076-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1468,148076-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1469,148076-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1470,146684-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1471,146684-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1472,147001-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1473,147001-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
1474,147001-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1475,147001-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1476,147001-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_51b()).badSink(data);
",bad
1477,148045-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1478,148045-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1479,148045-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__console_readLine_execute_66b()).badSink(dataArray);
",bad
1480,148045-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1481,148045-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1482,147835-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1483,147835-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1484,146273-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1485,147212-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1486,147212-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1487,146987-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1488,146987-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1489,147326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1490,147326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1491,147326-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_73b()).badSink(dataLinkedList , request, response );
",bad
1492,147326-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1493,147326-v1.0.0,java,"data = token.substring(3);
",bad
1494,147326-v1.0.0,good,"data = request.getParameter(""id"");
",good
1495,147786-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_execute_22b()).badSink(data , request, response);
",bad
1496,147786-v1.0.0,good,"String query = ""SELECT * FROM table WHERE id = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1497,147786-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_execute_22b()).goodB2G1Sink(data , request, response);
",bad
1498,147786-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1499,147786-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1500,147786-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1501,147560-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1502,147560-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1503,147560-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1504,147560-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1505,147560-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1506,146869-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1507,146869-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1508,147840-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1509,147840-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1510,148117-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1511,148117-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1512,147174-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1513,147174-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
if (rowsAffected > 0) {
    IO.writeLine(""Name, "" + data + "", updated successfully"");
} else {
    IO.writeLine(""Unable to update records for user: "" + data);
}
",good
1514,147523-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1515,147523-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1516,147523-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1517,147523-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1518,147523-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1519,147523-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1520,148136-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__File_executeBatch_66b()).badSink(dataArray);
",bad
1521,146939-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1522,146939-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowsAffected = preparedStatement.executeUpdate();
    if(rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources...
}
",good
1523,146646-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1524,146646-v1.0.0,good,"import org.owasp.html.HtmlPolicyBuilder;
import org.owasp.html.PolicyFactory;

// ...

PolicyFactory policy = new HtmlPolicyBuilder().toFactory();

// ...

for (int i = 0; i < names.length; i++) {
    String sanitizedName = policy.sanitize(names[i]);
    sqlStatement.setString(1, sanitizedName);
    sqlStatement.addBatch();
}
",good
1525,146330-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1526,146330-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1527,146330-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1528,146330-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_execute_22b()).goodB2G2Sink(data , request, response);
",bad
1529,146502-v1.0.0,java,"data = request.getParameter(""name"");
",bad
1530,146502-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
1531,148318-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_execute_22b()).goodB2G1Sink(data , request, response);
",bad
1532,148318-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1533,146916-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1534,146916-v1.0.0,good,"try {
    dbConnection = IO.getDBConnection();
    sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    }
    int[] resultsArray = sqlStatement.executeBatch();
    // rest of the code...
}
",good
1535,146818-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1536,146818-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1537,146818-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1538,146818-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""['\"";-]"", """"));
",good
1539,147848-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response);
",bad
1540,147848-v1.0.0,good,"String data = request.getParameter(""name"");
String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
// Use the result set...
",good
1541,147848-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1542,147848-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1543,146772-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1544,146772-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1545,146772-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1546,146772-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
// For example, use a regular expression to ensure that the data variable only contains alphanumeric characters
String pattern = ""^[a-zA-Z0-9]*$"";
if (!data.matches(pattern)) {
    // Handle invalid input
}
sqlStatement.setString(1, data);
",good
1547,146772-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__getParameter_Servlet_execute_67b()).badSink(dataContainer , request, response );
",bad
1548,146772-v1.0.0,good,"String data = request.getParameter(""name"");
Container dataContainer = new Container();
dataContainer.containerOne = data;

// Use a prepared statement to prevent SQL injection
String sql = ""SELECT * FROM table WHERE name = ?"";
PreparedStatement pstmt = connection.prepareStatement(sql);
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();

// Use the result set...
",good
1549,147685-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1550,147685-v1.0.0,good,"String pattern = ""[a-zA-Z0-9_-]+"";
if (!names[i].matches(pattern)) {
    // handle invalid input
} else {
    sqlStatement.setString(1, names[i]);
}
",good
1551,147027-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1552,147027-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1553,146937-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1554,146937-v1.0.0,good,"String names[] = data.replaceAll(""['\"";-]"", """").split(""-"");
",good
1555,146980-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_54b()).badSink(data);
",bad
1556,147940-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1557,147940-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1558,147645-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1559,147645-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
1560,146471-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1561,146471-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1562,147744-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1563,147744-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status = 'updated' where name = ?"");
sqlStatement.setString(1, data);
",good
1564,147744-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1565,147744-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1566,147744-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1567,147744-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1568,147789-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1569,147532-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1570,147532-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1571,146909-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1572,146928-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1573,146928-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, java.sql.DriverManager.getConnection(""jdbc:mysql://localhost:3306/dbname"", ""username"", ""password"").prepareStatement(""SELECT ? LIMIT 1"").setString(1, data).executeQuery().getString(1));
",good
1574,147240-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1575,147240-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1576,146325-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1577,146325-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1578,147959-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_67b()).badSink(dataContainer);
",bad
1579,147959-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
1580,147959-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
1581,147959-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1582,147959-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1583,147924-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
1584,147924-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, userId); // Assuming userId is the user input
resultSet = preparedStatement.executeQuery();
",good
1585,147924-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1586,147924-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
1587,147924-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1588,147924-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1589,147370-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1590,147370-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
1591,147370-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",good
1592,147370-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1593,147370-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
pstmt.setString(1, names[i]);
sqlStatement.addBatch(pstmt);
",good
1594,146878-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1595,146878-v1.0.0,good,"String userID = ""0""; // This should be replaced with a safe input source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, userID);
",good
1596,146463-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_22b()).goodB2G2Sink(data);
",bad
1597,146463-v1.0.0,good,"private void goodB2G2() throws Throwable {
    String data = null;

    /* get system property user.home */
    data = System.getProperty(""user.home"");

    goodB2G2PublicStatic = true;
    (new CWE89_SQL_Injection__Property_executeBatch_22b()).goodB2G2SinkPreparedStatement(data);
}

// In the CWE89_SQL_Injection__Property_executeBatch_22b class:
public void goodB2G2SinkPreparedStatement(String data) throws SQLException {
    String query = ""SELECT * FROM users WHERE home = ?"";
    try (Connection conn = getConnection();
         PreparedStatement pstmt = conn.prepareStatement(query)) {
        pstmt.setString(1, data);
        ResultSet rs = pstmt.executeQuery();
        // Process the result set...
    }
}
",good
1598,146383-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_22b()).badSink(data);
",bad
1599,146383-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1600,147313-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_22b()).goodB2G1Sink(data );
",bad
1601,147559-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1602,147559-v1.0.0,good,"Pattern pattern = Pattern.compile(""[a-zA-Z0-9_-]+"");
for (int i = 0; i < names.length; i++) {
    if (pattern.matcher(names[i]).matches()) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    } else {
        // log or handle invalid input
    }
}
",good
1603,147559-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1604,147559-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1605,147559-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1606,147559-v1.0.0,good,"String input = readerBuffered.readLine();
// Validate and sanitize input here
String names[] = input.split(""-"");
for (int i = 0; i < names.length; i++) {
    // Ensure that names[i] only contains allowed characters
    if (!isValidName(names[i])) {
        throw new IllegalArgumentException(""Invalid name: "" + names[i]);
    }
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
1607,147720-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1608,147720-v1.0.0,good,"// Validate and sanitize the cookie value before using it in a SQL query
String data = """";
Cookie[] cookies = request.getCookies();
if (cookies != null) {
    for (Cookie cookie : cookies) {
        if (cookie.getName().equals(""your_cookie_name"")) {
            data = cookie.getValue();
            // Validate and sanitize the data here
            break;
        }
    }
}
",good
1609,147392-v1.0.0,java,"data = token.substring(3);
",bad
1610,147392-v1.0.0,good,"data = java.net.URLDecoder.decode(token.substring(3), ""UTF-8"");
// Add input validation and sanitization here
",good
1611,147329-v1.0.0,java,"data = readerBuffered.readLine();
dataBad = data;
badSink();
",bad
1612,147329-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_72b()).badSink(dataVector , request, response );
",bad
1613,147329-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_66b()).badSink(dataArray , request, response );
",bad
1614,147933-v1.0.0,java,"data = request.getParameter(""id"");
badSink(data , request, response );
",bad
1615,147933-v1.0.0,good,"String data = request.getParameter(""id"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
// use the ResultSet
",good
1616,147933-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1617,147933-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1618,147933-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1619,148356-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1620,148356-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1621,147669-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1622,147669-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1623,147669-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1624,147669-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1625,147669-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1626,146905-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_67b()).badSink(dataContainer);
",bad
1627,146905-v1.0.0,good,"PreparedStatement preparedStatement = null;
Connection connection = null;

try {
    connection = DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""user"", ""password"");
    String sql = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
1628,148167-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1629,148167-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1630,146435-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
1631,146435-v1.0.0,good,"String id = request.getParameter(""id"");
data = id != null ? id : """";
",good
1632,146176-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1633,146176-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1634,146449-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
1635,146449-v1.0.0,good,"String data = request.getParameter(""id"");
",good
1636,146449-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1637,146449-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1638,146449-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1639,146449-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1640,147383-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1641,147383-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1642,147597-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1643,147597-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
1644,147597-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1645,147597-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1646,147597-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1647,147597-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1648,148065-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_71b()).badSink((Object)data);
",bad
1649,148065-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_52b()).badSink(data );
",bad
1650,148065-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1651,148065-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1652,147551-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1653,147551-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1654,147551-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1655,147551-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1656,147551-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_72b()).badSink(dataVector , request, response );
",bad
1657,147551-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
1658,147349-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1659,147349-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1660,146389-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1661,146389-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1662,148052-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1663,148052-v1.0.0,good,"// Use a whitelist or a more secure method to validate and sanitize the data before using it in the SQL query.
// For example, you could use a regular expression to ensure that the data only contains allowed characters.
String sanitizedData = data.replaceAll(""[^a-zA-Z0-9]"", """");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizedData);
",good
1664,146264-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1665,146264-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1666,146264-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1667,146264-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1668,148050-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1669,148050-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1670,148317-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1671,146803-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_52b()).badSink(data);
",bad
1672,146515-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_73b()).badSink(dataLinkedList);
",bad
1673,146515-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""INSERT INTO table (column) VALUES (?)"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    statement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (statement != null) {
        statement.close();
    }
}
",good
1674,146515-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1675,146515-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1676,146515-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1677,146515-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1678,148337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1679,148337-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1680,148337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
1681,148337-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1682,148337-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1683,148337-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1684,146483-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1685,146483-v1.0.0,good,"// Use a whitelist or proper input validation to sanitize the user input before using it in the SQL query.
// This is just a basic example, the actual implementation may vary based on the specific requirements and constraints.
String sanitizedData = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizedData);
",good
1686,146483-v1.0.0,java,"data = token.substring(3);
",bad
1687,146483-v1.0.0,good,"data = request.getParameter(""id"");
",good
1688,146483-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1689,146483-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1690,147782-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1691,147782-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1692,147782-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1693,147782-v1.0.0,good,"String escapedName = names[i].replace(""'"", ""''"");
sqlStatement.setString(1, escapedName);
",good
1694,147782-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1695,147782-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1696,146452-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1697,147380-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_72b()).badSink(dataVector);
",bad
1698,147819-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1699,147819-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1700,147819-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1701,147819-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
1702,147819-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
1703,147819-v1.0.0,good,"String id = ""0""; // This should be replaced with a safe input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",good
1704,147707-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_67b()).badSink(dataContainer , request, response );
",bad
1705,147707-v1.0.0,good,"PreparedStatement pstmt = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
1706,147707-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1707,147707-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1708,147707-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1709,147707-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1710,147813-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1711,147813-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status = 'updated' where name = ?"");
sqlStatement.setString(1, data);
",good
1712,147813-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1713,147813-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1714,147813-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1715,146568-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1716,146568-v1.0.0,good,"String sanitizedData = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizedData);
",good
1717,147016-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1718,147016-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1719,146656-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1720,146656-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1721,148344-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1722,148344-v1.0.0,good,"String id = request.getParameter(""id"");
// Validate and sanitize the id parameter here
sqlStatement.setString(1, id);
",good
1723,147944-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1724,147944-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1725,148334-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1726,148334-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1727,146788-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_75b()).badSink(dataSerialized , request, response );
",bad
1728,148126-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_67b()).badSink(dataContainer);
",bad
1729,148126-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1730,146381-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1731,146381-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1732,147125-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1733,147125-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1734,147324-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1735,147324-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1736,147982-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1737,147982-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
1738,147110-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1739,147110-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1740,147110-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1741,147110-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1742,147110-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1743,147110-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1744,146270-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1745,146270-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
String data = request.getParameter(""id"");
if (data != null) {
    data = data.replaceAll(""[';\\-]"", """"); // Remove any single quotes, semicolons, or dashes
}
sqlStatement.setString(1, data);
",good
1746,146384-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1747,146384-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is sanitized or validated before being used in the SQL query
",good
1748,146644-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1749,146644-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1750,147116-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1751,147116-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1752,147116-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1753,147116-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1754,147116-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1755,146495-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1756,146495-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1757,147429-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1758,147429-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.clearParameters();
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
1759,147022-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1760,147022-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data); // Change this line to:
// sqlStatement.setString(1, data.replace(""'"", ""''""));
",good
1761,146889-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1762,146889-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1763,146889-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1764,146889-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1765,146889-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_67b()).badSink(dataContainer);
",bad
1766,148153-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1767,147895-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1768,147895-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1769,146194-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1770,146194-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1771,146194-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1772,146194-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1773,146194-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1774,146194-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1775,147494-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_66b()).badSink(dataArray);
",bad
1776,147494-v1.0.0,good,"Connection conn = null;
PreparedStatement stmt = null;
try {
    conn = DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""user"", ""password"");
    String sql = ""INSERT INTO table (column) VALUES (?)"";
    stmt = conn.prepareStatement(sql);
    stmt.setString(1, data);
    stmt.executeUpdate();
} catch (SQLException se) {
    // Handle errors for JDBC
    se.printStackTrace();
} finally {
    // finally block used to close resources
    try {
        if (stmt != null)
            stmt.close();
    } catch (SQLException se2) {
    } // nothing we can do
    try {
        if (conn != null)
            conn.close();
    } catch (SQLException se) {
        se.printStackTrace();
    } // end finally try
} // end try
",good
1777,147475-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1778,147475-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1779,147475-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1780,147475-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1781,147475-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1782,147475-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1783,146285-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1784,146285-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (name, status) values (?, 'updated')"");
sqlStatement.setString(1, data);
",good
1785,146941-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1786,146941-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1787,147254-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1788,147254-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_51b()).badSink(data);
",bad
1789,147254-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1790,147254-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1791,148191-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1792,148191-v1.0.0,good,"Pattern pattern = Pattern.compile(""^[a-zA-Z0-9_]+$"");
Matcher matcher = pattern.matcher(names[i]);
if (matcher.matches()) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
} else {
    // Handle invalid input
}
",good
1793,146421-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1794,146421-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1795,146887-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1796,146887-v1.0.0,java,"data = readerBuffered.readLine();
badSink(data);
",bad
1797,146887-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1798,146887-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",bad
1799,146314-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1800,146314-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1801,147804-v1.0.0,java,"String data = System.getenv(""ADD"");
String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1802,147279-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_54b()).badSink(data );
",bad
1803,147279-v1.0.0,good,"import org.owasp.html.HtmlPolicyBuilder;
import org.owasp.html.PolicyFactory;
import org.owasp.html.Sanitizers;

// ...

PolicyFactory policy = new HtmlPolicyBuilder().toFactory();
String sanitizedData = policy.sanitize(data);
(new CWE89_SQL_Injection__console_readLine_executeUpdate_54b()).badSink(sanitizedData);
",good
1804,146158-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_71b()).badSink((Object)data);
",bad
1805,146158-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1806,146158-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1807,146158-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1808,146158-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1809,147385-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1810,147385-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that sanitizes the input to prevent SQL injection.
",good
1811,146687-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_53b()).badSink(data);
",bad
1812,146687-v1.0.0,good,"String query = ""SELECT * FROM users WHERE home = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1813,146443-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
1814,146443-v1.0.0,good,"try {
    id = Integer.parseInt(data);
    // Add validation to check if the id exists in the database
    if (!isValidId(id)) {
        // Handle invalid id, e.g., return an error message
        return;
    }
} catch (NumberFormatException nfx) {
    // Handle invalid input, e.g., return an error message
    return;
}

preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",good
1815,146443-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1816,146443-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1817,146443-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1818,146443-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1819,147705-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1820,147705-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1821,147448-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1822,147448-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1823,147448-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1824,147483-v1.0.0,java,"String data = request.getParameter(""name"");
String names[] = data.split(""-"");
PreparedStatement sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1825,147483-v1.0.0,good,"String data = request.getParameter(""name"");
String names[] = data.split(""-"");
StringBuilder sqlQuery = new StringBuilder(""update users set hitcount=hitcount+1 where name in ("");
for (int i = 0; i < names.length; i++)
{
    sqlQuery.append(""?,"");
}
sqlQuery.deleteCharAt(sqlQuery.length() - 1); // remove the last comma
sqlQuery.append("")"");
PreparedStatement sqlStatement = dbConnection.prepareStatement(sqlQuery.toString());
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(i + 1, names[i]);
}
",good
1826,146993-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_71b()).badSink((Object)data);
",bad
1827,146993-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
1828,146993-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
1829,146993-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1830,146993-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
1831,147286-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
1832,147286-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    Connection dbConnection = null;
    PreparedStatement sqlStatement = null;
    ResultSet resultSet = null;

    try {
        dbConnection = IO.getDBConnection();
        sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
        sqlStatement.setString(1, id);

        resultSet = sqlStatement.executeQuery();

        IO.writeLine(resultSet.getRow());
    }
    catch (SQLException exceptSql) {
        IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
    }
    finally {
        // Close resources...
    }
}
",good
1833,147507-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_74b()).badSink(dataHashMap);
",bad
1834,148202-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1835,148202-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1836,146221-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1837,146221-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1838,146221-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1839,146221-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1840,146221-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_73b()).badSink(dataLinkedList);
",bad
1841,147365-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1842,147365-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1843,147365-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1844,147365-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1845,147365-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1846,147365-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1847,147347-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1848,147347-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1849,147340-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_52b()).badSink(data );
",bad
1850,148014-v1.0.0,java,"data = System.getenv(""ADD"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1851,148260-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1852,148260-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1853,147086-v1.0.0,java,"data = System.getenv(""ADD"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1854,147086-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1855,148042-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1856,148042-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1857,147993-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1858,147993-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1859,147993-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1860,147993-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
data = sanitizeInput(data);
sqlStatement.setString(1, data);
",good
1861,147993-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1862,147993-v1.0.0,good,"// Add input validation to ensure that data only contains allowed characters
String allowedChars = ""abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_"";
if (!data.matches(""["" + allowedChars + ""]*"")) {
    throw new IllegalArgumentException(""Invalid input: "" + data);
}
sqlStatement.setString(1, data);
",good
1863,147164-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1864,147164-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1865,147320-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1866,147320-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that sanitizes the input to prevent SQL injection.
",good
1867,146766-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1868,146766-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1869,146395-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1870,146395-v1.0.0,good,"String id = ""0""; // This should be replaced with the actual user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
1871,146335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1872,146335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1873,146335-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1874,146335-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1875,146335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1876,146335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1877,147854-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
1878,147854-v1.0.0,good,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",good
1879,147854-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1880,147854-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
1881,147854-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1882,147854-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
1883,146198-v1.0.0,java,"data = cookieSources[0].getValue();
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1884,146198-v1.0.0,good,"// Use a whitelist or blacklist to sanitize the input
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
1885,147528-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1886,147528-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1887,146157-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1888,146157-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1889,146157-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1890,146157-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1891,146157-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_71b()).badSink((Object)data , request, response );
",bad
1892,146157-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1893,147021-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1894,146401-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1895,146401-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1896,146401-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1897,146401-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1898,146401-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1899,146401-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
1900,146302-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1901,146302-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1902,146302-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeBatch_74b()).badSink(dataHashMap , request, response );
",bad
1903,146302-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1904,146302-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1905,146302-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before using it in the SQL query
",good
1906,146431-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1907,146431-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1908,146434-v1.0.0,java,"data = System.getenv(""ADD"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1909,146434-v1.0.0,good,"data = System.getenv(""ADD"");
// Add input validation to sanitize the data
data = data.replaceAll(""[';\\-]"", """");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1910,147098-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1911,147098-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1912,147367-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1913,147367-v1.0.0,good,"// Ensure that the data variable is properly sanitized before using it in the prepared statement.
// This could be done using a library that escapes special characters, or by manually checking and escaping the input.
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
1914,147367-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1915,147367-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1916,147367-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1917,147367-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1918,147653-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_74b()).badSink(dataHashMap);
",bad
1919,147845-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_66b()).badSink(dataArray);
",bad
1920,147845-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
1921,146832-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1922,147931-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1923,147931-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
pstmt.setString(1, names[i]);
sqlStatement.addBatch(pstmt);
",good
1924,147407-v1.0.0,java,"String data = System.getenv(""ADD"");
...
String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1925,147407-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1926,147407-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1927,147407-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
1928,147407-v1.0.0,good,"// Validate and sanitize the user input
String data = request.getParameter(""id"");
if (!isValidId(data)) {
    // Handle invalid input, e.g. redirect to an error page
}

int id = Integer.parseInt(data);
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",good
1929,148295-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1930,148295-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1931,148295-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1932,148295-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
data = sanitizeInput(data);
sqlStatement.setString(1, data);
",good
1933,148295-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1934,148295-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1935,148266-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1936,148266-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1937,148266-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_22b()).goodB2G2Sink(data );
",bad
1938,148266-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_22b()).badSink(data);
",bad
1939,148266-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1940,146804-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_22b()).goodB2G1Sink(data);
",bad
1941,148054-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1942,148054-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1943,147648-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1944,147648-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1945,146843-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1946,146843-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1947,146575-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1948,146575-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1949,147172-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1950,147172-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1951,147246-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1952,147246-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1953,146468-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1954,146468-v1.0.0,good,"Pattern namePattern = Pattern.compile(""[a-zA-Z0-9_-]+"");
for (int i = 0; i < names.length; i++) {
    if (namePattern.matcher(names[i]).matches()) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    } else {
        // Handle invalid name
    }
}
",good
1955,147491-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1956,147491-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
pstmt.setString(1, names[i]);
sqlStatement.addBatch(pstmt);
",good
1957,148075-v1.0.0,java,"String data = System.getenv(""ADD"");
String names[] = data.split(""-"");
PreparedStatement sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1958,148075-v1.0.0,good,"// Use parameterized query to prevent SQL injection
PreparedStatement sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
1959,147863-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1960,148197-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1961,148197-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1962,146705-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1963,146705-v1.0.0,good,"try {
    dbConnection = IO.getDBConnection();
    sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    }
    int[] resultsArray = sqlStatement.executeBatch();
    int successCount = 0;
    for (int result : resultsArray) {
        if (result > 0) {
            successCount++;
        }
    }
    IO.writeLine(""Succeeded in "" + successCount + "" out of "" + names.length + "" queries."");
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error executing SQL statement"", exceptSql);
} finally {
    try {
        if (sqlStatement != null) {
            sqlStatement.close();
        }
    } catch (SQLException exceptSql) {
        IO.logger.log(Level.WARNING, ""Error closing PreparedStatement"", exceptSql);
    }
    try {
        if (dbConnection != null) {
            dbConnection.close();
        }
    } catch (SQLException exceptSql) {
        IO.logger.log(Level.WARNING, ""Error closing Connection"", exceptSql);
    }
}
",good
1964,147477-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1965,147477-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1966,147477-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_68b()).badSink();
",bad
1967,147239-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__listen_tcp_prepareStatement_66b()).badSink(dataArray);
",bad
1968,148276-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_66b()).badSink(dataArray , request, response );
",bad
1969,146245-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1970,146245-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1971,146647-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1972,146647-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1973,147671-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1974,147671-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1975,147671-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1976,147671-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1977,147671-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1978,147671-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1979,148032-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1980,148032-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1981,148032-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_73b()).badSink(dataLinkedList);
",bad
1982,148032-v1.0.0,good,"// Instead of directly using the dataLinkedList, sanitize or validate the data first.
// This could be done using a prepared statement or parameterized query.
PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
1983,148032-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_72b()).badSink(dataVector);
",bad
1984,146144-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_53b()).badSink(data);
",bad
1985,146144-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
1986,146144-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_51b()).badSink(data);
",bad
1987,146144-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1988,146144-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1989,147892-v1.0.0,java,"data = properties.getProperty(""data"");
(new CWE89_SQL_Injection__PropertiesFile_executeBatch_54b()).badSink(data );
",bad
1990,147892-v1.0.0,java,"dataHashMap.put(0, data);
dataHashMap.put(1, data);
dataHashMap.put(2, data);
(new CWE89_SQL_Injection__listen_tcp_executeUpdate_74b()).badSink(dataHashMap);
",bad
1991,148106-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1992,148106-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1993,148106-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__listen_tcp_executeBatch_66b()).badSink(dataArray);
",bad
1994,148106-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""INSERT INTO table_name (column_name) VALUES (?)"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    e.printStackTrace();
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
1995,148106-v1.0.0,java,"data = readerBuffered.readLine();
",bad
1996,148106-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement preparedStatement = connection.prepareStatement(query);
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
1997,147269-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
1998,147269-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
1999,146828-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2000,146828-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2001,146609-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
2002,146609-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
resultSet = preparedStatement.executeQuery();
",good
2003,147637-v1.0.0,java,"badSink(data , request, response);
",bad
2004,147637-v1.0.0,java,"goodB2G1Sink(data , request, response);
",bad
2005,146718-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_73b()).badSink(dataLinkedList , request, response );
",bad
2006,146743-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2007,146743-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowsAffected = preparedStatement.executeUpdate();
    if(rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources
}
",good
2008,147387-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2009,147387-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2010,146761-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2011,146761-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0); // replace 0 with the actual user id
",good
2012,147814-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response);
",bad
2013,147814-v1.0.0,good,"String name = request.getParameter(""name"");
String query = ""SELECT * FROM users WHERE name = ?"";
try (PreparedStatement stmt = connection.prepareStatement(query)) {
    stmt.setString(1, name);
    ResultSet rs = stmt.executeQuery();
    // process the result set
}
",good
2014,147814-v1.0.0,java,"goodB2G1Sink(data , request, response);
",bad
2015,147814-v1.0.0,good,"String name = request.getParameter(""name"");
// Sanitize input using a library or method
String sanitizedName = sanitizeInput(name);
goodB2G1Sink(sanitizedName, request, response);
",good
2016,147206-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2017,147206-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
2018,147302-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_52b()).badSink(data );
",bad
2019,148049-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_75b()).badSink(dataSerialized);
",bad
2020,146753-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_54b()).badSink(data , request, response);
",bad
2021,146753-v1.0.0,good,"String query = ""SELECT * FROM table WHERE id = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2022,146304-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2023,146304-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2024,147408-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_53b()).badSink(data );
",bad
2025,147408-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM Users WHERE home = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2026,147682-v1.0.0,java,"data = System.getenv(""ADD"");
baseObject.action(data );
",bad
2027,147682-v1.0.0,good,"String data = System.getenv(""ADD"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2028,146216-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__connect_tcp_executeUpdate_66b()).badSink(dataArray);
",bad
2029,146216-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2030,146216-v1.0.0,good,"String id = getIdFromUserInput(); // Assume this function safely retrieves user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2031,146216-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2032,146216-v1.0.0,good,"String id = ""0""; // This value should come from a safe source, such as user input validation or parameterization
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2033,147360-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2034,146345-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2035,146345-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2036,147625-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2037,147625-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2038,147625-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2039,147625-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2040,147625-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2041,147625-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2042,146614-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2043,146614-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2044,147742-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2045,146456-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2046,146456-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2047,147746-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2048,147746-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add this line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
2049,147760-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2050,147760-v1.0.0,good,"for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
2051,147321-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2052,147321-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
2053,146168-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2054,146168-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
2055,147351-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2056,148115-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2057,148115-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2058,148115-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2059,148115-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2060,148115-v1.0.0,good,"PreparedStatement updateStatement = null;
try {
    updateStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        updateStatement.setString(1, names[i]);
        sqlStatement.addBatch(updateStatement);
    }
    int resultsArray[] = sqlStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2061,146275-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2062,146599-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2063,146599-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2064,140893-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
2065,140893-v1.0.0,good,"// Validate and sanitize user input before using it in the SQL query
String[] validNames = validateAndSanitizeNames(names);
...
sqlStatement.setString(1, validNames[i]);
",good
2066,148277-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2067,148277-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2068,148069-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2069,148069-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2070,148069-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2071,148069-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2072,148069-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
2073,147061-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2074,147061-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
2075,146557-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
2076,146557-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2077,146557-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
2078,146557-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2079,146557-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2080,147463-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2081,147463-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2082,148302-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2083,147566-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2084,147566-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2085,147692-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2086,147692-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2087,148165-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2088,148165-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));

// Add a method to sanitize input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, using whitelisting, or other methods
    // For example, using a library like OWASP's ESAPI can help prevent SQL injection
    return input;
}
",good
2089,146211-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2090,146211-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2091,146619-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2092,146619-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    pstmt.setString(1, names[i]);
    pstmt.addBatch();
}
int resultsArray[] = pstmt.executeBatch();
",good
2093,146601-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_54b()).badSink(data);
",bad
2094,146601-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2095,146601-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_executeQuery_75b()).badSink(dataSerialized , request, response );
",bad
2096,146601-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2097,146601-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2098,147699-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2099,147699-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2100,147699-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2101,147699-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2102,147699-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2103,147699-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2104,147446-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2105,147446-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2106,140907-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2107,140907-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2108,146487-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2109,146487-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput is a function that properly escapes special characters in the input to prevent SQL injection.
",good
2110,146487-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2111,146487-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2112,146487-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2113,146487-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2114,147131-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2115,147131-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2116,148026-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2117,148026-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2118,147071-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_53b()).badSink(data );
",bad
2119,147071-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2120,147071-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2121,147071-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2122,146875-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2123,147024-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2124,147024-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2125,147141-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2126,147141-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2127,147141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2128,147141-v1.0.0,good,"// Use a whitelist or a more secure method to validate the data before using it in the SQL statement
String validData = validateData(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, validData);
",good
2129,147141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2130,147141-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2131,147203-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2132,147203-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2133,146999-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2134,146999-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2135,146999-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2136,146999-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2137,146999-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2138,147636-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2139,147636-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2140,148214-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2141,148214-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
2142,148214-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2143,148214-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, java.net.URLEncoder.encode(data, ""UTF-8""));
",good
2144,148214-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2145,148214-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
2146,147388-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2147,147007-v1.0.0,java,"baseObject.action(data);
",bad
2148,147007-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2149,146546-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2150,147755-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2151,147755-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
2152,147368-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2153,147368-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
2154,147368-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2155,147368-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2156,147368-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_66b()).badSink(dataArray);
",bad
2157,147368-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""INSERT INTO table (column) VALUES (?)"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    statement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
2158,147095-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2159,147095-v1.0.0,good,"sqlStatement.setString(1, sanitizeInput(data));
",good
2160,146597-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2161,146597-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2162,146597-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2163,146597-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2164,146597-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2165,147525-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2166,147525-v1.0.0,good,"String id = ""0""; // This should be replaced with the actual user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2167,147956-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2168,147956-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2169,147956-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2170,147956-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2171,147956-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2172,146555-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2173,146555-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));

// Add a method to sanitize input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, limiting input length, etc.
    // For example, using a library like OWASP's ESAPI to escape SQL characters
    return ESAPI.encoder().encodeForSQL(input);
}
",good
2174,146555-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_74b()).badSink(dataHashMap);
",bad
2175,146555-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_75b()).badSink(dataSerialized);
",bad
2176,147678-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2177,147678-v1.0.0,good,"String names[] = data.replaceAll(""[^-a-zA-Z0-9]"", """").split(""-"");
",good
2178,147778-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2179,147778-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    String query = ""update users set hitcount=hitcount+1 where name=?"";
    preparedStatement = dbConnection.prepareStatement(query);
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
2180,147778-v1.0.0,java,"String data = System.getenv(""ADD"");
String names[] = data.split(""-"");
PreparedStatement sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
2181,147778-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
2182,147778-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",good
2183,146396-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2184,146396-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2185,146958-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2186,146958-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2187,146958-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2188,146958-v1.0.0,good,"String pattern = ""^[a-zA-Z0-9]+$"";
if (names[i].matches(pattern)) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
} else {
    // Handle invalid input
}
",good
2189,146958-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2190,146958-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2191,147284-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2192,147284-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2193,140909-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2194,140909-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2195,146248-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2196,146248-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2197,147136-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2198,147136-v1.0.0,good,"String escapedData = StringEscapeUtils.escapeSql(data);
sqlStatement.setString(1, escapedData);
",good
2199,147544-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_71b()).badSink((Object)data);
",bad
2200,147544-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2201,146778-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2202,146778-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2203,146778-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2204,146778-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2205,146778-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2206,147906-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_67b()).badSink(dataContainer);
",bad
2207,148247-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2208,146700-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2209,146700-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2210,146700-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2211,146700-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2212,146700-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_75b()).badSink(dataSerialized);
",bad
2213,146700-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2214,148107-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2215,148107-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2216,148107-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2217,148107-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2218,148107-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2219,148107-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2220,146771-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2221,146771-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""UPDATE users SET status = ? WHERE name = ?"");
    preparedStatement.setString(1, ""updated"");
    preparedStatement.setString(2, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
}
finally {
    // Close resources...
}
",good
2222,146771-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2223,146771-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2224,146771-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2225,148143-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2226,148143-v1.0.0,java,"data = token.substring(3);
",bad
2227,148143-v1.0.0,good,"data = request.getParameter(""id"");
",good
2228,148143-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
2229,148143-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2230,147465-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2231,147465-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2232,147458-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2233,147458-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
2234,146992-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2235,146992-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2236,146992-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2237,146992-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2238,146992-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2239,146992-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2240,146392-v1.0.0,java,"data = properties.getProperty(""data"");
(new CWE89_SQL_Injection__PropertiesFile_executeBatch_52b()).badSink(data );
",bad
2241,147079-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2242,147079-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2243,147079-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2244,147079-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2245,147079-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2246,147079-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2247,146611-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_72b()).badSink(dataVector , request, response );
",bad
2248,147756-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_74b()).badSink(dataHashMap);
",bad
2249,146720-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2250,146720-v1.0.0,good,"String id = ""0""; // This should be replaced with the actual user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2251,147903-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2252,147903-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2253,146368-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2254,146368-v1.0.0,good,"String query = ""select name from users where id=?"";
preparedStatement = connection.prepareStatement(query);
preparedStatement.setInt(1, id); // 'id' should be a variable that holds the user input
",good
2255,146368-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2256,146368-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
2257,146368-v1.0.0,java,"data = request.getParameter(""name"");
",bad
2258,146368-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement statement = connection.prepareStatement(""SELECT * FROM users WHERE name = ?"");
statement.setString(1, name);
ResultSet resultSet = statement.executeQuery();
",good
2259,148123-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2260,148123-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Add the following line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
2261,147693-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2262,147693-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
2263,148072-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2264,148072-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
2265,148072-v1.0.0,java,"data = request.getParameter(""name"");
dataBad = data;
badSink(request, response);
",bad
2266,148072-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2267,148072-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_53b()).badSink(data);
",bad
2268,148058-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_22b()).goodB2G2Sink(data , request, response);
",bad
2269,148058-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM users WHERE name = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2270,146185-v1.0.0,java,"data = request.getParameter(""name"");
",bad
2271,146185-v1.0.0,good,"String name = request.getParameter(""name"");
String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, name);
ResultSet resultSet = statement.executeQuery();
",good
2272,146185-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_22b()).goodB2G1Sink(data , request, response);
",bad
2273,146185-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2274,146185-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_51b()).badSink(data);
",bad
2275,146185-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    try {
        if (statement != null) {
            statement.close();
        }
    } catch (SQLException e) {
        // handle exception
    }
}
",good
2276,146251-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2277,146251-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2278,148039-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2279,148039-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2280,148039-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2281,148039-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2282,148039-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_72b()).badSink(dataVector);
",bad
2283,146326-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2284,146326-v1.0.0,good,"int id = 0; // This value should come from a trusted source and be properly sanitized
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
2285,146326-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_54b()).badSink(data , request, response);
",bad
2286,146326-v1.0.0,good,"// Instead of using the data variable directly in the SQL query, use a prepared statement with a parameter.
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2287,146326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2288,146326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2289,146286-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2290,146286-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2291,147109-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2292,147109-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput is a function that properly escapes special characters in the input to prevent SQL injection.
",good
2293,147109-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2294,147109-v1.0.0,good,"// Use a whitelist or a more secure method to validate and sanitize the data variable before using it in the prepared statement.
// For example, you could use a regular expression to ensure that the data variable only contains alphanumeric characters.
String sanitizedData = data.replaceAll(""[^a-zA-Z0-9]"", """");
sqlStatement.setString(1, sanitizedData);
",good
2295,147109-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2296,147109-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2297,146817-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2298,146234-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2299,146234-v1.0.0,good,"String id = ""0""; // This should be replaced with a dynamic value that is properly sanitized
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2300,146317-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_54b()).badSink(data );
",bad
2301,146317-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
2302,146563-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2303,146563-v1.0.0,good,"// Instead of getting the value of the first cookie, loop through all cookies and validate/sanitize the data
if (cookieSources != null) {
    for (Cookie cookie : cookieSources) {
        String cookieValue = cookie.getValue();
        // Validate and sanitize cookieValue here before adding it to dataVector
        dataVector.add(cookieValue);
    }
}
",good
2304,148122-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2305,148122-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
2306,147860-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_71b()).badSink((Object)data , request, response );
",bad
2307,147860-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2308,147860-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2309,147860-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id); // assuming id is an integer variable
",good
2310,147858-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2311,147858-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2312,148190-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2313,148190-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2314,147883-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2315,147883-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2316,147883-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2317,147883-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2318,147883-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_67b()).badSink(dataContainer);
",bad
2319,147088-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2320,147088-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
2321,147849-v1.0.0,java,"baseObject.action(data);
",bad
2322,147849-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2323,147849-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
2324,147849-v1.0.0,good,"int id = 0;
try {
    id = Integer.parseInt(data);
    if (id < 0) {
        throw new NumberFormatException(""Invalid ID"");
    }
} catch (NumberFormatException nfx) {
    // Handle the exception appropriately, e.g. return an error response
}

// Continue with the prepared statement and query execution as before
",good
2325,147849-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2326,147849-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2327,146630-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2328,146630-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2329,146630-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2330,146630-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2331,146630-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_53b()).badSink(data );
",bad
2332,148263-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2333,148263-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
2334,148263-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2335,148263-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
2336,148263-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
2337,148263-v1.0.0,good,"String names[] = StringEscapeUtils.escapeSql(data).split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
2338,148357-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2339,148357-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2340,147981-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2341,147981-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values (?) where name=?"");
pstmt.setString(1, ""updated"");
pstmt.setString(2, data);
int rowCount = pstmt.executeUpdate();
",good
2342,147338-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2343,147338-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2344,147338-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2345,147338-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2346,147338-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2347,146617-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2348,146617-v1.0.0,good,"// Use a whitelist to validate the data or use a parameterized query
String validData = validateData(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, validData);
",good
2349,140880-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2350,140880-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2351,146466-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2352,146466-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2353,148209-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2354,148209-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2355,147861-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2356,147861-v1.0.0,good,"sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
2357,147080-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2358,147080-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2359,147635-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_54b()).badSink(data );
",bad
2360,147635-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2361,146241-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2362,146241-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2363,146362-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2364,146362-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2365,148335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2366,148335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2367,148335-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2368,148335-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2369,148335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2370,148335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2371,147102-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2372,147102-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2373,146163-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2374,146163-v1.0.0,good,"// Add a method to sanitize the input
String sanitizeInput(String input) {
    // Implement your sanitization logic here
    // This could be as simple as replacing all non-alphanumeric characters with an empty string
    return input.replaceAll(""[^a-zA-Z0-9]"", """");
}

// Then use the sanitized input in the prepared statement
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2375,146166-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2376,146166-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2377,146457-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2378,146457-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2379,147293-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2380,147293-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2381,147293-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2382,147293-v1.0.0,good,"String id = ""0""; // This should be replaced with a safe input source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2383,147293-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_72b()).badSink(dataVector);
",bad
2384,146459-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2385,146459-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, sanitizeInput(names[i]));
    sqlStatement.addBatch();
}
",good
2386,147393-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2387,147393-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2388,148099-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2389,148099-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""'"", ""''""));
",good
2390,147581-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_71b()).badSink((Object)data);
",bad
2391,147581-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
2392,146301-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2393,146301-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2394,146301-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2395,146301-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2396,146301-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2397,146301-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data); // Ensure data is properly escaped or use parameterized queries
",good
2398,147193-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2399,147193-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2400,147193-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2401,147193-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2402,147193-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2403,147193-v1.0.0,good,"// Validate and sanitize the data variable
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
2404,146662-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2405,146662-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2406,146662-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2407,146662-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2408,146662-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2409,146662-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values (?) where name=?"");
pstmt.setString(1, ""updated"");
pstmt.setString(2, data);
int rowCount = pstmt.executeUpdate();
",good
2410,146499-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_72b()).badSink(dataVector);
",bad
2411,148155-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2412,148155-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2413,148155-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2414,148155-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data); // Ensure data is sanitized or validated before this line
",good
2415,148155-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2416,148155-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2417,147887-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2418,147887-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2419,147887-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2420,147887-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2421,147887-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2422,148244-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2423,146486-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2424,146486-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
// rest of the code...
",good
2425,146486-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_54b()).badSink(data );
",bad
2426,146486-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2427,146486-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2428,146486-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2429,147743-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2430,147743-v1.0.0,good,"// Validate and sanitize the cookie value before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
(new CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_52b()).badSink(sanitizedData , request, response);
",good
2431,147743-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_66b()).badSink(dataArray);
",bad
2432,146271-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2433,146271-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2434,146479-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2435,146479-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2436,146479-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2437,146479-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2438,146479-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2439,146479-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2440,146636-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2441,146636-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values (?) where name=?"");
preparedStatement.setString(1, ""updated"");
preparedStatement.setString(2, data);
int rowCount = preparedStatement.executeUpdate();
",good
2442,147247-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2443,147247-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2444,146690-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_51b()).badSink(data);
",bad
2445,146854-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2446,146854-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2447,148090-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2448,147527-v1.0.0,java,"baseObject.action(data);
",bad
2449,147527-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2450,147527-v1.0.0,good,"String id = ""0""; // This value should be properly sanitized and validated before using it in the query
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2451,146365-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_72b()).badSink(dataVector);
",bad
2452,146365-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
2453,146365-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
resultSet = preparedStatement.executeQuery();
",good
2454,146365-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2455,146365-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2456,147371-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2457,147371-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2458,147371-v1.0.0,java,"data = System.getenv(""ADD"");
",bad
2459,147371-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2460,147371-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2461,147371-v1.0.0,good,"String id = ""0""; // This should come from a trusted source and be properly sanitized
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2462,147025-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2463,147025-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2464,146237-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2465,146237-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2466,146418-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2467,146418-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2468,147564-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2469,147564-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data); // No change needed here, as the use of prepared statements and parameter binding already protects against SQL injection.
",good
2470,147564-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_72b()).badSink(dataVector , request, response );
",bad
2471,146582-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2472,146582-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2473,147619-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2474,147619-v1.0.0,good,"// Use a parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
2475,147138-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2476,147138-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2477,146298-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2478,146298-v1.0.0,java,"data = request.getParameter(""name"");
baseObject.action(data , request, response);
",bad
2479,146298-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2480,146298-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_73b()).badSink(dataLinkedList);
",bad
2481,146179-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_72b()).badSink(dataVector);
",bad
2482,146179-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
2483,146179-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_54b()).badSink(data );
",bad
2484,146179-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_72b()).badSink(dataVector);
",bad
2485,146179-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
stmt.setString(1, data);
stmt.executeUpdate();
",good
2486,146167-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2487,146167-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2488,146228-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2489,146228-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2490,146228-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2491,146228-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2492,146228-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2493,146228-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2494,148290-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_74b()).badSink(dataHashMap);
",bad
2495,148290-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2496,148290-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
2497,148290-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_68b()).badSink();
",bad
2498,148137-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2499,148137-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2500,148070-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_execute_74b()).badSink(dataHashMap , request, response );
",bad
2501,148070-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2502,148070-v1.0.0,good,"String id = ""0""; // This value should be obtained from a safe source, such as user input validation or parameterized queries.
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2503,148070-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2504,148070-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2505,147970-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2506,147970-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2507,147970-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2508,147970-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2509,147970-v1.0.0,java,"baseObject.action(data);
",bad
2510,146227-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2511,146227-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
2512,146227-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_66b()).badSink(dataArray);
",bad
2513,146227-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2514,147115-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_73b()).badSink(dataLinkedList);
",bad
2515,147115-v1.0.0,java,"baseObject.action(data);
",bad
2516,147601-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_54b()).badSink(data );
",bad
2517,147601-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2518,147601-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2519,147601-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2520,147601-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2521,147601-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2522,147672-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2523,146550-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_68b()).badSink();
",bad
2524,146550-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_53b()).badSink(data);
",bad
2525,146550-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2526,146550-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2527,147253-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2528,147253-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2529,147253-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2530,147253-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2531,147253-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
2532,147072-v1.0.0,java,"baseObject.action(data);
",bad
2533,147072-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2534,147072-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2535,147072-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2536,147533-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2537,147533-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2538,146357-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2539,146357-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2540,146580-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_52b()).badSink(data );
",bad
2541,146321-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_73b()).badSink(dataLinkedList);
",bad
2542,146321-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
statement.setString(1, data);
statement.executeUpdate();
",good
2543,146142-v1.0.0,java,"dataHashMap.put(0, data);
dataHashMap.put(1, data);
dataHashMap.put(2, data);
(new CWE89_SQL_Injection__listen_tcp_execute_74b()).badSink(dataHashMap);
",bad
2544,146142-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2545,146142-v1.0.0,good,"String safeData = data.replaceAll(""[^a-zA-Z0-9]"", """");
sqlStatement.setString(1, safeData);
",good
2546,146142-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2547,146142-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2548,146760-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2549,146760-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2550,147973-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_67b()).badSink(dataContainer);
",bad
2551,148087-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2552,148087-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly sanitizes user input to prevent SQL injection.
",good
2553,146635-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2554,146635-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2555,146635-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2556,146635-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2557,146635-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2558,146635-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // ... rest of the code
}
// ... rest of the code
",good
2559,148297-v1.0.0,java,"PreparedStatement p = function(conn, name);
p.executeQuery ();
",bad
2560,148297-v1.0.0,good,"PreparedStatement p = conn.prepareStatement(""SELECT * FROM table WHERE name = ?"");
p.setString(1, name);
p.executeQuery();
",good
2561,148171-v1.0.0,java,"PreparedStatement stmt = conn.prepareStatement(""select val from mytab where name = '"" + name + ""'"");
",bad
2562,148171-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""select val from mytab where name = ?"");
stmt.setString(1, name);
",good
2563,146954-v1.0.0,java,"PreparedStatement ps = function(conn, name);
ps.executeQuery ();
",bad
2564,146954-v1.0.0,good,"PreparedStatement ps = conn.prepareStatement(""SELECT * FROM table_name WHERE column_name = ?"");
ps.setString(1, name);
ps.executeQuery ();
",good
2565,147910-v1.0.0,java,"conn.prepareStatement (""SELECT * FROM users WHERE firstname LIKE '"" + name + ""'"").executeQuery ();
",bad
2566,147910-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE firstname LIKE ?"");
stmt.setString(1, ""%"" + name + ""%"");
ResultSet rs = stmt.executeQuery();
",good
2567,147376-v1.0.0,java,"PreparedStatement stmt = conn.prepareStatement(""select val from mytab where name = ?"");
stmt.setString(1, name);
",bad
2568,147376-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""select val from mytab where name = ?"");
stmt.setString(1, sanitizeInput(name));
",good
2569,147953-v1.0.0,java,"ps.setString(1, array_buffer[ 0 ][ 128 ]);
",bad
2570,147953-v1.0.0,good,"ps.setString(1, ""%"" + name + ""%"");
",good
2571,146793-v1.0.0,java,"PreparedStatement ps = conn.prepareStatement( ""SELECT * FROM users WHERE firstname LIKE ?"" );
ps.setString(1, name);
",bad
2572,146793-v1.0.0,good,"PreparedStatement ps = conn.prepareStatement( ""SELECT * FROM users WHERE firstname LIKE ?"" );
ps.setString(1, ""%"" + name + ""%"");
",good
2573,147037-v1.0.0,java,"conn.prepareStatement (""SELECT * FROM users WHERE firstname LIKE '"" + array_buffer[ 0 ][ 128 ] + ""'"").executeQuery ();
",bad
2574,147037-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE firstname LIKE ?"");
stmt.setString(1, ""%"" + name + ""%"");
ResultSet rs = stmt.executeQuery();
",good
