,identifier,language,code,label
0,146505-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_72b()).badSink(dataVector);
",bad
1,146505-v1.0.0,good,"// Use a prepared statement or parameterized query to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table_name (column_name) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
2,147769-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3,147769-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
4,147769-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
5,147769-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
6,147769-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
7,146997-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
8,146997-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
9,146997-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
10,146997-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
11,146997-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
12,146997-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
13,147721-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
14,147721-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
15,148028-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
16,148028-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
17,148028-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
18,148028-v1.0.0,java,"data = System.getProperty(""user.home"");
sqlStatement.setString(1, data);
",bad
19,148028-v1.0.0,good,"data = System.getProperty(""user.home"");
// Ensure data is properly sanitized or validated before using it in the SQL query
// For example, using a whitelist of allowed characters or using a prepared statement with parameters
sqlStatement.setString(1, sanitizeInput(data));
",good
20,147967-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
21,147967-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
22,147967-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
23,147967-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
24,147967-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
25,147967-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
26,147210-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
27,147210-v1.0.0,good,"// Use a loop to iterate through all cookies and validate/sanitize the data
for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""desired_cookie_name"")) {
        data = sanitizeInput(cookie.getValue());
        break;
    }
}
",good
28,146206-v1.0.0,java,"data = readerBuffered.readLine();
(new CWE89_SQL_Injection__connect_tcp_executeBatch_67b()).badSink(dataContainer);
",bad
29,146206-v1.0.0,good,"String query = ""INSERT INTO table (column) VALUES (?)"";
try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    pstmt.executeUpdate();
} catch (SQLException e) {
    e.printStackTrace();
}
",good
30,147885-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
31,147885-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, java.sql.DriverManager.getConnection(""jdbc:mysql://localhost:3306/dbname"", ""user"", ""password"").prepareCall(""SELECT name FROM users WHERE name = ?"").setString(1, data).executeQuery().getString(""name""));
",good
32,147885-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
33,147885-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
34,147885-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
35,147885-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
36,146699-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
37,146699-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizedData);
",good
38,146699-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
39,146699-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
40,146699-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
41,146699-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
42,148162-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_52b()).badSink(data );
",bad
43,148162-v1.0.0,good,"String data = System.getProperty(""user.home"");
PreparedStatement statement = connection.prepareStatement(""SELECT * FROM users WHERE home = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
44,146378-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
45,146378-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
46,147623-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
47,147623-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
48,147623-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
49,147623-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
50,147623-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
51,147623-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
52,148289-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
53,148289-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
54,148289-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
55,148289-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
56,148289-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
57,148289-v1.0.0,good,"// Validate data before using it in the query
if (data != null && !data.matches(""[a-zA-Z0-9]+"")) {
    throw new IllegalArgumentException(""Invalid data: "" + data);
}
sqlStatement.setString(1, data);
",good
58,148237-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_53b()).badSink(data );
",bad
59,147455-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response );
",bad
60,147455-v1.0.0,good,"String data = request.getParameter(""name"");
// Use a PreparedStatement to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
// Use the result set
",good
61,148226-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
62,148226-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
63,148226-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
64,148226-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
65,148226-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
66,148226-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
67,146737-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
68,146737-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
69,146737-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
70,146737-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
71,146544-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_74b()).badSink(dataHashMap);
",bad
72,146730-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
73,146730-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
74,146686-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
75,146686-v1.0.0,good,"String id = getIdFromUserInput(); // get user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
76,147440-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
77,147440-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
78,147440-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
79,147440-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
80,147440-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
81,147604-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
82,147604-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
83,147985-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_72b()).badSink(dataVector);
",bad
84,146727-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
85,146727-v1.0.0,good,"String userId = ""0""; // This should be replaced with a dynamic value from a trusted source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, userId);
",good
86,148249-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
87,148249-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
88,148352-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_67b()).badSink(dataContainer);
",bad
89,148352-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
stmt.setString(1, data);
stmt.executeUpdate();
",good
90,148326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
91,148326-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
92,148326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
93,148326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
94,148326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
95,146217-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
96,146217-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
97,146217-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
98,146217-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
99,146217-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
100,146354-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_67b()).badSink(dataContainer);
",bad
101,146354-v1.0.0,good,"PreparedStatement statement = null;
try {
    Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""username"", ""password"");
    String sql = ""INSERT INTO table (column) VALUES (?)"";
    statement = connection.prepareStatement(sql);
    statement.setString(1, data);
    statement.executeUpdate();
} catch (SQLException e) {
    e.printStackTrace();
} finally {
    if (statement != null) {
        statement.close();
    }
}
",good
102,148299-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
103,148299-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is sanitized or validated before inserting into the query
",good
104,148299-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
105,148299-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
106,148299-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
107,148299-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
108,140883-v1.0.0,java,"data = request.getParameter(""id"");
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
109,140883-v1.0.0,good,"// Validate the input to ensure it is a valid integer
try {
    id = Integer.parseInt(data);
} catch (NumberFormatException nfx) {
    // If the input is not a valid integer, return an error response
    response.sendError(HttpServletResponse.SC_BAD_REQUEST, ""Invalid user ID"");
    return;
}
",good
110,147355-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_71b()).badSink((Object)data);
",bad
111,146674-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
112,146674-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
113,147874-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_72b()).badSink(dataVector);
",bad
114,147874-v1.0.0,good,"PreparedStatement preparedStatement = null;
String sql = ""INSERT INTO table (column) VALUES (?)"";
try {
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    e.printStackTrace();
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
115,147191-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
116,147191-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
117,147659-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
118,147659-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
119,147659-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
120,147659-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
121,147659-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
122,147659-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
123,146429-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_68b()).badSink();
",bad
124,147047-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
125,147047-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
126,148187-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
127,148187-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
128,148187-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
129,148187-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
130,148187-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
131,148198-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_51b()).badSink(data);
",bad
132,147185-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
133,147185-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
134,147185-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
135,147185-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
136,147185-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
137,147185-v1.0.0,good,"// Use a whitelist or validation to ensure that the data variable only contains expected values
// This is a simple example of validation, you may need a more complex validation based on your application's requirements
if (!isValid(data)) {
    throw new IllegalArgumentException(""Invalid data"");
}
sqlStatement.setString(1, data);
",good
138,147891-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
139,147891-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
140,147891-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
141,147891-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
142,147891-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
143,147891-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
144,147112-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
145,147112-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
146,147112-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
147,147112-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
148,148020-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_68b()).badSink();
",bad
149,140885-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
150,140885-v1.0.0,good,"try {
    id = Integer.parseInt(data);
    preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
    preparedStatement.setInt(1, id);
    // ...
} catch (NumberFormatException nfx) {
    // Handle the exception appropriately, such as returning an error message to the user
    // ...
}
",good
151,146186-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
152,146186-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
153,146186-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
154,146186-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
155,146186-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
156,146639-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
157,146639-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
158,146639-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
159,146639-v1.0.0,good,"String id = ""0""; // This should be replaced with user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
160,146639-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
161,146639-v1.0.0,good,"String id = ""0""; // This value should come from a safe source, such as user input validation or a secure configuration
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
162,146932-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
163,146932-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
164,146406-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
165,146406-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
166,146406-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
167,146406-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
168,146406-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
169,148246-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_74b()).badSink(dataHashMap);
",bad
170,147231-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
171,147231-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""desired_cookie_name"")) {
        data = cookie.getValue();
        break;
    }
}
",good
172,147231-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
173,147231-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE cookie_value = ?"");
pstmt.setString(1, cookieSources[0].getValue());
",good
174,147231-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
175,147231-v1.0.0,good,"private void goodB2G1(HttpServletRequest request, HttpServletResponse response) throws Throwable
{
    String data = null;

    data = """"; /* initialize data in case there are no cookies */

    /* Read data from cookies */
    {
        Cookie cookieSources[] = request.getCookies();
        if (cookieSources != null)
        {
            /* Validate and sanitize the cookie value */
            for (Cookie cookie : cookieSources) {
                if (cookie.getName().equals(""your_cookie_name"")) {
                    data = sanitizeInput(cookie.getValue());
                    break;
                }
            }
        }
    }

    goodB2G1PublicStatic = false;
    (new CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_22b()).goodB2G1Sink(data , request, response);
}

private String sanitizeInput(String input) {
    // Implement your input sanitization logic here
    // This could include removing special characters, escaping quotes, etc.
    // For example, using a library like OWASP's ESAPI for input validation and encoding
    return input;
}
",good
176,148219-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
177,148219-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before using it in the SQL query
",good
178,148219-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
179,148219-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
180,148219-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
181,148219-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, java.sql.DriverManager.getConnection(url, user, password).quote(data));
",good
182,147976-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_51b()).badSink(data);
",bad
183,146754-v1.0.0,java,"data = System.getenv(""ADD"");
",bad
184,146754-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
185,147965-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
186,147965-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data.replace(""'"", ""''"")); // Escape single quotes to prevent SQL injection
",good
187,147965-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
188,147965-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
189,147965-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
190,147965-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Use a whitelist or other input validation to ensure that the data variable only contains safe input.
// Alternatively, use a parameterized query to prevent SQL injection.
",good
191,147194-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
192,147194-v1.0.0,good,"// Validate and sanitize the data before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
",good
193,147194-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
194,147194-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""safeCookieName"")) {
        data = cookie.getValue();
        break;
    }
}
",good
195,147194-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
196,147194-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE username = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
197,147334-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
198,147334-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
199,147334-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
200,147334-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
201,147334-v1.0.0,good,"Pattern pattern = Pattern.compile(""[a-zA-Z0-9_-]+"");
for (int i = 0; i < names.length; i++) {
    if (pattern.matcher(names[i]).matches()) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    } else {
        // Handle invalid input
    }
}
",good
202,146350-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_53b()).badSink(data );
",bad
203,146315-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
204,146315-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
205,146161-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
206,146161-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
207,147918-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
208,147918-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
209,147918-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
210,147918-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
211,147918-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
212,147918-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
213,147040-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
214,147040-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
215,147040-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
216,147040-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
217,147040-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
218,147040-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
219,148094-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_68b()).badSink();
",bad
220,148094-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE username = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
221,146422-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_51b()).badSink(data);
",bad
222,146422-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
223,146294-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
224,146294-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add validation and sanitization for the data variable here
",good
225,146294-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
226,146294-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
227,146294-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
228,146294-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that sanitizes the input to prevent SQL injection.
",good
229,146590-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
230,146590-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
231,146590-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
232,146590-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
233,146590-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
234,146590-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
235,146288-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
236,146288-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
237,146675-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
238,146675-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
239,146675-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
240,146675-v1.0.0,good,"String userId = ""0""; // Assuming this value is coming from a safe source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, userId);
",good
241,146675-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
242,146675-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
243,147121-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
244,147121-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
245,146732-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
246,146732-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
247,147201-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
248,146896-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
249,146896-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
250,148111-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
251,148111-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
252,148111-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
253,148111-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
254,148159-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
255,148159-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
256,146795-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_54b()).badSink(data );
",bad
257,147150-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
258,147150-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
259,148333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
260,148333-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
261,148333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
262,148333-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
263,148333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
264,148333-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
265,147728-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_74b()).badSink(dataHashMap , request, response );
",bad
266,147728-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
267,147184-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
268,147184-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, java.sql.PreparedStatement.escapeString(data));
",good
269,147184-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
270,147184-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
271,147184-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
272,147184-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
273,147815-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
274,147815-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
275,147815-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
276,147815-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
277,147815-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
278,146915-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_75b()).badSink(dataSerialized);
",bad
279,147049-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
280,147049-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
281,146181-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
282,146181-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
283,146181-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // ... rest of the code
}
// ... rest of the code
",good
284,146181-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
285,146181-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
286,146799-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_68b()).badSink();
",bad
287,146799-v1.0.0,good,"String add = System.getenv(""ADD"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, add);
ResultSet rs = stmt.executeQuery();
",good
288,146440-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
289,146440-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
290,146440-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
291,146440-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
292,146440-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
293,146440-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
294,146946-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_67b()).badSink(dataContainer);
",bad
295,146267-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
296,146267-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
297,146750-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_22b()).goodB2G2Sink(data );
",bad
298,146750-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
299,146750-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_22b()).badSink(data);
",bad
300,146750-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
301,146750-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_22b()).goodB2G1Sink(data );
",bad
302,146750-v1.0.0,good,"private void goodB2G1() throws Throwable {
    String data = null;

    /* get environment variable ADD */
    data = System.getenv(""ADD"");

    goodB2G1PublicStatic = false;
    Connection conn = /* obtain database connection */;
    PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // use ResultSet...
}
",good
303,146811-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
304,146811-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
305,146811-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
306,146811-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
307,146811-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
308,146811-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
309,146592-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
310,146592-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
311,146592-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
312,146592-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
313,146592-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
314,146592-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
315,147146-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
316,147146-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
317,147146-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
318,147146-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
319,147146-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
320,146224-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
321,146224-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
322,146224-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
323,146224-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
324,146224-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data.replaceAll(""[';\\-]"", """"));
",good
325,146151-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
326,146151-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
327,140912-v1.0.0,java,"(new CWE566_Authorization_Bypass_Through_SQL_Primary__Servlet_72b()).badSink(dataVector , request, response );
",bad
328,147456-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
329,147456-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
330,147710-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
331,147710-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
332,147143-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
333,147143-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
334,147143-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
335,147143-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
336,147143-v1.0.0,good,"String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
337,147893-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
338,147893-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
339,147893-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
340,147893-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
341,147893-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
342,147893-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
343,146849-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
344,146849-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
345,146849-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
346,146849-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
347,146849-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
348,146849-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
349,147690-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_execute_73b()).badSink(dataLinkedList , request, response );
",bad
350,147690-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
351,147314-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
352,147314-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
353,148170-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_72b()).badSink(dataVector);
",bad
354,148170-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
355,147139-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
356,147139-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
357,147914-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_75b()).badSink(dataSerialized);
",bad
358,146343-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_22b()).goodB2G2Sink(data );
",bad
359,146343-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_22b()).badSink(data );
",bad
360,146343-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_22b()).goodB2G1Sink(data );
",bad
361,146343-v1.0.0,good,"import org.apache.commons.dbutils.DbUtils;

// ...

String sanitizedData = DbUtils.escapeString(data);
(new CWE89_SQL_Injection__connect_tcp_prepareStatement_22b()).goodB2G1Sink(sanitizedData);
",good
362,147120-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
363,147120-v1.0.0,good,"// Validate and sanitize the cookie value before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
(new CWE89_SQL_Injection__getCookies_Servlet_executeQuery_22b()).goodB2G2Sink(sanitizedData , request, response);
",good
364,147120-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
365,147120-v1.0.0,good,"// Instead of using the first cookie value, loop through all cookies and validate/sanitize their values
for (Cookie cookie : cookieSources) {
    String cookieValue = cookie.getValue();
    // Validate and sanitize cookieValue here
    // ...
    data += cookieValue; // or append it to a list, depending on the use case
}
",good
366,147120-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
367,147610-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
368,147610-v1.0.0,good,"PreparedStatement preparedStatement = null;
ResultSet resultSet = null;

try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
    preparedStatement.setString(1, data);

    resultSet = preparedStatement.executeQuery();

    IO.writeLine(resultSet.getRow());
}
// ... rest of the code remains the same
",good
369,148022-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_72b()).badSink(dataVector);
",bad
370,147062-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_74b()).badSink(dataHashMap);
",bad
371,146408-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
372,146408-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
373,146408-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
374,146408-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
375,146408-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
376,147034-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
377,147034-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
378,147034-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
379,147034-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
380,147034-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
381,147034-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
382,147668-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
383,147668-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
384,147149-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
385,147149-v1.0.0,good,"// Add input validation to ensure that the data is safe to use in the SQL query
String safeData = sanitizeInput(data);
sqlStatement.setString(1, safeData);
",good
386,147149-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
387,147149-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
388,147149-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
389,147149-v1.0.0,good,"// Validate and sanitize data variable
String sanitizedData = sanitizeInput(data);

// Use sanitized data in prepared statement
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizedData);
",good
390,147725-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_71b()).badSink((Object)data , request, response );
",bad
391,147725-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
392,146796-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
393,146796-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
} catch (SQLException exceptSql) {
    // Handle exception
} finally {
    // Close resources
}
",good
394,147401-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
395,147401-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
396,147401-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
397,147401-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
398,147401-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
399,147401-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
400,147431-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_73b()).badSink(dataLinkedList);
",bad
401,147431-v1.0.0,good,"PreparedStatement preparedStatement = null;
String sql = ""INSERT INTO table (column) VALUES (?)"";
try {
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
402,146523-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
403,146523-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
404,146523-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
405,146523-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
406,146523-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
407,146523-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
408,146412-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
409,146412-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
410,146412-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
411,146412-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
412,146412-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
413,146412-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is sanitized or validated before inserting into the query
",good
414,147811-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
415,147811-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
416,147811-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
417,147811-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
418,147811-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
419,147811-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
420,148077-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
421,148077-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
422,148077-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
423,148077-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
424,148077-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped to prevent SQL injection
data = java.sql.DriverManager.getConnection(""jdbc:mysql://localhost:3306/test"", ""user"", ""password"").prepareStatement(""SELECT ?"").setString(1, data).toString();
",good
425,148272-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_51b()).badSink(data);
",bad
426,146940-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_51b()).badSink(data);
",bad
427,146940-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
428,146923-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
429,146923-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
430,146923-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
431,146923-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
432,146923-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
433,147809-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
434,147809-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
435,147809-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
436,147809-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
437,147809-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
438,147809-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
439,147643-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_51b()).badSink(data , request, response );
",bad
440,147643-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_51b()).badSink(data , request, response );
",good
441,147884-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
442,147884-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
443,147884-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
444,147884-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
445,147884-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
446,147884-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
447,147943-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
448,147943-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
449,140916-v1.0.0,java,"data = request.getParameter(""id"");
baseObject.action(data , request, response);
",bad
450,140916-v1.0.0,good,"String userId = request.getParameter(""id"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE id = ?"");
pstmt.setString(1, userId);
ResultSet rs = pstmt.executeQuery();
// Use the result set...
",good
451,146569-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
452,146569-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
453,146507-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_74b()).badSink(dataHashMap);
",bad
454,147256-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
455,147256-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
456,147256-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
457,147256-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
458,147256-v1.0.0,java,"data = request.getParameter(""name"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
459,147256-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
460,147492-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response );
",bad
461,147492-v1.0.0,good,"public void good(HttpServletRequest request, HttpServletResponse response) throws Throwable {
    String data;
    data = request.getParameter(""name"");

    // Use a prepared statement to prevent SQL injection
    String sql = ""SELECT * FROM users WHERE name = ?"";
    PreparedStatement statement = connection.prepareStatement(sql);
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();

    // Process the result set...
}
",good
462,147486-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
463,147486-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
464,147486-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
465,147486-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
466,147486-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
467,147486-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
468,147689-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_execute_72b()).badSink(dataVector , request, response );
",bad
469,147882-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
470,147882-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
471,147882-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
472,147882-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
473,147882-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
474,147882-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes special characters in the input to prevent SQL injection.
",good
475,147867-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_53b()).badSink(data);
",bad
476,147867-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (PreparedStatement statement = connection.prepareStatement(query)) {
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
477,147952-v1.0.0,java,"data = properties.getProperty(""data"");
...
baseObject.action(data);
",bad
478,147152-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
479,147152-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
480,147152-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
481,147152-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
482,147152-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
483,147152-v1.0.0,good,"String sanitizedData = data.replaceAll(""[';\\-]"", """");
sqlStatement.setString(1, sanitizedData);
",good
484,147729-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_75b()).badSink(dataSerialized , request, response );
",bad
485,140894-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
486,140894-v1.0.0,good,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",good
487,147745-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
488,147745-v1.0.0,good,"for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
489,147745-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
490,147745-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    for (int i = 0; i < names.length; i++) {
        /* Fixed SQL Injection: Using a prepared statement to prevent SQL Injection */
        preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
491,147745-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
492,146469-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_73b()).badSink(dataLinkedList);
",bad
493,146595-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
494,146595-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
495,147336-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
496,147336-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
DbUtils.setObject(sqlStatement, 1, names[i]);
",good
497,147336-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
498,147336-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
499,147336-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
500,147336-v1.0.0,good,"String pattern = ""^[a-zA-Z0-9-]+$"";
for (int i = 0; i < names.length; i++) {
    if (names[i].matches(pattern)) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    } else {
        // Handle invalid input
    }
}
",good
501,147241-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
502,147241-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""desiredCookieName"")) {
        data = cookie.getValue();
        break;
    }
}
",good
503,146952-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_75b()).badSink(dataSerialized);
",bad
504,146688-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
505,146688-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
506,146903-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_51b()).badSink(data);
",bad
507,146903-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    e.printStackTrace();
}
",good
508,147006-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
509,147006-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
510,147097-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
511,147097-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""desired_cookie_name"")) {
        data = cookie.getValue();
        break;
    }
}
",good
512,147700-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
513,147700-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
514,147700-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
515,147700-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
516,147700-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
517,147700-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
518,146543-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_73b()).badSink(dataLinkedList);
",bad
519,146543-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
preparedStatement.setString(1, data);
preparedStatement.executeUpdate();
",good
520,146985-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_71b()).badSink((Object)data);
",bad
521,146985-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement pstmt = conn.prepareStatement(query);
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
522,146154-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
523,146154-v1.0.0,good,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name IN (?)"");
String inClause = String.join("","", Collections.nCopies(names.length, ""?""));
sqlStatement.setString(1, ""('"" + String.join(""','"", names) + ""')"");
sqlStatement.executeUpdate();
",good
524,146154-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
525,146154-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
526,146154-v1.0.0,java,"String data = System.getenv(""ADD"");
String names[] = data.split(""-"");
...
PreparedStatement sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
...
",bad
527,147640-v1.0.0,java,"data = token.substring(3);
",bad
528,147640-v1.0.0,good,"data = request.getParameter(""id"");
",good
529,147886-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
530,147886-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
531,147886-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
532,147886-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
533,147886-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
534,147886-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
535,147226-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
536,147226-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
537,147226-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
538,147226-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
539,147226-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
540,147226-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before being used in the SQL query
",good
541,146247-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_73b()).badSink(dataLinkedList);
",bad
542,148210-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_75b()).badSink(dataSerialized);
",bad
543,148082-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_22b()).goodB2G2Sink(data);
",bad
544,148082-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_22b()).badSink(data);
",bad
545,148082-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_22b()).goodB2G1Sink(data );
",bad
546,148082-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
547,147257-v1.0.0,java,"data = request.getParameter(""name"");
String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
548,147257-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, java.sql.PreparedStatement.escapeString(names[i]));
",good
549,147257-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
550,147257-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
551,147257-v1.0.0,java,"data = request.getParameter(""name"");
String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
552,147257-v1.0.0,good,"data = request.getParameter(""name"");
String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, ""'"" + names[i].replaceAll(""'"", ""''"") + ""'"");
    sqlStatement.addBatch();
}
",good
553,147361-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
554,147361-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
555,147042-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
556,147042-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
557,147042-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
558,147042-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
559,147042-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
560,147182-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
561,147182-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
562,147182-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
563,147182-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
564,147182-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
565,147182-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
566,147677-v1.0.0,java,"data = token.substring(3);
",bad
567,147677-v1.0.0,good,"data = request.getParameter(""id"");
",good
568,148338-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
569,148338-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
570,146834-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_66b()).badSink(dataArray);
",bad
571,147342-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_22b()).goodB2G2Sink(data);
",bad
572,147342-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_22b()).badSink(data );
",bad
573,147342-v1.0.0,java,"data = properties.getProperty(""data"");
",bad
574,147634-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
575,147634-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
576,147634-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
577,147634-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
578,147634-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
579,147634-v1.0.0,good,"String data = request.getParameter(""id"");
if (data != null) {
    // Validate and sanitize the data variable
    PolicyFactory policy = new HtmlPolicyBuilder().toFactory();
    data = policy.sanitize(data);

    // Use the sanitized data variable in the prepared statement
    sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    sqlStatement.setString(1, data);
    int rowCount = sqlStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
",good
580,146810-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
581,146810-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
582,146810-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
583,146810-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
584,146810-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
585,146810-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped to prevent SQL injection
sqlStatement.setString(1, java.sql.DriverManager.getConnection(""jdbc:mysql://localhost:3306/test"", ""user"", ""password"").prepareStatement(""SELECT ?"").setString(1, data).toString());
",good
586,140884-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
587,140884-v1.0.0,good,"// Validate the input to ensure it is a valid integer
try {
    id = Integer.parseInt(data);
} catch (NumberFormatException nfx) {
    // Handle the exception appropriately, such as returning an error message to the user
    return;
}

// Use a parameterized query to prevent SQL injection
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",good
588,146420-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
589,146420-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
590,147435-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
591,147435-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""UPDATE users SET status = ? WHERE name = ?"");
    preparedStatement.setString(1, ""updated"");
    preparedStatement.setString(2, data);

    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources...
}
",good
592,148029-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
593,148029-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
594,148029-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
595,148029-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
596,148029-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
597,148029-v1.0.0,good,"// Sanitize the input using a whitelist approach
Pattern pattern = Pattern.compile(""[^a-zA-Z0-9]"");
String sanitizedData = pattern.matcher(data).replaceAll("""");

// Use the sanitized input in the query
sqlStatement.setString(1, sanitizedData);
",good
598,146556-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
599,146556-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
600,146556-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
601,146556-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
pstmt.setString(1, names[i]);
sqlStatement.addBatch(pstmt);
",good
602,146556-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
603,146556-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
604,147233-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
605,147233-v1.0.0,good,"if (cookieSources != null && cookieSources.length > 0) {
    data = cookieSources[0].getValue();
    // Validate and sanitize data here
    data = sanitizeInput(data);
}
",good
606,147272-v1.0.0,java,"data = request.getParameter(""name"");
",bad
607,147272-v1.0.0,good,"// Use a PreparedStatement with a parameterized query to prevent SQL injection
String name = request.getParameter(""name"");
String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
608,146547-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
609,146547-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
610,147428-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_68b()).badSink();
",bad
611,140888-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
612,140888-v1.0.0,good,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",good
613,147951-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_75b()).badSink(dataSerialized);
",bad
614,147569-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeBatch_51b()).badSink(data , request, response );
",bad
615,147569-v1.0.0,good,"PreparedStatement pstmt = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
616,146944-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
617,146944-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
618,147626-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
619,147626-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
620,147626-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
621,147626-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
622,147626-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
623,147626-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before using it in the SQL query
",good
624,146458-v1.0.0,java,"data = readerBuffered.readLine();
dataBad = data;
badSink();
",bad
625,146458-v1.0.0,good,"String query = ""SELECT * FROM users WHERE username = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet result = statement.executeQuery();
",good
626,148036-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
627,148036-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
628,148036-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
629,148036-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
630,148036-v1.0.0,java,"data = System.getProperty(""user.home"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
631,148036-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
632,147712-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_22b()).goodB2G2Sink(data , request, response);
",bad
633,147712-v1.0.0,good,"PreparedStatement pstmt = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
634,147712-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_22b()).badSink(data , request, response);
",bad
635,147712-v1.0.0,good,"PreparedStatement pstmt = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
636,147712-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_22b()).goodB2G1Sink(data , request, response);
",bad
637,147712-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
638,146633-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
639,146633-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",good
640,146633-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
641,146633-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
642,146633-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
643,146633-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
644,146826-v1.0.0,java,"badSink(data);
",bad
645,146826-v1.0.0,good,"// Use prepared statements or parameterized queries to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
646,146868-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_53b()).badSink(data );
",bad
647,146868-v1.0.0,good,"public void good() throws Throwable {
    String data;

    /* get environment variable ADD */
    data = System.getenv(""ADD"");

    Connection conn = /* obtain database connection */
    PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process results
}
",good
648,147585-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
649,147585-v1.0.0,good,"String id = request.getParameter(""id"");
data = (id != null) ? id : """";
",good
650,147585-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
651,147585-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
652,147585-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken(); /* a token will be like ""id=foo"" */
    if(token.startsWith(""id="")) /* check if we have the ""id"" parameter"" */
    {
        data = token.substring(3); /* set data to ""foo"" */
        break; /* exit while loop */
    }
}
",bad
653,147585-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null && !id.isEmpty()) {
    data = id;
}
",good
654,147379-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_22b()).goodB2G2Sink(data );
",bad
655,147379-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
656,147379-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_22b()).badSink(data);
",bad
657,147379-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
658,147379-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_22b()).goodB2G1Sink(data);
",bad
659,147701-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
660,147701-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
661,147701-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
662,147701-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
663,147701-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
664,147701-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
665,147433-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_75b()).badSink(dataSerialized);
",bad
666,147654-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_74b()).badSink(dataHashMap , request, response );
",bad
667,148224-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
668,148224-v1.0.0,good,"// Use a PreparedStatement with parameter binding to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
669,148224-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
670,148224-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
671,148224-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
672,148224-v1.0.0,good,"String escapedData = StringEscapeUtils.escapeSql(data);
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, escapedData);
",good
673,146645-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
674,146645-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
675,147222-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
676,147222-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
677,147222-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
678,147222-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
679,147222-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
680,147222-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
681,147972-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
682,147972-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
683,146516-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
684,146516-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
685,146516-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
686,146516-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
687,146516-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
688,146516-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
689,147259-v1.0.0,java,"data = request.getParameter(""name"");
String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
690,147259-v1.0.0,good,"// Sanitize input
data = sanitizeInput(request.getParameter(""name""));
String names[] = data.split(""-"");
for (int i = 0; i < names.length; i++) {
    names[i] = sanitizeInput(names[i]);
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
691,147259-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
692,147259-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
693,147259-v1.0.0,java,"String data = request.getParameter(""name"");
String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
...
",bad
694,146752-v1.0.0,java,"data = System.getenv(""ADD"");
badSink(data);
",bad
695,147039-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
696,147039-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
697,147332-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
698,147332-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
699,147332-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
700,147332-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // ... rest of the code
}
// ... rest of the code
",good
701,147332-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
702,146717-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
703,146717-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
704,146950-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_73b()).badSink(dataLinkedList);
",bad
705,146950-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
706,146250-v1.0.0,java,"data = readerBuffered.readLine();
baseObject.action(data);
",bad
707,147617-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_74b()).badSink(dataHashMap , request, response );
",bad
708,147167-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
709,147167-v1.0.0,good,"// Validate and sanitize the cookie value before assigning it to the data variable
String cookieValue = cookieSources[0].getValue();
// Use a library or method to validate and sanitize the input
String sanitizedValue = sanitizeInput(cookieValue);
data = sanitizedValue;
",good
710,146230-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
711,146230-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
712,148329-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
713,148329-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
714,148329-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
715,148329-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
716,148329-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
717,148329-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));

// Add a function to sanitize input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, whitelisting allowed characters, etc.
    // For example, using a library like OWASP's ESAPI can help with this
    return input;
}
",good
718,146534-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_52b()).badSink(data );
",bad
719,146534-v1.0.0,good,"PreparedStatement statement = null;
try {
    statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    if (statement != null) {
        try {
            statement.close();
        } catch (SQLException e) {
            // handle exception
        }
    }
}
",good
720,146899-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
721,146899-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
722,148067-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
723,148067-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
724,148067-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
725,148067-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
726,148067-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
727,146284-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_73b()).badSink(dataLinkedList);
",bad
728,146906-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_54b()).badSink(data);
",bad
729,146906-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String sql = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
730,147055-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
731,147055-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
732,147028-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
733,147028-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
734,147750-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
735,147750-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
736,146681-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
737,146681-v1.0.0,good,"String id = ""0""; // This should be replaced with user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
738,146914-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_74b()).badSink(dataHashMap);
",bad
739,147482-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
740,147482-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
741,147482-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
742,147482-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
743,147482-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
744,147482-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status='updated' where name=?"");
sqlStatement.setString(1, data);
",good
745,147628-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
746,147628-v1.0.0,good,"// Use a whitelist or validation to ensure that the data variable only contains safe input
String safeData = validateInput(data);
sqlStatement.setString(1, safeData);
",good
747,147628-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
748,147628-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
749,147628-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
750,147628-v1.0.0,good,"String data = request.getParameter(""id"");
if (data != null) {
    data = data.replaceAll(""[^a-zA-Z0-9_]"", """"); // remove non-alphanumeric and underscore characters
    data = data.substring(0, Math.min(data.length(), 50)); // limit length to 50 characters
} else {
    data = """"; // initialize data in case id is not in query string
}
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
751,147130-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
752,147130-v1.0.0,good,"if (cookieSources != null) {
    data = cookieSources[0].getValue();
    // Sanitize the input
    data = data.replaceAll(""[';\\-]"", """");
}
",good
753,147466-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_71b()).badSink((Object)data , request, response );
",bad
754,147466-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
755,147955-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
756,147955-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
757,147955-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
758,147955-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
759,147955-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
760,147955-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
761,147632-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
762,147632-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
763,147632-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
764,147632-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
765,147632-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
766,147632-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
767,148083-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
768,148083-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
769,140903-v1.0.0,java,"data = request.getParameter(""id"");
",bad
770,140903-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    // Use prepared statements to prevent SQL injection
    String sql = ""SELECT * FROM users WHERE id = ?"";
    PreparedStatement statement = connection.prepareStatement(sql);
    statement.setString(1, id);
    ResultSet result = statement.executeQuery();
    // Rest of the code
}
",good
771,146862-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
772,146862-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
773,147622-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
774,147622-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, request.getParameter(""id""));
",good
775,147622-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
776,147622-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
777,147622-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
778,147622-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
779,147717-v1.0.0,java,"data = token.substring(3);
",bad
780,147717-v1.0.0,good,"data = request.getParameter(""id"");
",good
781,146610-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
782,146610-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
783,147399-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
784,147399-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
785,147399-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
786,147399-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
787,147399-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
788,147399-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
789,148080-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
790,148080-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
791,147923-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
792,147923-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
793,147923-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
794,147923-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
795,147923-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
796,147923-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
797,147214-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
798,147214-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add this line to prevent SQL injection
data = data.replaceAll(""'"", ""''"");
",good
799,147214-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
800,147214-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
801,147214-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
802,147214-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
803,148216-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
804,148216-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
805,148216-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
806,148216-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
807,148216-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
808,148216-v1.0.0,good,"// Use parameterized queries or prepared statements to avoid SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
809,146193-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
810,146193-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
811,148146-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
812,148146-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped to prevent SQL injection
data = data.replace(""'"", ""''"");
sqlStatement.setString(1, data);
",good
813,148146-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
814,148146-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
815,148146-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
816,148146-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
817,147948-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_72b()).badSink(dataVector);
",bad
818,147838-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_73b()).badSink(dataLinkedList);
",bad
819,146322-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_74b()).badSink(dataHashMap);
",bad
820,148322-v1.0.0,java,"baseObject.action(data);
",bad
821,147339-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
822,147339-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
823,148238-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_54b()).badSink(data );
",bad
824,147335-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
825,147335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
826,146845-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
827,146845-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
828,146845-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
829,146845-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
830,146845-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
831,146845-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput is a function that properly escapes the input to prevent SQL injection.
",good
832,147992-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
833,147992-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
834,147992-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
835,147992-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
836,146634-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
837,146634-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
838,146634-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
839,146634-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
840,146634-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
841,146634-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
842,147787-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
843,147787-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
844,147103-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
845,147103-v1.0.0,good,"// Use a whitelist or a more secure method to validate the input before using it in the SQL query
String validatedData = validateInput(data);
sqlStatement.setString(1, validatedData);
",good
846,147103-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
847,147103-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
848,147103-v1.0.0,java,"data = cookieSources[0].getValue();
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
849,147103-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
850,147419-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
851,147419-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
852,146967-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
853,146967-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
854,146967-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
855,146967-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
856,146967-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
857,146967-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, java.sql.DriverManager.getConnection(url, username, password).quote(data));
",good
858,146588-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
859,146588-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
860,146588-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
861,146588-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
862,146588-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
863,146588-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
864,146577-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
865,146577-v1.0.0,good,"String id = getIdFromUserInput(); // Assume this method safely retrieves user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
866,147651-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_71b()).badSink((Object)data , request, response );
",bad
867,147651-v1.0.0,good,"String query = ""SELECT * FROM table WHERE id = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
868,148048-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
869,148048-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
870,147602-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
871,147602-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
872,146424-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_53b()).badSink(data);
",bad
873,148330-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
874,148330-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
875,148330-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
876,148330-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
877,148330-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
878,148330-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
879,148013-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_51b()).badSink(data);
",bad
880,148013-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM users WHERE home = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
881,146574-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
882,146574-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
883,146173-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_73b()).badSink(dataLinkedList);
",bad
884,146173-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
885,147922-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
886,147922-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
887,147922-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
888,147922-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
889,147922-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
890,147922-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
891,148186-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
892,148186-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
893,147126-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
894,147126-v1.0.0,good,"// Use a loop to find the specific cookie you need instead of assuming it's the first one
for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""your_cookie_name"")) {
        data = cookie.getValue();
        break;
    }
}
",good
895,147105-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
896,147105-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Add validation and sanitization for the data variable here
",good
897,147105-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
898,147105-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
899,147105-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
900,147105-v1.0.0,good,"String sanitizedData = data.replaceAll(""[^a-zA-Z0-9]"", """");
sqlStatement.setString(1, sanitizedData);
",good
901,146537-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
902,146537-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
903,147578-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeBatch_72b()).badSink(dataVector , request, response );
",bad
904,147180-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
905,147180-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
906,147180-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
907,147180-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
908,147180-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
909,147180-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
910,146830-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_52b()).badSink(data );
",bad
911,146830-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
912,148051-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_52b()).badSink(data);
",bad
913,148051-v1.0.0,good,"String data = System.getProperty(""user.home"");
PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
914,147188-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
915,147188-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
916,147188-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
917,147188-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
918,147188-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
919,148116-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
920,148116-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
921,147680-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_execute_51b()).badSink(data , request, response );
",bad
922,147850-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
923,147850-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
924,147850-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
925,147850-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
926,147850-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
927,147850-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
928,147803-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_75b()).badSink(dataSerialized);
",bad
929,147268-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_22b()).goodB2G2Sink(data , request, response);
",bad
930,147268-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
// Use the result set...
",good
931,147268-v1.0.0,java,"data = request.getParameter(""name"");
",bad
932,147268-v1.0.0,good,"// Use PreparedStatement to avoid SQL injection
String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
",good
933,147268-v1.0.0,java,"data = request.getParameter(""name"");
",bad
934,147268-v1.0.0,good,"String name = request.getParameter(""name"");
String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, name);
ResultSet resultSet = statement.executeQuery();
",good
935,148078-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
936,148078-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
937,148078-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
938,148078-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
939,148078-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
940,148078-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
941,146295-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
942,146295-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
943,146295-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
944,146295-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
945,146295-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
946,146295-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
947,140915-v1.0.0,java,"(new CWE566_Authorization_Bypass_Through_SQL_Primary__Servlet_75b()).badSink(dataSerialized , request, response );
",bad
948,146385-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_51b()).badSink(data);
",bad
949,146385-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
950,146472-v1.0.0,java,"baseObject.action(data);
",bad
951,147245-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
952,147245-v1.0.0,good,"// Iterate through all the cookies
for (Cookie cookie : cookieSources) {
    // Validate the cookie name and value
    if (isValidCookie(cookie.getName(), cookie.getValue())) {
        // Add the cookie value to the data vector
        dataVector.add(cookie.getValue());
    }
}

// Use a parameterized query or prepared statement to execute the SQL query
PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE data = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
953,147390-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__PropertiesFile_executeQuery_67b()).badSink(dataContainer);
",bad
954,147390-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
955,147621-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
956,147621-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
String data = request.getParameter(""id"");
if (data != null) {
    data = data.replaceAll(""[';\\-]"", """"); // Remove any single quotes, semicolons, or dashes
}
sqlStatement.setString(1, data);
",good
957,147621-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
958,147621-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
959,147621-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
960,147621-v1.0.0,good,"// Use a whitelist or blacklist to validate the input
String validData = validateInput(data);
sqlStatement.setString(1, validData);
",good
961,148252-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
962,148252-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
963,148252-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    try {
        if (preparedStatement != null) {
            preparedStatement.close();
        }
    } catch (SQLException exceptSql) {
        IO.logger.log(Level.WARNING, ""Error closing PreparedStatement"", exceptSql);
    }
}
",good
964,148252-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
965,148252-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
966,146360-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_75b()).badSink(dataSerialized);
",bad
967,147067-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
968,147067-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int[] resultsArray = sqlStatement.executeBatch();
",good
969,147067-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
970,147067-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
971,147067-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
972,147067-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, StringEscapeUtils.escapeSql(names[i]));
",good
973,147144-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
974,147144-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
975,147144-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
976,147144-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
977,147144-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
978,147144-v1.0.0,good,"String escapedData = StringEscapeUtils.escapeSql(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, escapedData);
",good
979,148341-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_22b()).badSink(data );
",bad
980,146361-v1.0.0,java,"baseObject.action(data);
",bad
981,146361-v1.0.0,good,"// Use prepared statements or parameterized queries to prevent SQL injection
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
982,147807-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
983,147807-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
984,147807-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
985,147807-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
986,147807-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
987,147807-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
988,146407-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
989,146407-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
990,146407-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
991,146407-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
992,146407-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
993,146407-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change the above line to the following to prevent SQL injection
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that sanitizes the user input to prevent SQL injection
",good
994,146655-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
995,146655-v1.0.0,good,"String id = ""0""; // This value should be dynamically assigned and properly sanitized
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
996,146870-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
997,146870-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
998,148180-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
999,148180-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1000,148180-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1001,148180-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1002,147805-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1003,147805-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1004,148141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1005,148141-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1006,148141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1007,148141-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1008,148141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1009,148141-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, escapeSql(data));
",good
1010,147356-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_72b()).badSink(dataVector);
",bad
1011,147356-v1.0.0,good,"Connection conn = ... // obtain a database connection
PreparedStatement stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
stmt.setString(1, data);
stmt.executeUpdate();
",good
1012,147090-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1013,147090-v1.0.0,good,"// Validate and sanitize the cookie value before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
(new CWE89_SQL_Injection__getCookies_Servlet_executeBatch_53b()).badSink(sanitizedData , request, response);
",good
1014,146901-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1015,146901-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1016,147713-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1017,147713-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1018,147312-v1.0.0,java,"data = request.getParameter(""name"");
",bad
1019,147312-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement ps = connection.prepareStatement(""SELECT * FROM users WHERE name = ?"");
ps.setString(1, data);
ResultSet rs = ps.executeQuery();
",good
1020,147290-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1021,147290-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1022,147290-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1023,147290-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1024,147290-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1025,146913-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_73b()).badSink(dataLinkedList);
",bad
1026,148095-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_71b()).badSink((Object)data);
",bad
1027,148095-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1028,147375-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1029,147375-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1030,147375-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1031,147375-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",bad
1032,146529-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1033,146529-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1034,147698-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1035,147698-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1036,147698-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1037,147698-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1038,147698-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1039,147698-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1040,146709-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1041,146709-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1042,146709-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1043,146709-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1044,146709-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1045,146709-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1046,147251-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
1047,147251-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[-']"", """")); // Remove any '-' or ""'"" characters to prevent SQL injection
",good
1048,147251-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1049,147251-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1050,147251-v1.0.0,java,"data = request.getParameter(""name"");
String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1051,147251-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
1052,147274-v1.0.0,java,"data = request.getParameter(""name"");
",bad
1053,147274-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE name = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1054,146514-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1055,146514-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1056,146514-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1057,146514-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1058,146514-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1059,146514-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before inserting into the query
",good
1060,146465-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_67b()).badSink(dataContainer);
",bad
1061,146331-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1062,146331-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1063,146331-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1064,146331-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1065,146331-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1066,146331-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1067,147663-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1068,147663-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1069,147663-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1070,147663-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1071,147663-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1072,147663-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1073,146583-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1074,146583-v1.0.0,good,"String id = ""0""; // This should be a parameterized input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
1075,146225-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1076,146225-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
1077,146433-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_74b()).badSink(dataHashMap);
",bad
1078,148250-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1079,148250-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1080,148250-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1081,148250-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1082,148250-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1083,148250-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1084,148245-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_73b()).badSink(dataLinkedList);
",bad
1085,146470-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_74b()).badSink(dataHashMap);
",bad
1086,146403-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1087,146403-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure that data is properly sanitized or validated before being used in the SQL query.
// This could be done using a library that provides parameterized queries or by manually escaping special characters.
",good
1088,146403-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1089,146403-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1090,146403-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1091,146403-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1092,147237-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1093,147237-v1.0.0,good,"// Use a loop to iterate through all cookies and validate/sanitize the data
for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""desired_cookie_name"")) {
        data = cookie.getValue();
        // Validate and sanitize data here
        break;
    }
}
",good
1094,146922-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1095,146922-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1096,146922-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1097,146922-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1098,146922-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1099,146467-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_71b()).badSink((Object)data);
",bad
1100,146467-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1101,146871-v1.0.0,java,"data = System.getenv(""ADD"");
dataArray[2] = data;
(new CWE89_SQL_Injection__Environment_prepareStatement_66b()).badSink(dataArray);
",bad
1102,147546-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1103,147546-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1104,147234-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1105,147234-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1106,147289-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1107,147289-v1.0.0,good,"data = request.getParameter(""name"");
// Validate and sanitize the input to prevent SQL injection
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1108,147289-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1109,147289-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1110,147289-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1111,146685-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1112,146685-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1113,146615-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1114,146615-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1115,147283-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_73b()).badSink(dataLinkedList , request, response );
",bad
1116,147012-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1117,147012-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1118,146485-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1119,146485-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1120,146485-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1121,146485-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1122,146485-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1123,146485-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add this line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
1124,147227-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1125,147227-v1.0.0,good,"sqlStatement.setString(1, sanitizeInput(data));
",good
1126,147227-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1127,147227-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1128,147227-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1129,147227-v1.0.0,good,"sqlStatement.setString(1, sanitizeInput(data));
",good
1130,147526-v1.0.0,java,"goodB2G2Sink(data , request, response);
",bad
1131,147526-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response);
",bad
1132,147526-v1.0.0,good,"String data = request.getParameter(""name"");
String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement stmt = connection.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1133,147526-v1.0.0,java,"data = request.getParameter(""name"");
goodB2G1Sink(data , request, response);
",bad
1134,147526-v1.0.0,good,"String name = request.getParameter(""name"");
String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
// use the result set...
",good
1135,147630-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1136,147630-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1137,147630-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1138,147630-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1139,147630-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1140,147630-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
1141,148261-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1142,148261-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1143,148261-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1144,148261-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1145,148261-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1146,148261-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1147,147754-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_51b()).badSink(data);
",bad
1148,146448-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1149,146448-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1150,146448-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1151,146448-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1152,146448-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1153,146448-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1154,146966-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1155,146966-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1156,146966-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1157,146966-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1158,146966-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1159,146966-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1160,146820-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1161,146820-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1162,146820-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1163,146820-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1164,146820-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1165,146820-v1.0.0,good,"// Ensure data is properly escaped to prevent SQL injection
String escapedData = escapeSql(data);
sqlStatement.setString(1, escapedData);
",good
1166,147764-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_73b()).badSink(dataLinkedList);
",bad
1167,147416-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_22b()).goodB2G2Sink(data );
",bad
1168,147416-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_22b()).badSink(data );
",bad
1169,147416-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_22b()).goodB2G1Sink(data);
",bad
1170,148253-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1171,148253-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1172,148253-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1173,148253-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1174,148253-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1175,148253-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1176,147117-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1177,147117-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1178,147044-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1179,147044-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1180,146209-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_72b()).badSink(dataVector);
",bad
1181,148293-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1182,148293-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1183,148293-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1184,148293-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1185,148293-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1186,148293-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1187,146164-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_52b()).badSink(data );
",bad
1188,146164-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1189,146844-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1190,146844-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add validation and sanitization for the data variable here
",good
1191,146844-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1192,146844-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1193,146844-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1194,147359-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_75b()).badSink(dataSerialized);
",bad
1195,140913-v1.0.0,java,"(new CWE566_Authorization_Bypass_Through_SQL_Primary__Servlet_73b()).badSink(dataLinkedList , request, response );
",bad
1196,140913-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE id = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1197,146741-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1198,146741-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before being used in the query
",good
1199,146741-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1200,146741-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
1201,146741-v1.0.0,java,"data = System.getenv(""ADD"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1202,146741-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1203,148062-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_75b()).badSink(dataSerialized);
",bad
1204,146702-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1205,146702-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1206,146702-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1207,146702-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1208,146702-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1209,146702-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1210,146847-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1211,146847-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
1212,146847-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1213,146847-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1214,146847-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1215,146842-v1.0.0,java,"baseObject.action(data );
",bad
1216,146842-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1217,140882-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
1218,140882-v1.0.0,good,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
// Add input validation to ensure id is a valid integer
",good
1219,146879-v1.0.0,java,"data = System.getenv(""ADD"");
baseObject.action(data );
",bad
1220,146879-v1.0.0,good,"String data = System.getenv(""ADD"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1221,140891-v1.0.0,java,"data = request.getParameter(""id"");
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
1222,140891-v1.0.0,good,"try {
    id = Integer.parseInt(data);
} catch (NumberFormatException nfx) {
    id = -1; /* Assuming this id does not exist */
}
",good
1223,148300-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1224,148300-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1225,148300-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1226,148300-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1227,148300-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1228,148300-v1.0.0,good,"// Use a parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1229,146430-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_71b()).badSink((Object)data);
",bad
1230,146430-v1.0.0,good,"PreparedStatement statement = null;
try {
    statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // Process the result set
} catch (SQLException e) {
    // Handle the exception
} finally {
    // Close the statement and the connection
}
",good
1231,147824-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1232,147824-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1233,147995-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1234,147995-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, validateInput(names[i]));
",good
1235,147995-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1236,147995-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1237,147995-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1238,147470-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_75b()).badSink(dataSerialized , request, response );
",bad
1239,147243-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1240,147243-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""desired_cookie_name"")) {
        data = cookie.getValue();
        // Add validation and sanitization here
        break;
    }
}
",good
1241,146280-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_67b()).badSink(dataContainer);
",bad
1242,146280-v1.0.0,good,"PreparedStatement preparedStatement = null;
String sql = ""INSERT INTO table (column) VALUES (?)"";
try {
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
1243,146969-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1244,146969-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1245,147598-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1246,147598-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1247,147520-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1248,147520-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1249,146585-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
1250,146585-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",good
1251,146585-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1252,146585-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1253,146585-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
1254,146585-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1255,146658-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1256,146658-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1257,147894-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1258,147894-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1259,147442-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1260,147442-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (name, status) values (?, 'updated')"");
sqlStatement.setString(1, data);
",good
1261,147442-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1262,147442-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1263,147442-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1264,146598-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
1265,146598-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
1266,146598-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1267,146598-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1268,146598-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
1269,146598-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
",good
1270,146162-v1.0.0,java,"data = System.getenv(""ADD"");
",bad
1271,146162-v1.0.0,good,"String data = System.getenv(""ADD"");
String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
1272,147927-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1273,147927-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
1274,140904-v1.0.0,java,"data = request.getParameter(""id"");
",bad
1275,140904-v1.0.0,good,"String id = request.getParameter(""id"");
PreparedStatement pstmt = connection.prepareStatement(""SELECT * FROM users WHERE id = ?"");
pstmt.setString(1, id);
ResultSet rs = pstmt.executeQuery();
",good
1276,148109-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1277,148109-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1278,148109-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1279,148109-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1280,147250-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1281,147250-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1282,148239-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1283,148239-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1284,146366-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1285,146366-v1.0.0,good,"for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
1286,146366-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1287,146366-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1288,146366-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1289,146366-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
1290,148347-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_52b()).badSink(data );
",bad
1291,146235-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1292,146235-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
    preparedStatement.setString(1, data);
    resultSet = preparedStatement.executeQuery();
    IO.writeLine(resultSet.getRow());
}
// rest of the code...
",good
1293,148241-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_67b()).badSink(dataContainer);
",bad
1294,146174-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_74b()).badSink(dataHashMap);
",bad
1295,146174-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
1296,146955-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1297,146955-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1298,146955-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1299,146955-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1300,146955-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1301,146955-v1.0.0,good,"// Use a whitelist or a pattern to validate the data before using it in the SQL query
Pattern pattern = Pattern.compile(""^[a-zA-Z0-9 ]*$"");
Matcher matcher = pattern.matcher(data);
if (matcher.matches()) {
    sqlStatement.setString(1, data);
} else {
    // Handle invalid data
}
",good
1302,147158-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1303,147158-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1304,148091-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1305,148091-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1306,147276-v1.0.0,java,"data = request.getParameter(""name"");
",bad
1307,147276-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1308,146745-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1309,146745-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
1310,146745-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1311,146745-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1312,146745-v1.0.0,java,"data = System.getenv(""ADD"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1313,146745-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1314,148151-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1315,148151-v1.0.0,good,"Boolean result = sqlStatement.executeUpdate();
",good
1316,148151-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1317,148151-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1318,148151-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1319,148151-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1320,147820-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1321,147820-v1.0.0,good,"String sql = ""insert into users (status) values ('updated') where name=?"";
PreparedStatement preparedStatement = dbConnection.prepareStatement(sql);
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1322,146342-v1.0.0,java,"data = readerBuffered.readLine();
",bad
1323,147330-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1324,147330-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, java.sql.PreparedStatement.escapeString(names[i]));
",good
1325,147330-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1326,147330-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1327,147330-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1328,147330-v1.0.0,good,"sqlStatement.setString(1, escapeSpecialCharacters(names[i]));

// Method to escape special characters
private static String escapeSpecialCharacters(String input) {
    if (input == null) {
        return null;
    }
    return input.replace(""'"", ""''"");
}
",good
1329,147391-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_68b()).badSink();
",bad
1330,148181-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1331,148181-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
1332,148181-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1333,148181-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
1334,148181-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1335,146918-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1336,146918-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1337,146918-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1338,146918-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1339,146918-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1340,146918-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Add this line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
1341,147255-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1342,147255-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1343,147255-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1344,147255-v1.0.0,java,"data = request.getParameter(""name"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1345,147587-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1346,147587-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1347,147587-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1348,147587-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1349,147587-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
1350,147587-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
1351,146153-v1.0.0,java,"String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1352,146153-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1353,146153-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1354,146153-v1.0.0,java,"String data = System.getenv(""ADD"");
String names[] = data.split(""-"");
PreparedStatement sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1355,146153-v1.0.0,good,"String data = System.getenv(""ADD"");
if (data == null || data.isEmpty()) {
    throw new IllegalArgumentException(""Environment variable 'ADD' is not set or empty"");
}
String[] names = data.split(""-"");
if (names.length == 0) {
    throw new IllegalArgumentException(""Environment variable 'ADD' contains no valid names"");
}
PreparedStatement sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (String name : names) {
    if (name == null || name.isEmpty()) {
        throw new IllegalArgumentException(""Environment variable 'ADD' contains an empty name"");
    }
    sqlStatement.setString(1, name);
    sqlStatement.addBatch();
}
",good
1356,147687-v1.0.0,java,"data = token.substring(3);
",bad
1357,147687-v1.0.0,good,"data = request.getParameter(""id"");
",good
1358,148112-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1359,148112-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
1360,147394-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_73b()).badSink(dataLinkedList);
",bad
1361,147642-v1.0.0,java,"data = token.substring(3);
",bad
1362,147642-v1.0.0,good,"data = request.getParameter(""id"");
",good
1363,147826-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1364,147826-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1365,147572-v1.0.0,java,"data = token.substring(3);
",bad
1366,147572-v1.0.0,good,"// Instead of using substring, use getParameter() method to retrieve the 'id' parameter
data = request.getParameter(""id"");
",good
1367,147211-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_execute_75b()).badSink(dataSerialized , request, response );
",bad
1368,146806-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1369,146806-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1370,146602-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1371,146602-v1.0.0,good,"String id = ""0""; // Assume this value is coming from user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
1372,146602-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1373,146602-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1374,146602-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1375,146602-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1376,146892-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1377,146892-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1378,146892-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    String query = ""update users set hitcount=hitcount+1 where name=?"";
    preparedStatement = dbConnection.prepareStatement(query);
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1379,146892-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1380,146892-v1.0.0,good,"for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
1381,146888-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1382,146888-v1.0.0,good,"import org.apache.commons.text.StringEscapeUtils;

// ...

String names[] = data.split(""-"");
for (int i = 0; i < names.length; i++) {
    names[i] = StringEscapeUtils.escapeSql(names[i]);
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
1383,146888-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1384,146888-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1385,146888-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1386,147603-v1.0.0,java,"badSink(data , request, response );
",bad
1387,147603-v1.0.0,good,"// Instead of directly using the data variable, use a prepared statement or parameterized query.
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1388,146155-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1389,146155-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1390,147445-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1391,147445-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1392,147445-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1393,147445-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1394,147445-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1395,146949-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_72b()).badSink(dataVector);
",bad
1396,148315-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_67b()).badSink(dataContainer);
",bad
1397,146669-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1398,146669-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
1399,146358-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_73b()).badSink(dataLinkedList);
",bad
1400,147763-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_72b()).badSink(dataVector);
",bad
1401,147763-v1.0.0,good,"PreparedStatement pstmt = null;
try {
    String sql = ""INSERT INTO table (column) VALUES (?)"";
    pstmt = conn.prepareStatement(sql);
    pstmt.setString(1, data);
    pstmt.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (pstmt != null) {
        pstmt.close();
    }
}
",good
1402,147009-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_22b()).goodB2G2Sink(data );
",bad
1403,147009-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_22b()).badSink(data );
",bad
1404,147009-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_22b()).goodB2G1Sink(data );
",bad
1405,147030-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1406,147030-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1407,147030-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1408,147030-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1409,147030-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1410,147030-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1411,147562-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1412,147562-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1413,147937-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1414,147937-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1415,147104-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1416,147104-v1.0.0,good,"import org.apache.commons.text.StringEscapeUtils;

// ...

String sanitizedData = StringEscapeUtils.escapeSql(data);
sqlStatement.setString(1, sanitizedData);
",good
1417,147104-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1418,147104-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1419,147104-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1420,147104-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
1421,148092-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_66b()).badSink(dataArray);
",bad
1422,148092-v1.0.0,good,"public void good() throws Throwable {
    String data;

    /* get system property user.home */
    data = System.getProperty(""user.home"");

    String sql = ""SELECT * FROM table WHERE column = ?"";
    PreparedStatement stmt = conn.prepareStatement(sql);
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // ...
}
",good
1423,147980-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1424,147980-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1425,147282-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_72b()).badSink(dataVector , request, response );
",bad
1426,146719-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1427,146719-v1.0.0,good,"int id = 0; // This value should be provided by the user input, but for the sake of this example, it's hardcoded.
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
1428,146638-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1429,146638-v1.0.0,good,"String id = ""0""; // This should be replaced with user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
1430,146638-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1431,146638-v1.0.0,good,"String id = ""0""; // This should be replaced with a dynamic value from a trusted source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
1432,146638-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1433,146638-v1.0.0,good,"String userId = ""0""; // This should be replaced with a dynamic value from a trusted source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, userId);
",good
1434,147865-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_51b()).badSink(data);
",bad
1435,147920-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1436,147920-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1437,147920-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1438,147920-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1439,147920-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1440,147920-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1441,147199-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1442,147199-v1.0.0,good,"if (cookieSources != null) {
    data = cookieSources[0].getValue();
    // Validate and sanitize the data
    if (!isValidData(data)) {
        // Handle invalid data
        return;
    }
}
",good
1443,147101-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1444,147101-v1.0.0,good,"// Instead of using the first cookie, loop through all cookies and handle them appropriately
for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""expectedCookieName"")) {
        data = cookie.getValue();
        break;
    }
}
",good
1445,146320-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_72b()).badSink(dataVector);
",bad
1446,146320-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""INSERT INTO table_name (column1, column2, column3) VALUES (?, ?, ?)"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    preparedStatement.setString(2, data);
    preparedStatement.setString(3, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    // Close resources
}
",good
1447,148035-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1448,148035-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
1449,148035-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1450,148035-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1451,148035-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1452,148035-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1453,146441-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1454,146441-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1455,146441-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1456,146441-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1457,146441-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1458,147686-v1.0.0,java,"data = token.substring(3);
",bad
1459,147686-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    Container dataContainer = new Container();
    dataContainer.containerOne = id;
    (new CWE89_SQL_Injection__getQueryString_Servlet_execute_67b()).badSink(dataContainer, request, response);
}
",good
1460,146600-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1461,146600-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1462,148256-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1463,148256-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1464,148256-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1465,148256-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1466,148256-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1467,146881-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1468,146881-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""'"", ""''""));
",good
1469,146881-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1470,146881-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1471,146881-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1472,148076-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1473,148076-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1474,148076-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1475,148076-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1476,148076-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));

// Add a method to sanitize input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, whitelisting allowed characters, etc.
    // For example, using a library like OWASP's ESAPI to escape SQL characters
    return ESAPI.encoder().encodeForSQL(input);
}
",good
1477,146684-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1478,146684-v1.0.0,good,"int id = /* get id from user input */;
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
1479,147001-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1480,147001-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1481,147001-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1482,147001-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1483,147001-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1484,147001-v1.0.0,good,"// Validate and sanitize the data before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
1485,148045-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_22b()).goodB2G2Sink(data );
",bad
1486,148045-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1487,148045-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_22b()).badSink(data );
",bad
1488,148045-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1489,148045-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_22b()).goodB2G1Sink(data);
",bad
1490,147212-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1491,147212-v1.0.0,good,"// Use a loop to iterate through all cookies and find the one you need
for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""your_cookie_name"")) {
        data = cookie.getValue();
        break;
    }
}
// Make sure to sanitize the data before using it in a SQL query
data = sanitizeInput(data);
",good
1492,146987-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_73b()).badSink(dataLinkedList);
",bad
1493,147326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1494,147326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (String name : names) {
    sqlStatement.setString(1, name);
    sqlStatement.addBatch();
}
",good
1495,147326-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1496,147326-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
1497,147326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1498,147326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1499,147786-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_22b()).goodB2G2Sink(data );
",bad
1500,147786-v1.0.0,good,"PreparedStatement preparedStatement = null;
String sql = ""SELECT * FROM table WHERE column = ?"";
try {
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
1501,147786-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_22b()).badSink(data );
",bad
1502,147786-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
1503,147786-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_22b()).goodB2G1Sink(data );
",bad
1504,147786-v1.0.0,good,"PreparedStatement statement = null;
try {
    Connection connection = /* obtain database connection */
    String query = ""SELECT * FROM table WHERE column = ?"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
1505,147560-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken(); /* a token will be like ""id=foo"" */
    if(token.startsWith(""id="")) /* check if we have the ""id"" parameter"" */
    {
        data = token.substring(3); /* set data to ""foo"" */
        break; /* exit while loop */
    }
}
...
String names[] = data.split(""-"");
...
sqlStatement.setString(1, names[i]);
",bad
1506,147560-v1.0.0,good,"String id = request.getParameter(""id"");
...
String names[] = id.split(""-"");
...
sqlStatement.setString(1, names[i]);
",good
1507,147560-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1508,147560-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1509,147560-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1510,147560-v1.0.0,good,"// Validate and sanitize the input to prevent SQL injection
String[] validNames = new String[names.length];
int validCount = 0;
for (int i = 0; i < names.length; i++) {
    if (isValidName(names[i])) {
        validNames[validCount++] = names[i];
    }
}

// Use the validated input in the prepared statement
for (int i = 0; i < validCount; i++)
{
    sqlStatement.setString(1, validNames[i]);
    sqlStatement.addBatch();
}

// Add a method to validate the name input
private boolean isValidName(String name) {
    // Add your validation logic here
    // For example, you can use a regular expression to check for any invalid characters
    return name.matches(""[a-zA-Z0-9_-]+"");
}
",good
1511,146869-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_54b()).badSink(data );
",bad
1512,146869-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1513,147840-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_75b()).badSink(dataSerialized);
",bad
1514,148117-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1515,148117-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1516,147174-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_75b()).badSink(dataSerialized , request, response );
",bad
1517,147523-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1518,147523-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1519,147523-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1520,147523-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1521,147523-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1522,147523-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1523,148136-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_75b()).badSink(dataSerialized);
",bad
1524,146646-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1525,146646-v1.0.0,good,"int id = 0; // Assume this value is provided by the user
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
1526,146330-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1527,146330-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1528,146330-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1529,146330-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1530,146330-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1531,146330-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1532,146502-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_67b()).badSink(dataContainer);
",bad
1533,146502-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""INSERT INTO table_name (column_name) VALUES (?)"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
1534,148318-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_72b()).badSink(dataVector);
",bad
1535,146916-v1.0.0,java,"baseObject.action(data);
",bad
1536,146916-v1.0.0,good,"// Sanitize the input
String sanitizedData = sanitizeInput(data);

// Use parameterized queries
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, sanitizedData);
ResultSet rs = stmt.executeQuery();
",good
1537,146818-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1538,146818-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1539,146818-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1540,146818-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1541,146818-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1542,146818-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, java.sql.DriverManager.getConnection(url, username, password).quote(data));
",good
1543,147848-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1544,147848-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes any special characters in the input to prevent SQL injection.
",good
1545,147848-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1546,147848-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1547,147848-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1548,147848-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1549,146772-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1550,146772-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1551,146772-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1552,146772-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1553,146772-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1554,147685-v1.0.0,java,"data = token.substring(3);
",bad
1555,147027-v1.0.0,java,"baseObject.action(data);
",bad
1556,147027-v1.0.0,good,"// Validate or sanitize the data before using it in a SQL query
String sanitizedData = sanitizeInput(data);
baseObject.action(sanitizedData);
",good
1557,146980-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_54b()).badSink(data);
",bad
1558,146980-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1559,147940-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_52b()).badSink(data);
",bad
1560,147645-v1.0.0,java,"data = token.substring(3);
",bad
1561,147645-v1.0.0,good,"data = request.getParameter(""id"");
",good
1562,146471-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_75b()).badSink(dataSerialized);
",bad
1563,147744-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1564,147744-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
1565,147744-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1566,147744-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1567,147744-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1568,147744-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1569,147789-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1570,147789-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
    preparedStatement.setString(1, data);
    resultSet = preparedStatement.executeQuery();
    IO.writeLine(resultSet.getRow());
} catch (SQLException exceptSql) {
    // handle exception
} finally {
    // close resources
}
",good
1571,147532-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_51b()).badSink(data , request, response );
",bad
1572,147532-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement pstmt = connection.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
// use the result set
",good
1573,146909-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_67b()).badSink(dataContainer);
",bad
1574,146928-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1575,146928-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
1576,147240-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1577,147240-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1578,146325-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1579,146325-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1580,147959-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1581,147959-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data); // Change this line to
sqlStatement.setString(1, sanitizeInput(data)); // Add a function to sanitize the input
",good
1582,147959-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1583,147959-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1584,147959-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1585,147959-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1586,147924-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1587,147924-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1588,147924-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1589,147924-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1590,147924-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1591,147924-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1592,147370-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1593,147370-v1.0.0,good,"// Use a whitelist or validation to ensure data is safe before using it in the SQL statement
// For example, you could use a regular expression to ensure data only contains alphanumeric characters
if (!data.matches(""[a-zA-Z0-9]+"")) {
    throw new IllegalArgumentException(""Invalid data"");
}
sqlStatement.setString(1, data);
",good
1594,147370-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1595,147370-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1596,147370-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1597,147370-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1598,146878-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_75b()).badSink(dataSerialized);
",bad
1599,146463-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1600,146463-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1601,146383-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1602,146383-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1603,147313-v1.0.0,java,"data = request.getParameter(""name"");
",bad
1604,147313-v1.0.0,good,"String name = request.getParameter(""name"");
String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, name);
ResultSet resultSet = statement.executeQuery();
",good
1605,147559-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1606,147559-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
// Ensure names[i] is properly escaped or validated before using it in the query.
// This can be done using a library that provides SQL escaping functions or by using parameterized queries.
",good
1607,147559-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1608,147559-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1609,147559-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1610,147720-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_54b()).badSink(data , request, response);
",bad
1611,147720-v1.0.0,good,"// Instead of directly using the data variable, use PreparedStatement to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1612,147392-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_71b()).badSink((Object)data);
",bad
1613,147329-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1614,147329-v1.0.0,good,"Pattern namePattern = Pattern.compile(""^[a-zA-Z0-9_]+$"");
for (int i = 0; i < names.length; i++) {
    if (namePattern.matcher(names[i]).matches()) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    } else {
        IO.logger.log(Level.WARNING, ""Invalid name: "" + names[i]);
    }
}
",good
1615,147329-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1616,147329-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1617,147329-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1618,148356-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_73b()).badSink(dataLinkedList);
",bad
1619,147669-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1620,147669-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
1621,147669-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1622,147669-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1623,147669-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1624,147669-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1625,148167-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_67b()).badSink(dataContainer);
",bad
1626,146435-v1.0.0,java,"baseObject.action(data );
",bad
1627,146435-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet result = statement.executeQuery();
",good
1628,146176-v1.0.0,java,"data = System.getenv(""ADD"");
baseObject.action(data);
",bad
1629,146176-v1.0.0,good,"String data = System.getenv(""ADD"");
try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
     PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"")) {
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process results
} catch (SQLException e) {
    e.printStackTrace();
}
",good
1630,146449-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1631,146449-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput is a function that sanitizes the user input to prevent SQL injection.
",good
1632,146449-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1633,146449-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1634,146449-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1635,146449-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that sanitizes the input to prevent SQL injection.
",good
1636,147597-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1637,147597-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1638,147597-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1639,147597-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
1640,147597-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1641,147597-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1642,148065-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1643,148065-v1.0.0,good,"data = data.replaceAll(""[^a-zA-Z0-9]"", """");
",good
1644,148065-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1645,148065-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1646,148065-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1647,147551-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1648,147551-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1649,147551-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1650,147551-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1651,147551-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
1652,147349-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_53b()).badSink(data);
",bad
1653,146389-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1654,146389-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1655,148052-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_53b()).badSink(data);
",bad
1656,146264-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1657,146264-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1658,146264-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1659,146264-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1660,146264-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1661,146264-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1662,148050-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_51b()).badSink(data);
",bad
1663,148050-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1664,148317-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_71b()).badSink((Object)data);
",bad
1665,148317-v1.0.0,good,"PreparedStatement preparedStatement = null;
String sql = ""SELECT * FROM table WHERE column = ?"";
try {
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
1666,146803-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_74b()).badSink(dataHashMap);
",bad
1667,146515-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1668,146515-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1669,146515-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1670,146515-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1671,146515-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1672,146515-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1673,148337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1674,148337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1675,148337-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1676,148337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1677,148337-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1678,146483-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1679,146483-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1680,146483-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1681,146483-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1682,146483-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1683,146483-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped to prevent SQL injection
data = java.sql.DriverManager.getConnection(url, user, password).createStatement().escape(data, ""''"");
sqlStatement.setString(1, data);
",good
1684,147782-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1685,147782-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1686,147782-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1687,147782-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1688,147782-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1689,147782-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before being used in the query
",good
1690,146452-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1691,146452-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1692,147380-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1693,147380-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1694,147819-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1695,147819-v1.0.0,good,"// Validate and sanitize the data before using it in the prepared statement
// This can be done using a library like OWASP's Java HTML Sanitizer or by manually checking for SQL injection patterns
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
1696,147819-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1697,147819-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1698,147819-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1699,147819-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1700,147707-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1701,147707-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1702,147707-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1703,147707-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1704,147707-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1705,147707-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1706,147813-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1707,147813-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1708,147813-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1709,147813-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1710,147813-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1711,147813-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1712,146568-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1713,146568-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1714,147016-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_53b()).badSink(data );
",bad
1715,147016-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
1716,146656-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1717,146656-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1718,148344-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1719,148344-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1720,147944-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__PropertiesFile_execute_66b()).badSink(dataArray);
",bad
1721,148334-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1722,148334-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1723,146788-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1724,146788-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1725,148126-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_53b()).badSink(data );
",bad
1726,148126-v1.0.0,good,"public void good() throws Throwable {
    String data;
    data = System.getProperty(""user.home"");

    Connection conn = /* obtain a connection to the database */
    PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process the result set
}
",good
1727,146381-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1728,146381-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1729,147125-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1730,147125-v1.0.0,good,"// Verify and sanitize the cookie value before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
(new CWE89_SQL_Injection__getCookies_Servlet_executeQuery_51b()).badSink(sanitizedData , request, response );
",good
1731,147324-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1732,147324-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    String sql = ""update users set hitcount=hitcount+1 where name=?"";
    preparedStatement = dbConnection.prepareStatement(sql);
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1733,147982-v1.0.0,java,"data = properties.getProperty(""data"");
(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_67b()).badSink(dataContainer);
",bad
1734,147982-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    Connection connection = /* obtain database connection */;
    String query = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
1735,147110-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1736,147110-v1.0.0,good,"// Instead of directly inserting the user input into the SQL query, use a parameterized query
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1737,147110-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1738,147110-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1739,147110-v1.0.0,java,"data = cookieSources[0].getValue();
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1740,147110-v1.0.0,good,"data = cookieSources[0].getValue();
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1741,146270-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1742,146270-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1743,146384-v1.0.0,java,"data = readerBuffered.readLine();
",bad
1744,146384-v1.0.0,good,"String query = ""SELECT * FROM users WHERE username = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet result = statement.executeQuery();
",good
1745,146644-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1746,146644-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1747,147116-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1748,147116-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1749,147116-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1750,147116-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1751,147116-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1752,147116-v1.0.0,good,"// Ensure data is properly sanitized before using it in the query
String sanitizedData = sanitizeInput(data);

sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizedData);
",good
1753,146495-v1.0.0,java,"data = readerBuffered.readLine();
",bad
1754,146495-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1755,147429-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_71b()).badSink((Object)data);
",bad
1756,147022-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_71b()).badSink((Object)data);
",bad
1757,147022-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
1758,146889-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1759,146889-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1760,146889-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1761,146889-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1762,146889-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1763,148153-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1764,148153-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1765,147895-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1766,147895-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1767,147494-v1.0.0,java,"data = request.getParameter(""name"");
badSink(request, response);
",bad
1768,147494-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE name = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
1769,147475-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1770,147475-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1771,147475-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1772,147475-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1773,147475-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1774,147475-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1775,146285-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_74b()).badSink(dataHashMap);
",bad
1776,146285-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""INSERT INTO table (column) VALUES (?)"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
1777,146941-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_52b()).badSink(data );
",bad
1778,147254-v1.0.0,java,"String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1779,147254-v1.0.0,good,"// Use a whitelist to validate the input and only allow safe characters
String safeData = data.replaceAll(""[^-a-zA-Z0-9]"", """");
String names[] = safeData.split(""-"");
",good
1780,147254-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1781,147254-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1782,147254-v1.0.0,java,"data = request.getParameter(""name"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1783,148191-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1784,148191-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1785,146421-v1.0.0,java,"data = readerBuffered.readLine();
",bad
1786,146421-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM Users WHERE name = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1787,146887-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1788,146887-v1.0.0,good,"sqlStatement.setString(1, escapeSpecialCharacters(names[i]));

// Method to escape special characters
private String escapeSpecialCharacters(String input) {
    if (input == null) {
        return null;
    }
    return input.replaceAll(""([';])"", ""\\\\$1"");
}
",good
1789,146887-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1790,146887-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
1791,146887-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1792,146314-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_54b()).badSink(data );
",bad
1793,146314-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
stmt.setString(1, data);
stmt.executeUpdate();
",good
1794,147804-v1.0.0,java,"baseObject.action(data);
",bad
1795,147804-v1.0.0,good,"PreparedStatement statement = null;
try {
    statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
1796,147279-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_67b()).badSink(dataContainer , request, response );
",bad
1797,147279-v1.0.0,good,"String data = request.getParameter(""name"");
Container dataContainer = new Container();
dataContainer.containerOne = data;

// Use a prepared statement to prevent SQL injection
String sql = ""SELECT * FROM table WHERE name = ?"";
PreparedStatement statement = connection.prepareStatement(sql);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();

// Use the result set as needed
",good
1798,146158-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_22b()).goodB2G2Sink(data);
",bad
1799,146158-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_22b()).badSink(data);
",bad
1800,146158-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
1801,146158-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_22b()).goodB2G1Sink(data);
",bad
1802,147385-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_52b()).badSink(data);
",bad
1803,146687-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1804,146687-v1.0.0,good,"String id = ""0""; // This should be replaced with a user-provided value
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
1805,146443-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1806,146443-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1807,146443-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1808,146443-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1809,146443-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1810,147705-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1811,147705-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1812,147448-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1813,147448-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1814,147448-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1815,147448-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1816,147483-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1817,147483-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
1818,146993-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1819,146993-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1820,146993-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1821,146993-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1822,146993-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1823,146993-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to use parameter binding instead of string concatenation
// sqlStatement.setString(1, PreparedStatement.escapeString(data));
",good
1824,147286-v1.0.0,java,"data = request.getParameter(""name"");
baseObject.action(data , request, response);
",bad
1825,147286-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
1826,147507-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_execute_75b()).badSink(dataSerialized , request, response );
",bad
1827,148202-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1828,148202-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1829,146221-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1830,146221-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1831,146221-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1832,146221-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1833,146221-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1834,147365-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1835,147365-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1836,147365-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1837,147365-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
1838,147365-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1839,147347-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_51b()).badSink(data);
",bad
1840,147340-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1841,147340-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1842,148014-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_52b()).badSink(data);
",bad
1843,148014-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE username = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
1844,148260-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1845,148260-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
1846,147086-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1847,147086-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
1848,148042-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1849,148042-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1850,147993-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1851,147993-v1.0.0,good,"Pattern namePattern = Pattern.compile(""^[a-zA-Z0-9_]+$"");
for (int i = 0; i < names.length; i++) {
    if (namePattern.matcher(names[i]).matches()) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    } else {
        // log or handle invalid input
    }
}
",good
1852,147993-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1853,147993-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1854,147993-v1.0.0,java,"String data = System.getProperty(""user.home"");
String names[] = data.split(""-"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
1855,147164-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1856,147164-v1.0.0,good,"String data = """";
Cookie[] cookies = request.getCookies();
if (cookies != null) {
    for (Cookie cookie : cookies) {
        if (cookie.getName().equals(""data"")) {
            data = cookie.getValue();
            break;
        }
    }
}
PreparedStatement ps = conn.prepareStatement(""SELECT * FROM table WHERE data = ?"");
ps.setString(1, data);
ResultSet rs = ps.executeQuery();
",good
1857,147320-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_73b()).badSink(dataLinkedList , request, response );
",bad
1858,147320-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
1859,146766-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_74b()).badSink(dataHashMap);
",bad
1860,146395-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_73b()).badSink(dataLinkedList);
",bad
1861,146335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1862,146335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1863,146335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1864,146335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1865,146335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1866,146335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1867,147854-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1868,147854-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1869,147854-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1870,147854-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
1871,147854-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1872,147854-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1873,146198-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1874,146198-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    pstmt.setString(1, names[i]);
    pstmt.addBatch();
}
int resultsArray[] = pstmt.executeBatch();
",good
1875,147528-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1876,147528-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1877,146401-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1878,146401-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
1879,146401-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1880,146401-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1881,146401-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1882,146401-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data); // No change needed as this is already using parameterized query
",good
1883,146302-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1884,146302-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1885,146302-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1886,146302-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1887,146302-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1888,146302-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1889,146431-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_72b()).badSink(dataVector);
",bad
1890,146431-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""INSERT INTO table (column) VALUES (?)"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
1891,146434-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_75b()).badSink(dataSerialized);
",bad
1892,147098-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_executeBatch_73b()).badSink(dataLinkedList , request, response );
",bad
1893,147367-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1894,147367-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1895,147367-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1896,147367-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1897,147367-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, java.sql.DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""user"", ""password"").quote(data));
",good
1898,147653-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_73b()).badSink(dataLinkedList , request, response );
",bad
1899,147845-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1900,147845-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1901,147845-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1902,147845-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1903,147845-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1904,147845-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1905,147946-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_68b()).badSink();
",bad
1906,146832-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_54b()).badSink(data);
",bad
1907,146832-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
1908,147931-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1909,147931-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1910,147407-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1911,147407-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1912,147407-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1913,147407-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
1914,147407-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1915,147407-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1916,148295-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1917,148295-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1918,148295-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1919,148295-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
1920,148295-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1921,148295-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
1922,146804-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_75b()).badSink(dataSerialized);
",bad
1923,148054-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1924,148054-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1925,147648-v1.0.0,java,"data = token.substring(3);
",bad
1926,147648-v1.0.0,good,"data = request.getParameter(""id"");
",good
1927,146843-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1928,146843-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1929,146575-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1930,146575-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1931,147172-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_73b()).badSink(dataLinkedList , request, response );
",bad
1932,147246-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_73b()).badSink(dataLinkedList , request, response );
",bad
1933,146468-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_72b()).badSink(dataVector);
",bad
1934,147491-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1935,147491-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    String sql = ""UPDATE users SET status = 'updated' WHERE name = ?"";
    preparedStatement = dbConnection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    int rowsAffected = preparedStatement.executeUpdate();
    if (rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources...
}
",good
1936,148075-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1937,148075-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
1938,147863-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1939,147863-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);

    int rowsAffected = preparedStatement.executeUpdate();

    if(rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources...
}
",good
1940,146705-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1941,146705-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1942,146705-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1943,146705-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1944,146705-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1945,146705-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1946,147477-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1947,147477-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1948,147477-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1949,147477-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1950,147477-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1951,147239-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
1952,147239-v1.0.0,good,"// Validate and sanitize the cookie value before using it in the SQL query
String data = """";
Cookie[] cookieSources = request.getCookies();
if (cookieSources != null) {
    data = cookieSources[0].getValue();
    // Add validation and sanitization logic here
    // For example, using a prepared statement with parameterized queries can help prevent SQL injection
}
",good
1953,148276-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1954,148276-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
1955,146245-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_71b()).badSink((Object)data);
",bad
1956,146647-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1957,146647-v1.0.0,good,"String query = ""select name from users where id=?"";
preparedStatement = connection.prepareStatement(query);
preparedStatement.setInt(1, id);
",good
1958,147671-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1959,147671-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1960,147671-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1961,147671-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
1962,147671-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1963,147671-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
// For example, you could use a regular expression to ensure that the data only contains alphanumeric characters
data = data.replaceAll(""[^a-zA-Z0-9]"", """");
sqlStatement.setString(1, data);
",good
1964,148032-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1965,148032-v1.0.0,good,"// Use a parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
1966,148032-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1967,148032-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
1968,148032-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
1969,148032-v1.0.0,good,"// Use parameterized queries or stored procedures to prevent sql injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
1970,146144-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1971,146144-v1.0.0,good,"String data = System.getenv(""ADD"");
if (data != null) {
    String names[] = data.split(""-"");
    for (int i = 0; i < names.length; i++) {
        // Validate and sanitize the input
        if (!names[i].matches(""[a-zA-Z0-9_]+"")) {
            throw new IllegalArgumentException(""Invalid name: "" + names[i]);
        }
        if (names[i].length() > 50) {
            throw new IllegalArgumentException(""Name too long: "" + names[i]);
        }
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    }
}
",good
1972,146144-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1973,146144-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
1974,146144-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
1975,147892-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1976,147892-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
1977,147892-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1978,147892-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
1979,147892-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1980,147892-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1981,148106-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1982,148106-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1983,148106-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
1984,148106-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
1985,148106-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
1986,148106-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
1987,147269-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
1988,147269-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
1989,146609-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1990,146609-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1991,147637-v1.0.0,java,"data = token.substring(3);
",bad
1992,147637-v1.0.0,good,"data = request.getParameter(""id"");
",good
1993,147637-v1.0.0,java,"data = token.substring(3);
",bad
1994,147637-v1.0.0,good,"data = request.getParameter(""id"");
",good
1995,146718-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
1996,146718-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
1997,146743-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
1998,146743-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
1999,147387-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_54b()).badSink(data );
",bad
2000,146761-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_67b()).badSink(dataContainer);
",bad
2001,146761-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2002,147814-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2003,147814-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2004,147814-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2005,147814-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2006,147814-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2007,147814-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2008,147206-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2009,147206-v1.0.0,good,"if (cookieSources != null && cookieSources.length > 0) {
    String cookieValue = cookieSources[0].getValue();
    // Validate and sanitize the cookie value before using it in a SQL query
    data = sanitizeInput(cookieValue);
}
",good
2010,147302-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2011,147302-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2012,147266-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2013,147266-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2014,146753-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2015,146753-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2016,146304-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2017,146304-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2018,147408-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2019,147408-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2020,147408-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2021,147408-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2022,147408-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2023,147408-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2024,148243-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_71b()).badSink((Object)data);
",bad
2025,148243-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2026,147682-v1.0.0,java,"data = token.substring(3);
",bad
2027,147682-v1.0.0,good,"data = request.getParameter(""id"");
",good
2028,146216-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2029,146216-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2030,146216-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2031,146216-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2032,146216-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2033,146216-v1.0.0,good,"// Use a PreparedStatement with placeholders to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2034,147360-v1.0.0,java,"data = properties.getProperty(""data"");
baseObject.action(data);
",bad
2035,147625-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2036,147625-v1.0.0,good,"String id = request.getParameter(""id"");
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, id);
",good
2037,147625-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2038,147625-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2039,147625-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2040,147625-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
2041,146614-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
2042,146614-v1.0.0,good,"String query = ""select name from users where id=?"";
preparedStatement = connection.prepareStatement(query);
preparedStatement.setInt(1, id);
resultSet = preparedStatement.executeQuery();
",good
2043,147742-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2044,147742-v1.0.0,good,"sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
2045,146456-v1.0.0,java,"data = readerBuffered.readLine();
",bad
2046,146456-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2047,147746-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2048,147746-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2049,147760-v1.0.0,java,"data = readerBuffered.readLine();
(new CWE89_SQL_Injection__listen_tcp_executeBatch_67b()).badSink(dataContainer);
",bad
2050,147760-v1.0.0,good,"public void goodSink(Container dataContainer) throws SQLException {
    String query = ""INSERT INTO table_name (column_name) VALUES (?)"";
    try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
         PreparedStatement pstmt = conn.prepareStatement(query)) {
        pstmt.setString(1, dataContainer.containerOne);
        pstmt.executeUpdate();
    }
}
",good
2051,147321-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_74b()).badSink(dataHashMap , request, response );
",bad
2052,147321-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2053,146168-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_66b()).badSink(dataArray);
",bad
2054,146168-v1.0.0,good,"String query = ""UPDATE table_name SET column_name = ? WHERE id = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
statement.setInt(2, id);
statement.executeUpdate();
",good
2055,147351-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2056,147351-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2057,148115-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2058,148115-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2059,148115-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2060,148115-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2061,148115-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2062,148115-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2063,148212-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2064,148212-v1.0.0,good,"PreparedStatement preparedStatement = null;
ResultSet resultSet = null;

try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
    preparedStatement.setString(1, data);
    resultSet = preparedStatement.executeQuery();

    IO.writeLine(resultSet.getRow()); /* Use ResultSet in some way */
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources...
}
",good
2065,146877-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_74b()).badSink(dataHashMap);
",bad
2066,146877-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
2067,147187-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2068,147187-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
2069,146275-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_52b()).badSink(data);
",bad
2070,146599-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2071,146599-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2072,140893-v1.0.0,java,"data = request.getParameter(""id"");
...
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
2073,140893-v1.0.0,good,"data = request.getParameter(""id"");
// Validate and sanitize the input to prevent SQL injection
data = sanitizeInput(data);
...
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setString(1, data);
",good
2074,148277-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_66b()).badSink(dataArray);
",bad
2075,148277-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
preparedStatement.setString(1, data);
preparedStatement.executeUpdate();
",good
2076,148069-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2077,148069-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, PreparedStatement.escapeString(data));
",good
2078,148069-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2079,148069-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2080,148069-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2081,147061-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_73b()).badSink(dataLinkedList);
",bad
2082,146557-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2083,146557-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2084,146557-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2085,146557-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
2086,146557-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2087,146557-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2088,147463-v1.0.0,java,"dataArray[2] = data;
(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_66b()).badSink(dataArray , request, response );
",bad
2089,147463-v1.0.0,good,"// Use PreparedStatement to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""UPDATE table_name SET column_name = ? WHERE id = ?"");
pstmt.setString(1, data);
pstmt.setInt(2, id);
pstmt.executeUpdate();
",good
2090,148302-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2091,148302-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2092,147566-v1.0.0,java,"data = token.substring(3);
",bad
2093,147566-v1.0.0,good,"data = request.getParameter(""id"");
",good
2094,147692-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_execute_75b()).badSink(dataSerialized , request, response );
",bad
2095,147692-v1.0.0,good,"String data = request.getParameter(""id""); // retrieve the data using getParameter()
if (data != null) {
    // use prepared statements or parameterized queries to prevent SQL injection
    PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process the result set
}
",good
2096,148165-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2097,148165-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2098,146211-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_74b()).badSink(dataHashMap);
",bad
2099,146619-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2100,146619-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2101,146601-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2102,146601-v1.0.0,good,"String userId = ""0""; // This should be replaced with a dynamic value from a safe source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, userId);
",good
2103,146601-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2104,146601-v1.0.0,good,"String id = ""0""; // This value should be dynamically inputted and properly sanitized or validated
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2105,146601-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2106,146601-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2107,147699-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2108,147699-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status='updated' where name=?"");
sqlStatement.setString(1, data);
",good
2109,147699-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2110,147699-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2111,147699-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2112,147699-v1.0.0,good,"// Use a whitelist or a more secure method to validate the 'data' variable
String validatedData = validateData(data);
sqlStatement.setString(1, validatedData);
",good
2113,147446-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2114,147446-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
2115,140907-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
2116,146487-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2117,146487-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2118,146487-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2119,146487-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2120,146487-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2121,147131-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2122,147131-v1.0.0,good,"import java.sql.PreparedStatement;
import java.sql.SQLException;

// ...

String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2123,148026-v1.0.0,java,"baseObject.action(data);
",bad
2124,148026-v1.0.0,good,"public void action(String data) throws SQLException {
    String sql = ""SELECT * FROM users WHERE home = ?"";
    try (Connection conn = DriverManager.getConnection(dbUrl);
         PreparedStatement pstmt = conn.prepareStatement(sql)) {
        pstmt.setString(1, data);
        ResultSet rs = pstmt.executeQuery();
        // process results
    }
}
",good
2125,147071-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2126,147071-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
2127,147071-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2128,147071-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    String sql = ""update users set hitcount=hitcount+1 where name=?"";
    preparedStatement = dbConnection.prepareStatement(sql);
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2129,147071-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2130,147071-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
    sqlStatement.addBatch();
}
",good
2131,146875-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_72b()).badSink(dataVector);
",bad
2132,146875-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
2133,147024-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_73b()).badSink(dataLinkedList);
",bad
2134,147024-v1.0.0,good,"// Assuming we have a Connection object conn and a Statement object stmt
String query = ""INSERT INTO table (column) VALUES (?)"";
PreparedStatement pstmt = conn.prepareStatement(query);
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
2135,147141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2136,147141-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2137,147141-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2138,147141-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2139,147141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2140,147203-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2141,147203-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowsAffected = preparedStatement.executeUpdate();
    if(rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error executing statement"", exceptSql);
} finally {
    // Close resources...
}
",good
2142,146999-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2143,146999-v1.0.0,good,"// Sanitize the data variable
data = sanitizeInput(data);

sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2144,146999-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2145,146999-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2146,146999-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2147,146999-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
2148,147636-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2149,147636-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2150,148214-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2151,148214-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2152,148214-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2153,148214-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2154,148214-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2155,148214-v1.0.0,good,"String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement statement = dbConnection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2156,147388-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2157,147388-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2158,147007-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2159,147007-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
2160,146546-v1.0.0,java,"baseObject.action(data);
",bad
2161,146546-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2162,147755-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_52b()).badSink(data);
",bad
2163,147755-v1.0.0,good,"PreparedStatement statement = null;
try {
    statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // ...
} catch (SQLException e) {
    // ...
} finally {
    // Close statement and connection objects
}
",good
2164,147368-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2165,147368-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2166,147368-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2167,147368-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2168,147368-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2169,147368-v1.0.0,good,"// Use a PreparedStatement with placeholders to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2170,147095-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2171,147095-v1.0.0,good,"// Read data from cookies
Cookie cookieSources[] = request.getCookies();
if (cookieSources != null) {
    // Validate and sanitize the input data
    String data = sanitizeInput(cookieSources[0].getValue());

    // Use a prepared statement with parameterized queries
    PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // ...
}
",good
2172,146597-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
2173,146597-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
2174,146597-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2175,146597-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2176,146597-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
2177,146597-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
2178,147525-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2179,147525-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2180,147956-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2181,147956-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2182,147956-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2183,147956-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2184,147956-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2185,147956-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2186,146555-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2187,146555-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2188,146555-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2189,146555-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
2190,146555-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2191,146555-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2192,147678-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2193,147678-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
2194,147778-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2195,147778-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2196,147778-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2197,147778-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2198,147778-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2199,147778-v1.0.0,good,"// Using a library that provides parameterized queries
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));

// Manually sanitizing the input
String sanitizedData = data.replaceAll(""[\\\\'\\\"";]"", """");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizedData);
",good
2200,146396-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_74b()).badSink(dataHashMap);
",bad
2201,146396-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
2202,146958-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2203,146958-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2204,146958-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2205,146958-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2206,146958-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2207,147284-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_74b()).badSink(dataHashMap , request, response );
",bad
2208,147284-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
statement.setString(1, data);
statement.executeUpdate();
",good
2209,140909-v1.0.0,java,"data = request.getParameter(""id"");
dataContainer.containerOne = data;
(new CWE566_Authorization_Bypass_Through_SQL_Primary__Servlet_67b()).badSink(dataContainer , request, response );
",bad
2210,140909-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null && !id.isEmpty()) {
    try (Connection conn = getConnection();
         PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE id = ?"")) {
        stmt.setString(1, id);
        ResultSet rs = stmt.executeQuery();
        // Process result set...
    } catch (SQLException e) {
        // Handle exception...
    }
}
",good
2211,146248-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_74b()).badSink(dataHashMap);
",bad
2212,146248-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
2213,147136-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2214,147136-v1.0.0,good,"// Instead of directly using the cookie value, sanitize it before using it in a SQL query.
// This can be done using a library function that escapes special characters.
// For example, using PreparedStatement in Java can help prevent SQL injection.
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE data = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2215,147544-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_75b()).badSink(dataSerialized , request, response );
",bad
2216,146778-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2217,146778-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2218,146778-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2219,146778-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2220,146778-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2221,146778-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2222,147906-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2223,147906-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2224,148247-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_75b()).badSink(dataSerialized);
",bad
2225,148247-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    Connection connection = DriverManager.getConnection(url, username, password);
    String sql = ""INSERT INTO table (column) VALUES (?)"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setBytes(1, dataSerialized);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
2226,146700-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2227,146700-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2228,146700-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2229,146700-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2230,146700-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2231,146700-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2232,148107-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2233,148107-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2234,148107-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2235,148107-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2236,148107-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2237,148107-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2238,146771-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2239,146771-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2240,146771-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2241,146771-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2242,146771-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2243,148143-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2244,148143-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2245,148143-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2246,148143-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2247,148143-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2248,148143-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2249,147465-v1.0.0,java,"data = request.getParameter(""name"");
",bad
2250,147465-v1.0.0,good,"// Use a PreparedStatement with a parameterized query to prevent SQL injection
String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
",good
2251,147458-v1.0.0,java,"data = request.getParameter(""name"");
",bad
2252,147458-v1.0.0,good,"String name = request.getParameter(""name"");
// Validate and sanitize the input data
name = sanitizeInput(name);
// Use a prepared statement with a parameterized query
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
2253,146992-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2254,146992-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2255,146992-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2256,146992-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
2257,146992-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2258,146992-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2259,146392-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_68b()).badSink();
",bad
2260,147079-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2261,147079-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2262,147079-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2263,147079-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2264,147079-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2265,146611-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2266,146611-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2267,147756-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_53b()).badSink(data );
",bad
2268,146720-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2269,146720-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2270,147903-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_52b()).badSink(data );
",bad
2271,147903-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // Process result set
} catch (SQLException e) {
    // Handle exception
} finally {
    // Close resources
}
",good
2272,146368-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2273,146368-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
2274,146368-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2275,146368-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
2276,146368-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2277,146368-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """")); // Remove any potentially harmful characters
    sqlStatement.addBatch();
}
",good
2278,147693-v1.0.0,java,"data = token.substring(3);
",bad
2279,147693-v1.0.0,good,"data = request.getParameter(""id"");
",good
2280,148072-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2281,148072-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2282,148072-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2283,148072-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2284,148072-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2285,148072-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2286,148058-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_71b()).badSink((Object)data);
",bad
2287,148058-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2288,146185-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2289,146185-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
    sqlStatement.addBatch();
}
",good
2290,146185-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2291,146185-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
2292,146185-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2293,146185-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
2294,146251-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2295,146251-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2296,148039-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2297,148039-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2298,148039-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2299,148039-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2300,148039-v1.0.0,good,"String safeData = data.replaceAll(""[^a-zA-Z0-9_]"", """");
sqlStatement.setString(1, safeData);
",good
2301,146326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2302,146326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2303,146326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2304,146326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2305,146326-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2306,146326-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2307,146286-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_75b()).badSink(dataSerialized);
",bad
2308,147109-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2309,147109-v1.0.0,good,"// Use a library to escape special characters in the data variable
data = escapeSql(data);
sqlStatement.setString(1, data);
",good
2310,147109-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2311,147109-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2312,147109-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2313,146817-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2314,146817-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
2315,146317-v1.0.0,java,"data = readerBuffered.readLine();
(new CWE89_SQL_Injection__connect_tcp_execute_67b()).badSink(dataContainer);
",bad
2316,146317-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
stmt.setString(1, data);
stmt.executeUpdate();
",good
2317,146563-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2318,146563-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2319,148122-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2320,148122-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
2321,147860-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_22b()).goodB2G2Sink(data );
",bad
2322,147860-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2323,147860-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_22b()).badSink(data );
",bad
2324,147860-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
2325,147860-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_22b()).goodB2G1Sink(data );
",bad
2326,147858-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2327,147858-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2328,148190-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2329,148190-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // ... rest of the code
} catch (SQLException exceptSql) {
    // ... error handling
} finally {
    // ... clean up resources
}
",good
2330,147883-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2331,147883-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2332,147883-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2333,147883-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2334,147883-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2335,147883-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2336,147088-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2337,147088-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (""safeCookieName"".equals(cookie.getName())) {
        data = cookie.getValue();
        break;
    }
}
",good
2338,147849-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2339,147849-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2340,147849-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2341,147849-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2342,147849-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2343,147849-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2344,146630-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2345,146630-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2346,146630-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2347,146630-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2348,146630-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2349,146630-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2350,147364-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2351,147364-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2352,147364-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2353,147364-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2354,147364-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2355,148263-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2356,148263-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2357,148263-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2358,148263-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2359,148263-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2360,148263-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2361,148357-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_74b()).badSink(dataHashMap);
",bad
2362,147981-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_66b()).badSink(dataArray);
",bad
2363,147338-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2364,147338-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2365,147338-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2366,147338-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2367,146617-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2368,146617-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2369,140880-v1.0.0,java,"data = request.getParameter(""id"");
id = Integer.parseInt(data);
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
2370,140880-v1.0.0,good,"// Validate and sanitize the input
String idStr = request.getParameter(""id"");
int id = -1;
try {
    id = Integer.parseInt(idStr);
    if (id < 0) {
        // Handle invalid input
    }
} catch (NumberFormatException nfx) {
    // Handle invalid input
}

// Use a prepared statement with parameter binding to prevent SQL injection
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",good
2371,146466-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_68b()).badSink();
",bad
2372,148209-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_74b()).badSink(dataHashMap);
",bad
2373,147861-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2374,147861-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2375,147080-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2376,147080-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2377,147635-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2378,147635-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2379,146241-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2380,146241-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
    preparedStatement.setString(1, data);
    resultSet = preparedStatement.executeQuery();
    IO.writeLine(resultSet.getRow());
}
// Rest of the code remains the same
",good
2381,146362-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2382,146362-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2383,148335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2384,148335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
2385,148335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2386,148335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2387,148335-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2388,148335-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2389,147102-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2390,147102-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2391,146163-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_51b()).badSink(data);
",bad
2392,146163-v1.0.0,good,"public void good() throws Throwable {
    String data;

    /* get environment variable ADD */
    data = System.getenv(""ADD"");

    Connection conn = /* obtain a database connection */
    String sql = ""SELECT * FROM table WHERE column = ?"";
    PreparedStatement stmt = conn.prepareStatement(sql);
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process the result set
}
",good
2393,146166-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_54b()).badSink(data );
",bad
2394,146166-v1.0.0,good,"public void good() throws Throwable {
    String data;
    data = System.getenv(""ADD"");

    // Use a prepared statement to safely insert the data
    Connection conn = /* obtain a database connection */
    PreparedStatement stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    stmt.setString(1, data);
    stmt.executeUpdate();
}
",good
2395,146457-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2396,146457-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2397,147293-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
2398,147293-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2399,147293-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2400,147293-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2401,147293-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2402,146459-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_51b()).badSink(data);
",bad
2403,147393-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_72b()).badSink(dataVector);
",bad
2404,148099-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_75b()).badSink(dataSerialized);
",bad
2405,147581-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeBatch_75b()).badSink(dataSerialized , request, response );
",bad
2406,146301-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2407,146301-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2408,146301-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2409,146301-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
2410,146301-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2411,146301-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2412,146662-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2413,146662-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status = 'updated' where name = ?"");
sqlStatement.setString(1, data);
",good
2414,146662-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2415,146662-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
2416,146662-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2417,146662-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2418,146499-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_54b()).badSink(data );
",bad
2419,146499-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2420,147887-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2421,147887-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2422,147887-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2423,147887-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2424,147887-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2425,147887-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2426,148244-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_72b()).badSink(dataVector);
",bad
2427,146486-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2428,146486-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2429,146486-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2430,146486-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2431,146486-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2432,146486-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Fix: Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2433,147743-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2434,147743-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""'"", ""''""));
",good
2435,147743-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2436,147743-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
2437,147743-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2438,146271-v1.0.0,java,"data = readerBuffered.readLine();
badSink(data);
",bad
2439,146271-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
statement.setString(1, data);
statement.executeUpdate();
",good
2440,146479-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2441,146479-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2442,146479-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2443,146479-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2444,146479-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2445,146479-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2446,146636-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2447,146636-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2448,147247-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_74b()).badSink(dataHashMap , request, response );
",bad
2449,146690-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2450,146690-v1.0.0,good,"String id = ""0""; // This value should be provided dynamically and properly sanitized
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2451,146854-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2452,146854-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2453,148090-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_54b()).badSink(data );
",bad
2454,148090-v1.0.0,good,"public void good() throws Throwable {
    String data;

    /* get system property user.home */
    data = System.getProperty(""user.home"");

    PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // ...
}
",good
2455,147527-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_22b()).goodB2G2Sink(data , request, response);
",bad
2456,147527-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2457,147527-v1.0.0,java,"data = request.getParameter(""name"");
",bad
2458,147527-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_22b()).goodB2G1Sink(data , request, response);
",bad
2459,147527-v1.0.0,good,"String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2460,146365-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2461,146365-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2462,146365-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
2463,146365-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2464,146365-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
2465,147371-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2466,147371-v1.0.0,good,"String allowedChars = ""abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_"";
String sanitizedData = data.replaceAll(""[^"" + allowedChars + ""]"", """");
sqlStatement.setString(1, sanitizedData);
",good
2467,147371-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2468,147371-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2469,147371-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2470,147371-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2471,147025-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_74b()).badSink(dataHashMap);
",bad
2472,146237-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_51b()).badSink(data);
",bad
2473,146418-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2474,146418-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2475,147564-v1.0.0,java,"data = token.substring(3);
",bad
2476,147564-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null && !id.isEmpty()) {
    data = id;
}
",good
2477,147564-v1.0.0,java,"data = token.substring(3);
",bad
2478,147564-v1.0.0,good,"data = request.getParameter(""id"");
",good
2479,147564-v1.0.0,java,"data = token.substring(3);
",bad
2480,147564-v1.0.0,good,"String id = request.getParameter(""id"");
String query = ""SELECT * FROM table WHERE id = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, id);
ResultSet rs = stmt.executeQuery();
",good
2481,146582-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2482,146582-v1.0.0,good,"String id = getUserInput(); // Assume this function safely gets user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2483,147619-v1.0.0,java,"data = token.substring(3);
",bad
2484,147619-v1.0.0,good,"data = request.getParameter(""id"");
",good
2485,147138-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2486,147138-v1.0.0,good,"// Instead of using the first cookie's value, loop through all cookies and validate/sanitize each one.
// Also, use prepared statements or parameterized queries to prevent SQL injection.
for (Cookie cookie : cookieSources) {
    String cookieValue = cookie.getValue();
    // Validate and sanitize cookieValue here
    // Use cookieValue in SQL query
}
",good
2487,146298-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2488,146298-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2489,146298-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2490,146298-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
2491,146298-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2492,146298-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2493,146179-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2494,146179-v1.0.0,good,"// Validate and sanitize input
String name = validateAndSanitizeInput(names[i]);

// Use parameterized query
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, name);
",good
2495,146179-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2496,146179-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2497,146179-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2498,146179-v1.0.0,good,"// Add input validation to check that names[i] only contains valid data
String pattern = ""^[a-zA-Z0-9]+$"";
if (!names[i].matches(pattern)) {
    throw new IllegalArgumentException(""Invalid name: "" + names[i]);
}
sqlStatement.setString(1, names[i]);
",good
2499,146167-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2500,146167-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2501,146228-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2502,146228-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2503,146228-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2504,146228-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
2505,146228-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2506,146228-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change the above line to the following to prevent SQL injection
// sqlStatement.setString(1, java.sql.DriverManager.getConnection(""jdbc:mysql://localhost:3306/test"", ""user"", ""password"").prepareStatement(""select * from users where name=?"").setString(1, data).toString());
",good
2507,148290-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2508,148290-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2509,148290-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2510,148290-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2511,148290-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2512,148290-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2513,148137-v1.0.0,java,"baseObject.action(data );
",bad
2514,148137-v1.0.0,good,"String data = System.getProperty(""user.home"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
// process result set
",good
2515,148070-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2516,148070-v1.0.0,good,"// Use a placeholder for the data variable
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
// Sanitize the data variable before using it in the SQL query
sqlStatement.setString(1, sanitizeInput(data));
",good
2517,148070-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2518,148070-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2519,148070-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2520,147970-v1.0.0,java,"data = properties.getProperty(""data"");
",bad
2521,147970-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2522,146227-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2523,146227-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2524,146227-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2525,146227-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2526,146227-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2527,147115-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2528,147115-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2529,147115-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
2530,147115-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2531,147115-v1.0.0,good,"// Use a library to sanitize the input or validate it against a whitelist.
// For example, using Apache Commons Text's StringEscapeUtils to escape special characters.
data = StringEscapeUtils.escapeSql(cookieSources[0].getValue());
",good
2532,147601-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_22b()).goodB2G2Sink(data , request, response);
",bad
2533,147601-v1.0.0,good,"String sql = ""SELECT * FROM table WHERE id = ?"";
PreparedStatement stmt = conn.prepareStatement(sql);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2534,147601-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_22b()).badSink(data , request, response);
",bad
2535,147601-v1.0.0,good,"PreparedStatement pstmt = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2536,147601-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_22b()).goodB2G1Sink(data , request, response);
",bad
2537,147601-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
2538,147672-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2539,147672-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2540,146550-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2541,146550-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2542,146550-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2543,146550-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2544,146550-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2545,146550-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2546,147253-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2547,147253-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
2548,147253-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2549,147253-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2550,147253-v1.0.0,java,"data = request.getParameter(""name"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2551,147072-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2552,147072-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    String name = names[i].replaceAll(""[';\\-]"", """"); // Remove any single quotes, semicolons, or hyphens
    sqlStatement.setString(1, name);
    sqlStatement.addBatch();
}
",good
2553,147072-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2554,147072-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2555,147072-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2556,147533-v1.0.0,java,"data = request.getParameter(""name"");
",bad
2557,147533-v1.0.0,good,"// Use PreparedStatement to prevent SQL injection
String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
",good
2558,146357-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_72b()).badSink(dataVector);
",bad
2559,146357-v1.0.0,good,"Connection conn = null;
PreparedStatement stmt = null;
try {
    conn = DriverManager.getConnection(""jdbc:mysql://host.example.org:39544/database"", ""username"", ""password"");
    stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    stmt.setString(1, data);
    stmt.executeUpdate();
} catch (SQLException e) {
    e.printStackTrace();
} finally {
    try {
        if (stmt != null) stmt.close();
        if (conn != null) conn.close();
    } catch (SQLException e) {
        e.printStackTrace();
    }
}
",good
2560,146580-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2561,146580-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2562,146321-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_73b()).badSink(dataLinkedList);
",bad
2563,146142-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2564,146142-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2565,146142-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2566,146142-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2567,146760-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_66b()).badSink(dataArray);
",bad
2568,146760-v1.0.0,good,"String data = System.getenv(""ADD"");
String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
     PreparedStatement stmt = conn.prepareStatement(query)) {
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process result set
} catch (SQLException e) {
    e.printStackTrace();
}
",good
2569,147973-v1.0.0,java,"data = properties.getProperty(""data"");
badSink(data);
",bad
2570,147973-v1.0.0,good,"// Use PreparedStatement to prevent SQL injection
PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
2571,148087-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_51b()).badSink(data);
",bad
2572,148087-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2573,146635-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2574,146635-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2575,146635-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2576,146635-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2577,146635-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2578,146635-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2579,148297-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2580,148297-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
2581,148171-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_73b()).badSink(dataLinkedList);
",bad
2582,148171-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, dataLinkedList.get(0));
pstmt.executeUpdate();
",good
2583,146954-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2584,146954-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2585,147910-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_71b()).badSink((Object)data);
",bad
2586,147376-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2587,147376-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2588,147953-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2589,147953-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2590,146793-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_52b()).badSink(data );
",bad
2591,147037-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2592,147037-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2593,147037-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2594,147037-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2595,147037-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2596,147037-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2597,148218-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2598,148218-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2599,148218-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2600,148218-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2601,148218-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2602,148218-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2603,146159-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2604,146159-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2605,147649-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_67b()).badSink(dataContainer , request, response );
",bad
2606,147649-v1.0.0,good,"// Use getParameter() method to retrieve the ""id"" parameter
String id = request.getParameter(""id"");

// Validate and sanitize the input to prevent SQL injection
// For example, use a prepared statement with parameterized queries
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, id);

// Execute the query and retrieve the results
ResultSet rs = pstmt.executeQuery();
",good
2607,146648-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2608,146648-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2609,146978-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_52b()).badSink(data );
",bad
2610,147132-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2611,147411-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2612,147411-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
2613,147411-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2614,147411-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2615,147411-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2616,147411-v1.0.0,good,"// Use a whitelist or a more secure method to validate the data before using it in the SQL statement
String validatedData = validateData(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, validatedData);
",good
2617,146212-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_75b()).badSink(dataSerialized);
",bad
2618,147449-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2619,147449-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2620,147449-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2621,147449-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2622,147449-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2623,147770-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2624,147770-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before using it in the SQL query.
// This can be done using methods like PreparedStatement.setString() which automatically escapes special characters.
",good
2625,147770-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2626,147770-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2627,147770-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2628,147770-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2629,146363-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2630,146363-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2631,146363-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2632,146363-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2633,146363-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
2634,148291-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2635,148291-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2636,148291-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2637,148291-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2638,148291-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2639,148291-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2640,147590-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2641,147590-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2642,147590-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2643,147590-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
2644,147590-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
2645,147590-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
2646,146183-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2647,146183-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2648,146183-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2649,146183-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2650,146183-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2651,148157-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2652,148157-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2653,147480-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2654,147480-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2655,147480-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2656,147480-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2657,146481-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2658,146481-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2659,146481-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2660,146481-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2661,146481-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2662,146481-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2663,147921-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2664,147921-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2665,147921-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2666,147921-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2667,147921-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2668,147921-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2669,147567-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2670,147567-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2671,146628-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2672,146628-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2673,146628-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2674,146628-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2675,146628-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2676,146628-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2677,147307-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response );
",bad
2678,147307-v1.0.0,good,"String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2679,147168-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2680,147168-v1.0.0,good,"for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""safeCookieName"")) {
        data = cookie.getValue();
        break;
    }
}
",good
2681,148182-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2682,148182-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2683,148182-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2684,148182-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2685,148182-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2686,147641-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2687,147641-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""UPDATE users SET status = ? WHERE name = ?"");
    preparedStatement.setString(1, ""updated"");
    preparedStatement.setString(2, data);

    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
// rest of the code...
",good
2688,146494-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2689,146494-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2690,146493-v1.0.0,java,"data = readerBuffered.readLine();
badSink(data);
",bad
2691,146493-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // Process the result set
} catch (SQLException e) {
    e.printStackTrace();
}
",good
2692,146319-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_71b()).badSink((Object)data);
",bad
2693,146319-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2694,146607-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2695,146607-v1.0.0,good,"int id = /* get id from user input */;
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
2696,147779-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2697,147779-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
2698,146587-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
2699,146587-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
2700,146587-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2701,146587-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2702,146587-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
2703,146587-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2704,148220-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2705,148220-v1.0.0,good,"// Use a library to sanitize the input before using it in the query
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
2706,148220-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2707,148220-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2708,148220-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2709,148220-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2710,146200-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_51b()).badSink(data);
",bad
2711,146200-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
2712,147053-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_53b()).badSink(data );
",bad
2713,147053-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
2714,146921-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2715,146921-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2716,146921-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2717,146921-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2718,146921-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
2719,146921-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
2720,146172-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_72b()).badSink(dataVector);
",bad
2721,146172-v1.0.0,good,"Connection conn = ... // obtain a database connection
String sql = ""INSERT INTO table (column) VALUES (?)"";
PreparedStatement stmt = conn.prepareStatement(sql);
stmt.setString(1, data);
stmt.executeUpdate();
",good
2722,148023-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_73b()).badSink(dataLinkedList);
",bad
2723,146190-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2724,146190-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
2725,146190-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2726,146190-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
2727,146190-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2728,146190-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
2729,147715-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2730,147715-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2731,146510-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2732,146510-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2733,146642-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2734,146642-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2735,147547-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2736,147547-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (String name : names) {
    sqlStatement.setString(1, name);
    sqlStatement.addBatch();
}
",good
2737,147547-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2738,147547-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2739,147547-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2740,147547-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    String name = names[i].replaceAll(""[';\\-]"", """"); // Remove any single quotes, semicolons, or hyphens
    sqlStatement.setString(1, name);
    sqlStatement.addBatch();
}
",good
2741,146150-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2742,146150-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2743,146150-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2744,146150-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
2745,146722-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2746,146722-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2747,147600-v1.0.0,java,"data = token.substring(3);
",bad
2748,147600-v1.0.0,good,"data = request.getParameter(""id"");
",good
2749,147600-v1.0.0,java,"data = token.substring(3);
",bad
2750,147600-v1.0.0,good,"data = request.getParameter(""id"");
",good
2751,147343-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2752,147343-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2753,147740-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2754,147740-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2755,147740-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2756,147740-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2757,147740-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, validateInput(names[i]));
",good
2758,147310-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_51b()).badSink(data , request, response );
",bad
2759,147310-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement pstmt = connection.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
// use the result set...
",good
2760,147119-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
2761,147119-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE data = ?"");
stmt.setString(1, data);
",good
2762,148074-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2763,148074-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2764,148074-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2765,148074-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2766,148074-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2767,147911-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_72b()).badSink(dataVector);
",bad
2768,148103-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2769,148103-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2770,148103-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2771,148103-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
2772,148103-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2773,148103-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that sanitizes the input to prevent SQL injection.
",good
2774,146442-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2775,146442-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2776,146442-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2777,146442-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2778,146442-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2779,146442-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2780,146977-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_51b()).badSink(data);
",bad
2781,146977-v1.0.0,good,"Connection conn = ... // obtain a connection to the database
String sql = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement stmt = conn.prepareStatement(sql);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
// process the result set
",good
2782,147531-v1.0.0,java,"dataBad = data;
badSink(request, response);
",bad
2783,147531-v1.0.0,good,"String query = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2784,146891-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2785,146891-v1.0.0,good,"sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
2786,148217-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2787,148217-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2788,148217-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2789,148217-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2790,148217-v1.0.0,good,"// Use a whitelist or a more secure method to validate the input data
String validatedData = validateInput(data);
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, validatedData);
",good
2791,148024-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_74b()).badSink(dataHashMap);
",bad
2792,148024-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
2793,146989-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_75b()).badSink(dataSerialized);
",bad
2794,146962-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2795,146962-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2796,146962-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2797,146962-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2798,146962-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2799,146962-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2800,147064-v1.0.0,java,"baseObject.action(data);
",bad
2801,148150-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2802,148150-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2803,148150-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2804,148150-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2805,148150-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2806,146712-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2807,146712-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
2808,146712-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2809,146712-v1.0.0,good,"String id = ""0""; // This should be a dynamic value, not hardcoded
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
2810,146712-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2811,146712-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2812,147051-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_51b()).badSink(data);
",bad
2813,147051-v1.0.0,good,"PreparedStatement preparedStatement = null;
Connection connection = null;

try {
    connection = DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""user"", ""password"");
    String sql = ""SELECT * FROM users WHERE username = ?"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);

    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    e.printStackTrace();
} finally {
    try {
        if (preparedStatement != null) {
            preparedStatement.close();
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }
    try {
        if (connection != null) {
            connection.close();
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }
}
",good
2814,147372-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2815,147372-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
2816,146721-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2817,146721-v1.0.0,good,"int id = /* get id from user input */;
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
2818,147656-v1.0.0,java,"data = token.substring(3);
",bad
2819,147656-v1.0.0,good,"data = request.getParameter(""id"");
",good
2820,147316-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_67b()).badSink(dataContainer , request, response );
",bad
2821,147316-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE name = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
2822,147530-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2823,147530-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2824,147443-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2825,147443-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (name, status) values (?, 'updated')"");
sqlStatement.setString(1, data);
",good
2826,147443-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2827,147443-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2828,147443-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2829,147443-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2830,146972-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_22b()).goodB2G2Sink(data );
",bad
2831,146972-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_22b()).badSink(data );
",bad
2832,146972-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_22b()).goodB2G1Sink(data );
",bad
2833,146994-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2834,146994-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly sanitizes the input to prevent SQL injection.
",good
2835,146994-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2836,146994-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
2837,146994-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2838,146994-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly sanitizes the input to prevent SQL injection.
",good
2839,147281-v1.0.0,java,"data = request.getParameter(""name"");
",bad
2840,147281-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
",good
2841,146704-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2842,146704-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2843,146704-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2844,146704-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2845,146704-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2846,146704-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2847,147459-v1.0.0,java,"data = request.getParameter(""name"");
",bad
2848,147459-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
",good
2849,147624-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2850,147624-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2851,147624-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2852,147624-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2853,147624-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2854,147624-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2855,147674-v1.0.0,java,"data = token.substring(3);
",bad
2856,147674-v1.0.0,good,"data = request.getParameter(""id"");
",good
2857,147674-v1.0.0,java,"data = token.substring(3);
",bad
2858,147674-v1.0.0,good,"data = request.getParameter(""id"");
",good
2859,146787-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_22b()).goodB2G2Sink(data );
",bad
2860,146787-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2861,146787-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_22b()).badSink(data);
",bad
2862,146787-v1.0.0,good,"// Use prepared statements or parameterized queries to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
2863,146787-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_22b()).goodB2G1Sink(data);
",bad
2864,147029-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2865,147029-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2866,147029-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2867,147029-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2868,147029-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2869,146367-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2870,146367-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2871,146367-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2872,146367-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2873,146367-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""'"", ""''""));
",good
2874,146736-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2875,146736-v1.0.0,good,"data = data.replaceAll(""[^a-zA-Z0-9_]"", """");
sqlStatement.setString(1, data);
",good
2876,146736-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2877,146736-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2878,146736-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2879,146351-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_54b()).badSink(data );
",bad
2880,146276-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_53b()).badSink(data );
",bad
2881,147971-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_22b()).goodB2G2Sink(data );
",bad
2882,147971-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_22b()).badSink(data );
",bad
2883,147971-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_22b()).goodB2G1Sink(data );
",bad
2884,148280-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_71b()).badSink((Object)data);
",bad
2885,146398-v1.0.0,java,"baseObject.action(data );
",bad
2886,147118-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2887,147118-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2888,140901-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
2889,147939-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_51b()).badSink(data);
",bad
2890,147557-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2891,147557-v1.0.0,good,"sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
2892,146666-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2893,146666-v1.0.0,good,"// Validate and sanitize the data variable before using it in the prepared statement
data = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2894,146666-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2895,146666-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2896,146666-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2897,146666-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2898,147942-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_54b()).badSink(data );
",bad
2899,146616-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2900,146616-v1.0.0,good,"int id = /* get id from a trusted source */;
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
2901,146668-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2902,146668-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2903,146668-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2904,146668-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
2905,146668-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2906,146668-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2907,146695-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2908,146695-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2909,147066-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2910,147066-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2911,147066-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2912,147066-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2913,147066-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (String name : names) {
    sqlStatement.setString(1, name);
    sqlStatement.addBatch();
}
",good
2914,146981-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2915,146981-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2916,147357-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_73b()).badSink(dataLinkedList);
",bad
2917,147771-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2918,147771-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
2919,147771-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
2920,147771-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
2921,147771-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
2922,146491-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_22b()).goodB2G2Sink(data );
",bad
2923,146491-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
2924,146491-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_22b()).badSink(data );
",bad
2925,146491-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // Process the result set
} catch (SQLException e) {
    e.printStackTrace();
}
",good
2926,146491-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_22b()).goodB2G1Sink(data );
",bad
2927,146491-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    e.printStackTrace();
}
",good
2928,147065-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2929,147065-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
2930,147400-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2931,147400-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2932,147400-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2933,147400-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
2934,147400-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2935,147400-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, java.sql.DriverManager.getConnection(url, user, password).quote(data));
",good
2936,147828-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_51b()).badSink(data);
",bad
2937,146517-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2938,146517-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2939,146517-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2940,146517-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2941,146517-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2942,146517-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2943,147522-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2944,147522-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2945,147522-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2946,147522-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2947,147522-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2948,147522-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2949,146724-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2950,146724-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2951,147225-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2952,147225-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2953,147225-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2954,147225-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2955,147225-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2956,146800-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_71b()).badSink((Object)data);
",bad
2957,146800-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
2958,146694-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
2959,146694-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
2960,147402-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2961,147402-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2962,147402-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2963,147402-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
2964,147402-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2965,147402-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2966,147427-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_67b()).badSink(dataContainer);
",bad
2967,146667-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2968,146667-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2969,146667-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2970,146667-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2971,146667-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2972,146667-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
2973,148304-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_22b()).badSink(data );
",bad
2974,147558-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2975,147558-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2976,147558-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
2977,147558-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2978,147558-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
// Add this line to sanitize the input
names[i] = sanitizeInput(names[i]);
",good
2979,148193-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_22b()).badSink(data );
",bad
2980,148193-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_22b()).goodB2G1Sink(data );
",bad
2981,148061-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_74b()).badSink(dataHashMap);
",bad
2982,147926-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2983,147926-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2984,147926-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2985,147926-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
2986,147926-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2987,147926-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2988,147223-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2989,147223-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
2990,147223-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
2991,147223-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
2992,147223-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
2993,147223-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status='updated' where name=?"");
",good
2994,147734-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2995,147734-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
2996,147734-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
2997,147734-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
2998,147734-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
2999,146964-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3000,146964-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3001,146964-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3002,146964-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3003,146964-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3004,146964-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3005,148358-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_75b()).badSink(dataSerialized);
",bad
3006,147904-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_53b()).badSink(data );
",bad
3007,147512-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3008,147512-v1.0.0,good,"// Remove any single quotes from the data variable
data = data.replace(""'"", """");
sqlStatement.setString(1, data);
",good
3009,147512-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3010,147512-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3011,147512-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3012,147512-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3013,146233-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3014,146233-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3015,147258-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3016,147258-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
// Use parameterized query to prevent SQL injection
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
3017,147258-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3018,147258-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3019,147258-v1.0.0,java,"data = request.getParameter(""name"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3020,147258-v1.0.0,good,"// Instead of directly using the user-provided data, use a parameterized query to prevent SQL injection.
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3021,146606-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3022,146606-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3023,147023-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_72b()).badSink(dataVector);
",bad
3024,147511-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3025,147511-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
",good
3026,147511-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3027,147511-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3028,147511-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3029,147511-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3030,148088-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_52b()).badSink(data);
",bad
3031,148027-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3032,148027-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3033,147749-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_22b()).goodB2G2Sink(data );
",bad
3034,147749-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
3035,147749-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_22b()).badSink(data );
",bad
3036,147749-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
3037,147749-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_22b()).goodB2G1Sink(data );
",bad
3038,146807-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3039,146807-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3040,146807-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3041,146807-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
3042,146807-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3043,146807-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before inserting into the query
",good
3044,147207-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3045,147207-v1.0.0,good,"// Validate and sanitize the data before using it in a SQL query
String data = """";
Cookie[] cookieSources = request.getCookies();
if (cookieSources != null) {
    for (Cookie cookie : cookieSources) {
        if (cookie.getName().equals(""desired_cookie_name"")) {
            data = sanitizeInput(cookie.getValue());
            break;
        }
    }
}
",good
3046,147832-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3047,147832-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3048,147128-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3049,147395-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_74b()).badSink(dataHashMap);
",bad
3050,146861-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_22b()).goodB2G2Sink(data );
",bad
3051,146861-v1.0.0,good,"public void goodB2G2Sink(String data) throws SQLException {
    Connection conn = ...; // obtain connection
    PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process result set
}
",good
3052,146861-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_22b()).badSink(data );
",bad
3053,146861-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
3054,146861-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_22b()).goodB2G1Sink(data);
",bad
3055,146861-v1.0.0,good,"private void goodB2G1() throws Throwable {
    String data = null;

    /* get environment variable ADD */
    data = System.getenv(""ADD"");

    goodB2G1PublicStatic = false;
    Connection conn = /* obtain database connection */;
    String query = ""SELECT * FROM table WHERE column = ?"";
    PreparedStatement stmt = conn.prepareStatement(query);
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process result set
}
",good
3056,147673-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3057,147673-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3058,147169-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3059,147169-v1.0.0,good,"if (cookieSources != null && cookieSources.length > 0) {
    String cookieValue = cookieSources[0].getValue();
    // Validate and sanitize the cookie value before using it in a SQL query
    // ...
    data = cookieValue;
}
",good
3060,148085-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3061,148085-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error executing SQL statement"", exceptSql);
} finally {
    try {
        if (preparedStatement != null) {
            preparedStatement.close();
        }
    } catch (SQLException exceptSql) {
        IO.logger.log(Level.WARNING, ""Error closing PreparedStatement"", exceptSql);
    }
}
",good
3062,146883-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3063,146883-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""'"", ""''""));
",good
3064,146883-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3065,146883-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3066,146883-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3067,146519-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3068,146519-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3069,146519-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3070,146519-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3071,146519-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3072,146519-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped to prevent SQL injection
data = data.replace(""'"", ""''"");
sqlStatement.setString(1, data);
",good
3073,146794-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_53b()).badSink(data );
",bad
3074,146794-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
3075,146220-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3076,146220-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3077,146220-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3078,146220-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3079,146220-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3080,146220-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3081,146641-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3082,146641-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3083,147869-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3084,147869-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
3085,147473-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3086,147473-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3087,147473-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3088,147473-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
3089,147473-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3090,148267-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_22b()).badSink(data );
",bad
3091,146814-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3092,146814-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add validation or sanitization for the data variable here
",good
3093,146814-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3094,146814-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
3095,146814-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3096,146814-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
3097,147026-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_75b()).badSink(dataSerialized);
",bad
3098,147577-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeBatch_71b()).badSink((Object)data , request, response );
",bad
3099,147577-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
// use resultSet here
",good
3100,147684-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3101,147684-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
3102,147783-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3103,147783-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3104,148184-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3105,148184-v1.0.0,good,"String allowedChars = ""abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_"";
String sanitizedName = """";
for (char c : names[i].toCharArray()) {
    if (allowedChars.indexOf(c) != -1) {
        sanitizedName += c;
    }
}
sqlStatement.setString(1, sanitizedName);
",good
3106,148184-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3107,148184-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3108,148184-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3109,146739-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3110,146739-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3111,146739-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3112,146739-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3113,146739-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, validateInput(data));
",good
3114,147074-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3115,147074-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3116,147074-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
3117,147074-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3118,147650-v1.0.0,java,"data = token.substring(3);
",bad
3119,147650-v1.0.0,good,"data = request.getParameter(""id"");
",good
3120,148104-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3121,148104-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped or parameterized to prevent SQL injection
",good
3122,148104-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3123,148104-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3124,148104-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3125,148104-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3126,146970-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3127,146970-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3128,146698-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3129,146698-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3130,146698-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3131,146698-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3132,146698-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3133,146698-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3134,146180-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3135,146180-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, sanitizeInput(names[i]));
    sqlStatement.addBatch();
}
",good
3136,146180-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3137,146180-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3138,146180-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3139,146180-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3140,147913-v1.0.0,java,"HashMap<Integer,String> dataHashMap = new HashMap<Integer,String>();
dataHashMap.put(0, data);
dataHashMap.put(1, data);
dataHashMap.put(2, data);
(new CWE89_SQL_Injection__listen_tcp_prepareStatement_74b()).badSink(dataHashMap);
",bad
3141,148124-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_51b()).badSink(data);
",bad
3142,148124-v1.0.0,good,"public void good() throws Throwable {
    String data;

    /* get system property user.home */
    data = System.getProperty(""user.home"");

    /* Use a prepared statement with a parameterized query to prevent SQL injection */
    PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE home_directory = ?"");
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();

    // Process the results...
}
",good
3143,148223-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3144,148223-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
3145,148319-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_73b()).badSink(dataLinkedList);
",bad
3146,146965-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3147,146965-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
3148,146762-v1.0.0,java,"data = System.getenv(""ADD"");
(new CWE89_SQL_Injection__Environment_executeQuery_68b()).badSink();
",bad
3149,147382-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3150,147382-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3151,146239-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_53b()).badSink(data );
",bad
3152,146986-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_72b()).badSink(dataVector);
",bad
3153,146986-v1.0.0,good,"PreparedStatement pstmt = null;
try {
    String query = ""INSERT INTO table_name (column1, column2, column3) VALUES (?, ?, ?)"";
    pstmt = conn.prepareStatement(query);
    pstmt.setString(1, dataVector.get(0));
    pstmt.setString(2, dataVector.get(1));
    pstmt.setString(3, dataVector.get(2));
    pstmt.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (pstmt != null) {
        pstmt.close();
    }
}
",good
3154,146726-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3155,146726-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3156,147032-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3157,147032-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3158,147032-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3159,147032-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3160,147032-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3161,147032-v1.0.0,good,"String sanitizedData = data.replaceAll(""[^a-zA-Z0-9]"", """");
sqlStatement.setString(1, sanitizedData);
",good
3162,148196-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3163,148196-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3164,146513-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3165,146513-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3166,146513-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3167,146513-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3168,146513-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3169,146513-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3170,147362-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3171,147362-v1.0.0,good,"// Use a PreparedStatement with a parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));

// Add a method to sanitize input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, limiting input length, etc.
}
",good
3172,147362-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3173,147362-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3174,147362-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3175,147853-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3176,147853-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
3177,147719-v1.0.0,java,"data = token.substring(3);
",bad
3178,147719-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
",good
3179,146283-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_72b()).badSink(dataVector);
",bad
3180,146283-v1.0.0,good,"PreparedStatement statement = null;
try {
    Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""user"", ""password"");
    String sql = ""INSERT INTO table (column) VALUES (?)"";
    statement = connection.prepareStatement(sql);
    statement.setString(1, data);
    statement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (statement != null) {
        statement.close();
    }
}
",good
3181,148240-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_66b()).badSink(dataArray);
",bad
3182,148240-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
3183,147736-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3184,147736-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
3185,147736-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3186,147736-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3187,147736-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3188,147733-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3189,147733-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3190,147733-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3191,147733-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3192,147733-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
3193,148000-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3194,148000-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, validateInput(names[i]));
",good
3195,148000-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3196,148000-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3197,148000-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
3198,147366-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3199,147366-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3200,147366-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3201,147366-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3202,147366-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3203,147366-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3204,146258-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3205,146258-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3206,146258-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3207,146258-v1.0.0,good,"String sql = ""insert into users (status) values ('updated') where name=?"";
PreparedStatement pstmt = dbConnection.prepareStatement(sql);
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3208,146258-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3209,146258-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3210,148179-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3211,148179-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    // Escape special characters to prevent SQL injection
    String safeName = escapeSpecialCharacters(names[i]);
    sqlStatement.setString(1, safeName);
    sqlStatement.addBatch();
}
",good
3212,148179-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3213,148179-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code
}
// rest of the code
",good
3214,148179-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3215,148179-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
3216,146297-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3217,146297-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3218,146297-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3219,146297-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3220,146297-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3221,146297-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3222,147573-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3223,147573-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
3224,147777-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3225,147777-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, escapeString(data));
",good
3226,147777-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3227,147777-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3228,147777-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3229,147777-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change the above line to the following to prevent SQL injection
// sqlStatement.setString(1, sanitizeInput(data));
",good
3230,147697-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3231,147697-v1.0.0,good,"// Use getParameter() method to obtain the 'id' from the query string
String data = request.getParameter(""id"");

// Validate and sanitize the input to prevent SQL injection
// This is a simple example, more robust validation and sanitization may be required
if (data != null && !data.isEmpty() && data.matches(""[a-zA-Z0-9]+"")) {
    sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    sqlStatement.setString(1, data);
    // Rest of the code...
} else {
    // Handle invalid input
}
",good
3232,147697-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3233,147697-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3234,147697-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3235,147697-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3236,146626-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3237,146626-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3238,146626-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3239,146626-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3240,146626-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3241,146626-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3242,147113-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3243,147113-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
3244,147900-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3245,147900-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3246,146637-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3247,146637-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3248,148336-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3249,148336-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3250,148336-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3251,148336-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3252,148336-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3253,148336-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3254,147409-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3255,147409-v1.0.0,good,"PreparedStatement sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
3256,148057-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_68b()).badSink();
",bad
3257,148057-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM Users WHERE home = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
3258,148154-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3259,148154-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3260,148283-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_74b()).badSink(dataHashMap);
",bad
3261,147230-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3262,147230-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE data = ?"");
pstmt.setString(1, data);
",good
3263,147230-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3264,148331-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3265,148331-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3266,148331-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3267,148331-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3268,148331-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3269,148331-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3270,147949-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_73b()).badSink(dataLinkedList);
",bad
3271,148129-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_66b()).badSink(dataArray);
",bad
3272,148129-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
3273,146145-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3274,146145-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3275,146145-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // ... rest of the code
} catch (SQLException exceptSql) {
    // ... handle exception
} finally {
    // ... close resources
}
",good
3276,146145-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3277,146339-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3278,146339-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3279,146339-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3280,146339-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3281,146339-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3282,146339-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3283,147232-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3284,147232-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3285,148262-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3286,148262-v1.0.0,good,"// Use a whitelist or validation to ensure that the data variable only contains safe input.
// For example, you could use a regular expression to ensure that the data variable only contains alphanumeric characters.
String safeData = data.replaceAll(""[^a-zA-Z0-9]"", """");
sqlStatement.setString(1, safeData);
",good
3287,148262-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3288,148262-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3289,148262-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3290,148262-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3291,146561-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3292,146561-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3293,146561-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3294,146561-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
3295,146561-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3296,146561-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3297,146372-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3298,146372-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3299,146372-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3300,146372-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3301,146372-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3302,146333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3303,146333-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3304,146333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3305,146333-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3306,146333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3307,146333-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3308,147000-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3309,147000-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3310,147000-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3311,147000-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3312,147000-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3313,147000-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3314,146581-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3315,146581-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3316,147915-v1.0.0,java,"baseObject.action(data);
",bad
3317,147915-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
3318,146774-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3319,146774-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3320,146774-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3321,146774-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3322,146774-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3323,146480-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3324,146480-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, ""'"" + data.replace(""'"", ""''"") + ""'"");
// This will escape any single quotes in the data, preventing SQL injection.
",good
3325,146480-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3326,146480-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
3327,146480-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3328,146480-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3329,148059-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_72b()).badSink(dataVector);
",bad
3330,147447-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3331,147447-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3332,147447-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3333,147447-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3334,147447-v1.0.0,good,"// Use a parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3335,148018-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_66b()).badSink(dataArray);
",bad
3336,148018-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table_name (column_name) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
3337,146848-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3338,146848-v1.0.0,good,"// Validate and sanitize the data before using it in the prepared statement
data = validateAndSanitize(data);
sqlStatement.setString(1, data);
",good
3339,146848-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3340,146848-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3341,146848-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3342,146848-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3343,146218-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3344,146218-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3345,146218-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3346,146218-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3347,146218-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3348,147556-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement.setString(1, names[i]);
",bad
3349,147556-v1.0.0,good,"// Use a whitelist to validate the input
List<String> validNames = Arrays.asList(""valid"", ""names"", ""here"");
String[] names = data.split(""-"");
for (int i = 0; i < names.length; i++) {
    if (validNames.contains(names[i])) {
        sqlStatement.setString(1, names[i]);
        sqlStatement.addBatch();
    } else {
        // Handle invalid input
    }
}
",good
3350,147556-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3351,147556-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3352,147556-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
3353,147556-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
3354,147405-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3355,147405-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3356,147405-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3357,147405-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values (?) where name=?"");
pstmt.setString(1, ""updated"");
pstmt.setString(2, data);
int rowCount = pstmt.executeUpdate();
",good
3358,147405-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3359,147135-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_executeQuery_73b()).badSink(dataLinkedList , request, response );
",bad
3360,147328-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3361,147328-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3362,147328-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3363,147328-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3364,147747-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3365,147747-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
3366,147424-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_54b()).badSink(data);
",bad
3367,147424-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
3368,146332-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3369,146332-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3370,146332-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3371,146332-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3372,146332-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3373,146332-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3374,147073-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3375,147073-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, sanitizeInput(names[i]));
    sqlStatement.addBatch();
}
",good
3376,147073-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3377,147073-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
3378,147073-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3379,147073-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, java.sql.DriverManager.getConnection(url, username, password).quote(names[i]));
",good
3380,146838-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_72b()).badSink(dataVector);
",bad
3381,146838-v1.0.0,good,"Connection conn = ... // obtain a connection to the database
String query = ""INSERT INTO table (column) VALUES (?)"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
stmt.executeUpdate();
",good
3382,146968-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3383,146968-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3384,146968-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3385,146968-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3386,146968-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3387,146627-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3388,146627-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3389,146627-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3390,146627-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3391,146627-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3392,146627-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3393,147063-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_75b()).badSink(dataSerialized);
",bad
3394,146243-v1.0.0,java,"data = readerBuffered.readLine();
...
dataContainer.containerOne = data;
...
(new CWE89_SQL_Injection__connect_tcp_executeQuery_67b()).badSink(dataContainer);
",bad
3395,147706-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3396,147706-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3397,147706-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3398,147706-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3399,148255-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3400,148255-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3401,148255-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3402,148255-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3403,148255-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3404,148255-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3405,148056-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_67b()).badSink(dataContainer);
",bad
3406,148056-v1.0.0,good,"String data = System.getProperty(""user.home"");
String sql = ""SELECT * FROM users WHERE home = ?"";
try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
     PreparedStatement pstmt = conn.prepareStatement(sql)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
3407,146837-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_71b()).badSink((Object)data);
",bad
3408,146837-v1.0.0,good,"// Use prepared statements or parameterized queries to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
3409,148175-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3410,148175-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    String query = ""update users set hitcount=hitcount+1 where name=?"";
    preparedStatement = dbConnection.prepareStatement(query);
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
3411,146171-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_71b()).badSink((Object)data);
",bad
3412,146171-v1.0.0,good,"public void good() throws Throwable {
    String data;
    data = System.getenv(""ADD"");

    Connection conn = /* obtain database connection */
    PreparedStatement stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    stmt.setString(1, data);
    stmt.executeUpdate();
}
",good
3413,147461-v1.0.0,java,"data = request.getParameter(""name"");
",bad
3414,147461-v1.0.0,good,"// Use a PreparedStatement to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
3415,146880-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3416,146880-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3417,147607-v1.0.0,java,"data = token.substring(3);
",bad
3418,147607-v1.0.0,good,"// Instead of using substring, use getParameter method to get the value of ""id""
data = request.getParameter(""id"");
",good
3419,147830-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_53b()).badSink(data );
",bad
3420,147872-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_68b()).badSink();
",bad
3421,147880-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3422,147880-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3423,147880-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3424,147880-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3425,147880-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3426,147880-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3427,146829-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_51b()).badSink(data);
",bad
3428,146829-v1.0.0,good,"public void good() throws Throwable {
    String data;

    /* get environment variable ADD */
    data = System.getenv(""ADD"");

    Connection conn = /* obtain a connection to the database */
    PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // use the result set
}
",good
3429,146545-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_75b()).badSink(dataSerialized);
",bad
3430,148015-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeBatch_53b()).badSink(data );
",bad
3431,148015-v1.0.0,good,"String query = ""SELECT * FROM users WHERE home = ?"";
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
3432,147127-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3433,148135-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_74b()).badSink(dataHashMap);
",bad
3434,147406-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3435,147406-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3436,147406-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3437,147406-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3438,147406-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3439,147406-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, PreparedStatement.escapeString(data));
",good
3440,146757-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_53b()).badSink(data);
",bad
3441,146306-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_22b()).goodB2G2Sink(data );
",bad
3442,146306-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_22b()).badSink(data );
",bad
3443,146306-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_22b()).goodB2G1Sink(data );
",bad
3444,146306-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (PreparedStatement stmt = conn.prepareStatement(query)) {
    stmt.setString(1, data);
    ResultSet rs = stmt.executeQuery();
    // process results
} catch (SQLException e) {
    // handle exception
}
",good
3445,148323-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3446,148323-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3447,147467-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_72b()).badSink(dataVector , request, response );
",bad
3448,147467-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
3449,148359-v1.0.0,java,"baseObject.action(data);
",bad
3450,148359-v1.0.0,good,"// Use a library like Apache Commons Text's StringEscapeUtils to escape any special characters in the data
String escapedData = StringEscapeUtils.escapeSql(data);
baseObject.action(escapedData);
",good
3451,147767-v1.0.0,java,"baseObject.action(data);
",bad
3452,147767-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    try {
        if (statement != null) {
            statement.close();
        }
    } catch (SQLException e) {
        // handle exception
    }
}
",good
3453,140902-v1.0.0,java,"data = request.getParameter(""id"");
",bad
3454,140902-v1.0.0,good,"String id = request.getParameter(""id"");
String query = ""SELECT * FROM users WHERE id = ?"";
try (PreparedStatement statement = connection.prepareStatement(query)) {
    statement.setString(1, id);
    ResultSet resultSet = statement.executeQuery();
    // Process the result set
}
",good
3455,147414-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3456,147414-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3457,146649-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3458,146649-v1.0.0,good,"String id = ""0""; // Assume this value is user-provided
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
3459,146586-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
3460,146586-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
",good
3461,146586-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3462,146586-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3463,146586-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3464,146586-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3465,146327-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3466,146327-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3467,146327-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3468,146327-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3469,146327-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3470,146327-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3471,146553-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3472,146553-v1.0.0,good,"String id = ""0""; // This should be replaced with a user input that is properly sanitized
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
3473,146553-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3474,146553-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
pstmt.setString(1, names[i]);
sqlStatement.addBatch(pstmt);
",good
3475,146553-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3476,146553-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3477,140896-v1.0.0,java,"data = request.getParameter(""id"");
id = Integer.parseInt(data);
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
3478,140896-v1.0.0,good,"// Validate and sanitize the input
String idStr = request.getParameter(""id"");
int id = -1;
try {
    id = Integer.parseInt(idStr);
    if (id < 0) {
        throw new NumberFormatException();
    }
} catch (NumberFormatException nfx) {
    // Handle invalid input
    // For example, you can return an error response or set a default value
}

preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",good
3479,146299-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3480,146299-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
Boolean result = sqlStatement.execute();
",good
3481,146402-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3482,146402-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3483,146402-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3484,146402-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3485,146402-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3486,147015-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_52b()).badSink(data );
",bad
3487,147535-v1.0.0,java,"data = request.getParameter(""name"");
",bad
3488,147535-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
3489,146930-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3490,146930-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3491,146930-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3492,146930-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3493,146930-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
3494,146930-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3495,147046-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_22b()).goodB2G2Sink(data );
",bad
3496,147046-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_22b()).badSink(data);
",bad
3497,147046-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_22b()).goodB2G1Sink(data );
",bad
3498,147912-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_prepareStatement_73b()).badSink(dataLinkedList);
",bad
3499,148145-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3500,148145-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3501,148145-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3502,148145-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3503,148145-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3504,148145-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3505,140905-v1.0.0,java,"data = request.getParameter(""id"");
",bad
3506,140905-v1.0.0,good,"// Use prepared statements or parameterized queries to prevent SQL injection
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE id = ?"");
pstmt.setString(1, request.getParameter(""id""));
ResultSet rs = pstmt.executeQuery();
",good
3507,147162-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3508,146809-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3509,146809-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3510,146809-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3511,146809-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3512,146809-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3513,146809-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));

// Add a function to sanitize the input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, whitelisting allowed characters, etc.
    // For example, using a library like OWASP's ESAPI to escape SQL characters
    return ESAPI.encoder().encodeForSQL(input);
}
",good
3514,147816-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3515,147816-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
3516,147834-v1.0.0,java,"data = readerBuffered.readLine();
(new CWE89_SQL_Injection__listen_tcp_executeUpdate_67b()).badSink(dataContainer);
",bad
3517,147847-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3518,147847-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
3519,147847-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3520,147847-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3521,147847-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3522,147847-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3523,146864-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3524,146864-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3525,146316-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__connect_tcp_execute_66b()).badSink(dataArray);
",bad
3526,148233-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3527,148233-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3528,147549-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3529,147549-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
3530,147549-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3531,147549-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3532,147549-v1.0.0,java,"String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
3533,147549-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, sanitizeInput(names[i]));
    sqlStatement.addBatch();
}

// Implement a function to sanitize input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, whitelisting allowed characters, etc.
    // For example, using a library like OWASP's ESAPI can help prevent SQL injection
}
",good
3534,148043-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3535,148043-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3536,146651-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3537,146651-v1.0.0,good,"String id = ""0""; // Assume this is user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
3538,147165-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3539,147165-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE cookie_value = ?"");
pstmt.setString(1, cookieSources[0].getValue());
ResultSet rs = pstmt.executeQuery();
",good
3540,146929-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
3541,146929-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3542,146929-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3543,146929-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3544,146929-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3545,146929-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3546,147221-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3547,147221-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status='updated' where name=?"");
",good
3548,147221-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3549,147221-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3550,147221-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3551,147221-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3552,146215-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3553,146215-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3554,146215-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3555,146215-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3556,146215-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3557,146215-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
3558,147485-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3559,147485-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
3560,147485-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3561,147485-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
3562,147485-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3563,146207-v1.0.0,java,"String query = ""SELECT * FROM users WHERE username = '"" + data + ""'"";
",bad
3564,146207-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE username = ?"");
stmt.setString(1, data);
",good
3565,147229-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3566,147229-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3567,147133-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3568,147133-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
3569,147075-v1.0.0,java,"sqlStatement.setString(1, names[i]);
",bad
3570,147075-v1.0.0,good,"sqlStatement.setString(1, java.sql.PreparedStatement.escapeString(names[i]));
",good
3571,147075-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3572,147075-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3573,147075-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3574,147075-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (String name : names) {
    sqlStatement.setString(1, sanitizeInput(name));
    sqlStatement.addBatch();
}
",good
3575,147305-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_22b()).goodB2G2Sink(data , request, response);
",bad
3576,147305-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
// Use the result set...
",good
3577,147305-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_22b()).badSink(data , request, response);
",bad
3578,147305-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement ps = connection.prepareStatement(""SELECT * FROM users WHERE name = ?"");
ps.setString(1, data);
ResultSet rs = ps.executeQuery();
",good
3579,147305-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_22b()).goodB2G1Sink(data , request, response);
",bad
3580,147305-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
3581,148131-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_68b()).badSink();
",bad
3582,148270-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3583,148270-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3584,148313-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3585,148313-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
3586,147589-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3587,147589-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3588,147589-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3589,147589-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3590,147589-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
3591,147589-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
3592,148274-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_53b()).badSink(data );
",bad
3593,147092-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3594,147092-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
3595,146397-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_75b()).badSink(dataSerialized);
",bad
3596,147808-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3597,147808-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3598,147808-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3599,147808-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3600,147808-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3601,147033-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3602,147033-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3603,147033-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3604,147033-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3605,147033-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3606,147033-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, java.sql.Types.VARCHAR, data);
",good
3607,147099-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3608,148324-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3609,148324-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3610,148324-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3611,148324-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3612,148324-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3613,148324-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3614,146312-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_52b()).badSink(data );
",bad
3615,147337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3616,147337-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3617,147337-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3618,147337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3619,146425-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_54b()).badSink(data );
",bad
3620,148201-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_54b()).badSink(data );
",bad
3621,146296-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3622,146296-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3623,146296-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3624,146296-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
3625,146296-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3626,146296-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3627,147545-v1.0.0,java,"data = request.getParameter(""name"");
baseObject.action(data , request, response);
",bad
3628,147545-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
// use the result set...
",good
3629,147496-v1.0.0,java,"data = request.getParameter(""name"");
",bad
3630,147496-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
3631,146784-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3632,146784-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3633,146898-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_22b()).goodB2G2Sink(data );
",bad
3634,146898-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_22b()).badSink(data );
",bad
3635,146898-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_22b()).goodB2G1Sink(data );
",bad
3636,148204-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_67b()).badSink(dataContainer);
",bad
3637,148204-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
statement.setString(1, data);
statement.executeUpdate();
",good
3638,146386-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_52b()).badSink(data );
",bad
3639,146386-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    try {
        if (preparedStatement != null) {
            preparedStatement.close();
        }
    } catch (SQLException e) {
        // handle exception
    }
}
",good
3640,147810-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3641,147810-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3642,147810-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3643,147810-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3644,147810-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3645,147810-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
3646,148002-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3647,148002-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, validateInput(names[i]));
",good
3648,148002-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3649,148002-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3650,148002-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3651,148002-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
3652,147292-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3653,147292-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3654,147292-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3655,147292-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3656,147292-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3657,146259-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3658,146259-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3659,146259-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3660,146259-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3661,146259-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3662,146259-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3663,146340-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3664,146340-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3665,147444-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3666,147444-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add this line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
3667,147444-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3668,147444-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3669,147444-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3670,147444-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3671,146374-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3672,146374-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3673,146374-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3674,146374-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3675,146374-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
3676,146895-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3677,146895-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3678,146621-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3679,146621-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3680,147091-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3681,147091-v1.0.0,good,"// Validate and sanitize the cookie value before using it
String data = """";
Cookie cookieSources[] = request.getCookies();
if (cookieSources != null) {
    for (Cookie cookie : cookieSources) {
        if (""safe_cookie_name"".equals(cookie.getName())) {
            data = sanitizeInput(cookie.getValue());
            break;
        }
    }
}
",good
3682,147377-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3683,147377-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3684,147857-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3685,147857-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3686,146853-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3687,146853-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3688,146853-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3689,146853-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3690,146853-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3691,146853-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped or parameterized to prevent SQL injection
",good
3692,147469-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_74b()).badSink(dataHashMap , request, response );
",bad
3693,147260-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3694,147260-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3695,147260-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
3696,147260-v1.0.0,java,"data = request.getParameter(""name"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3697,147260-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, sanitizeInput(names[i]));
    sqlStatement.addBatch();
}
",good
3698,147941-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_53b()).badSink(data);
",bad
3699,148301-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3700,148301-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3701,147059-v1.0.0,java,"(new CWE89_SQL_Injection__File_prepareStatement_71b()).badSink((Object)data);
",bad
3702,147582-v1.0.0,java,"data = token.substring(3);
",bad
3703,147582-v1.0.0,good,"data = java.net.URLDecoder.decode(token.substring(3), ""UTF-8"");
",good
3704,146187-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3705,146187-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3706,146187-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
3707,146187-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3708,146187-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""'"", ""''""));
",good
3709,147618-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_75b()).badSink(dataSerialized , request, response );
",bad
3710,147618-v1.0.0,good,"String data = request.getParameter(""id"");
if (data != null) {
    try {
        ByteArrayOutputStream streamByteArrayOutput = new ByteArrayOutputStream();
        ObjectOutput outputObject = new ObjectOutputStream(streamByteArrayOutput);
        outputObject.writeObject(data);
        byte[] dataSerialized = streamByteArrayOutput.toByteArray();
        (new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_75b()).badSink(dataSerialized , request, response );
    } catch (IOException exceptIO) {
        IO.logger.log(Level.WARNING, ""IOException in serialization"", exceptIO);
    } finally {
        // clean up stream writing objects
        // ...
    }
}
",good
3711,147249-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3712,147249-v1.0.0,good,"String data = """";
Cookie cookieSources[] = request.getCookies();
if (cookieSources != null) {
    data = cookieSources[0].getValue();
}

CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_81_base baseObject = new CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_81_bad();
Connection conn = /* obtain database connection */;
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
// use result set
",good
3713,146948-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_71b()).badSink((Object)data);
",bad
3714,146948-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
3715,147898-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3716,147898-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3717,147957-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3718,147957-v1.0.0,good,"// Validate and sanitize the data before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
3719,147957-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3720,147957-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3721,147957-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3722,147957-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3723,147004-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3724,147004-v1.0.0,good,"// Ensure data is sanitized or validated before using it in the SQL query
// For example, using a whitelist of allowed characters or using a library that automatically escapes input
String sanitizedData = sanitizeInput(data);
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizedData);
",good
3725,147004-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3726,147004-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3727,147004-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3728,146512-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3729,146512-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3730,146512-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3731,146512-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3732,146512-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3733,146512-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3734,147665-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3735,147665-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3736,147665-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3737,147665-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3738,147665-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3739,147665-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3740,147776-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3741,147776-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3742,147776-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3743,147776-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3744,147776-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3745,147776-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3746,148305-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3747,148305-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3748,148310-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_52b()).badSink(data );
",bad
3749,147709-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3750,147709-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3751,148354-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_71b()).badSink((Object)data);
",bad
3752,147374-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3753,147374-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3754,147374-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3755,147374-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3756,147374-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3757,147374-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3758,148174-v1.0.0,java,"baseObject.action(data);
",bad
3759,146797-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_66b()).badSink(dataArray);
",bad
3760,148030-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3761,148030-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Add this line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
3762,148030-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3763,148030-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3764,148030-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3765,148275-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_54b()).badSink(data );
",bad
3766,146338-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3767,146338-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3768,146338-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3769,146338-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3770,146338-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3771,146338-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3772,146204-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3773,146204-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
3774,146303-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3775,146303-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowsAffected = preparedStatement.executeUpdate();
    if(rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources
}
",good
3776,140886-v1.0.0,java,"data = request.getParameter(""id"");
id = Integer.parseInt(data);
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
3777,140886-v1.0.0,good,"try {
    id = Integer.parseInt(data);
} catch (NumberFormatException nfx) {
    // Handle invalid input, e.g., log an error or return an error response
    return;
}

// The rest of the code remains the same
",good
3778,147629-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3779,147629-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3780,147629-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3781,147629-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3782,147629-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3783,147629-v1.0.0,good,"String id = request.getParameter(""id"");
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, id);
",good
3784,146629-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3785,146629-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, java.sql.PreparedStatement.escapeString(data));
",good
3786,146629-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3787,146629-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3788,146629-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3789,146629-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3790,146192-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3791,146192-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
3792,148296-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3793,148296-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
// This could involve checking for any suspicious characters or patterns and escaping them
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
3794,148296-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3795,148296-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
3796,148296-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3797,148296-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add sanitization or escaping for the data variable here
",good
3798,147934-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_22b()).goodB2G2Sink(data);
",bad
3799,147934-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_22b()).badSink(data);
",bad
3800,147934-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_22b()).goodB2G1Sink(data );
",bad
3801,147968-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3802,147968-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3803,146293-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3804,146293-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3805,146293-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3806,146293-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3807,146293-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3808,146293-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3809,146222-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3810,146222-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3811,146222-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3812,146222-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
3813,146222-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3814,146222-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3815,147846-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3816,147846-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
3817,147846-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3818,147846-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
3819,147846-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3820,147846-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3821,147579-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeBatch_73b()).badSink(dataLinkedList , request, response );
",bad
3822,146625-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3823,146625-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3824,146625-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3825,146625-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3826,146625-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3827,146625-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3828,148169-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_71b()).badSink((Object)data);
",bad
3829,140881-v1.0.0,java,"data = request.getParameter(""id"");
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
3830,140881-v1.0.0,good,"data = request.getParameter(""id"");
if (data != null && data.matches(""\\d+"")) {
    id = Integer.parseInt(data);
    preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
    preparedStatement.setInt(1, id);
} else {
    // Handle invalid input
}
",good
3831,148055-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeQuery_66b()).badSink(dataArray);
",bad
3832,148055-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
3833,146975-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3834,146975-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
// rest of the code...
",good
3835,147593-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens()) {
    String token = tokenizer.nextToken();
    if(token.startsWith(""id="")) {
        data = token.substring(3);
        break;
    }
}
",bad
3836,147593-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
3837,147593-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3838,147593-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3839,147593-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
3840,147593-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
3841,147842-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3842,147842-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
3843,146554-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3844,146554-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3845,146554-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3846,146554-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
3847,146554-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3848,146554-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3849,146812-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3850,146812-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));

// Add a method to sanitize input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, whitelisting allowed characters, etc.
    // For example, using a library like OWASP's ESAPI to escape SQL characters
    return ESAPI.encoder().encodeForSQL(input);
}
",good
3851,146812-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3852,146812-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3853,146812-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3854,146812-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3855,147502-v1.0.0,java,"data = request.getParameter(""name"");
",bad
3856,147502-v1.0.0,good,"String name = request.getParameter(""name"");
// Validate and sanitize the input
name = sanitizeInput(name);
// Use parameterized query or prepared statement
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
3857,147983-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_68b()).badSink();
",bad
3858,146983-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_67b()).badSink(dataContainer);
",bad
3859,147500-v1.0.0,java,"data = request.getParameter(""name"");
dataArray[2] = data;
(new CWE89_SQL_Injection__getParameter_Servlet_execute_66b()).badSink(dataArray , request, response );
",bad
3860,147781-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3861,147781-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3862,147781-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3863,147781-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3864,147781-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3865,147517-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3866,147517-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3867,147517-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3868,147517-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3869,147517-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3870,146300-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3871,146300-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3872,146300-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3873,146300-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
3874,146300-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3875,146300-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3876,147714-v1.0.0,java,"badSink(data , request, response );
",bad
3877,147714-v1.0.0,good,"PreparedStatement stmt = con.prepareStatement(""SELECT * FROM table WHERE id = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
3878,147583-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3879,147583-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
3880,148144-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3881,148144-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3882,148144-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3883,148144-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3884,148144-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3885,148144-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3886,147852-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3887,147852-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3888,147852-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3889,147852-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
3890,147852-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3891,147852-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3892,146346-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3893,146346-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3894,147977-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_52b()).badSink(data );
",bad
3895,148034-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3896,148034-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3897,148034-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3898,148034-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3899,148034-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3900,148236-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_52b()).badSink(data );
",bad
3901,146640-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3902,146640-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3903,148093-v1.0.0,java,"(new CWE89_SQL_Injection__Property_executeUpdate_67b()).badSink(dataContainer);
",bad
3904,148093-v1.0.0,good,"String data = System.getProperty(""user.home"");
String query = ""INSERT INTO table (column) VALUES (?)"";
try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    pstmt.executeUpdate();
}
",good
3905,147094-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
3906,147094-v1.0.0,good,"// Validate and sanitize the cookie value before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
data = sanitizedData;
",good
3907,147468-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeUpdate_73b()).badSink(dataLinkedList , request, response );
",bad
3908,146141-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3909,146141-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
3910,146141-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3911,146141-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
3912,146141-v1.0.0,java,"String data = System.getenv(""ADD"");
String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3913,146141-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
3914,146708-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
3915,146708-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",good
3916,146708-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3917,146708-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3918,146708-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3919,146708-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3920,146594-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
3921,146594-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
",good
3922,146594-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3923,146594-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3924,146594-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3925,146594-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
3926,147476-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3927,147476-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3928,147476-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3929,147476-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3930,147123-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3931,147123-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3932,146504-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_71b()).badSink((Object)data);
",bad
3933,147322-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_75b()).badSink(dataSerialized , request, response );
",bad
3934,147655-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_75b()).badSink(dataSerialized , request, response );
",bad
3935,146549-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
3936,146549-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
resultSet = preparedStatement.executeQuery();
",good
3937,146549-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3938,146549-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
3939,146549-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
3940,146549-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
3941,147657-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3942,147657-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
3943,148173-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_75b()).badSink(dataSerialized);
",bad
3944,146156-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3945,146156-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
3946,146827-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3947,146827-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
3948,147352-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeBatch_66b()).badSink(dataArray);
",bad
3949,147352-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
3950,147436-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3951,147436-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3952,147436-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
3953,147436-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3954,147436-v1.0.0,good,"// Validate and sanitize the user input
String name = validateAndSanitize(request.getParameter(""name""));

// Use the sanitized input in the prepared statement
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, name);
",good
3955,148278-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_67b()).badSink(dataContainer);
",bad
3956,148278-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
3957,146740-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3958,146740-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3959,146740-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3960,146740-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3961,147925-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3962,147925-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3963,147925-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3964,147925-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
3965,147925-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3966,147925-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3967,147100-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_executeBatch_75b()).badSink(dataSerialized , request, response );
",bad
3968,147262-v1.0.0,java,"data = request.getParameter(""name"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3969,147262-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
3970,147262-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3971,147262-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
3972,147262-v1.0.0,java,"data = request.getParameter(""name"");
String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
3973,147262-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
3974,147773-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3975,147773-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before inserting into the query
",good
3976,147773-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3977,147773-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3978,147773-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3979,147773-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
3980,146742-v1.0.0,java,"data = System.getenv(""ADD"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3981,146742-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3982,146742-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
3983,146742-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
3984,146742-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
3985,146742-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
3986,147821-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3987,147821-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
3988,146323-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_75b()).badSink(dataSerialized);
",bad
3989,147731-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
3990,147731-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
3991,146329-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3992,146329-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3993,146329-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
3994,146329-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
3995,146329-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3996,146329-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3997,147961-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
3998,147961-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
3999,147961-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4000,147961-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4001,147961-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4002,147961-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4003,147503-v1.0.0,java,"data = request.getParameter(""name"");
(new CWE89_SQL_Injection__getParameter_Servlet_execute_71b()).badSink((Object)data , request, response );
",bad
4004,147503-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
",good
4005,146390-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__console_readLine_executeBatch_66b()).badSink(dataArray);
",bad
4006,146390-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table_name (column_name) VALUES (?)"");
statement.setString(1, data);
statement.executeUpdate();
",good
4007,146657-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4008,146657-v1.0.0,good,"String id = ""0""; // Assume this value is coming from a safe source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
4009,146961-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4010,146961-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4011,146961-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4012,146961-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4013,146961-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4014,147800-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_72b()).badSink(dataVector);
",bad
4015,147800-v1.0.0,good,"PreparedStatement preparedStatement = null;
Connection connection = null;

try {
    connection = /* obtain database connection */;
    String sql = ""INSERT INTO table (column) VALUES (?)"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
4016,146995-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4017,146995-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4018,146995-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4019,146995-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
4020,146995-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4021,146995-v1.0.0,good,"// Validate input
if (!isValidInput(data)) {
    throw new IllegalArgumentException(""Invalid input"");
}

// Prepare statement
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4022,147515-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4023,147515-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status='updated' where name=?"");
",good
4024,147515-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4025,147515-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4026,147515-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4027,147515-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4028,140910-v1.0.0,java,"data = request.getParameter(""id"");
",bad
4029,140910-v1.0.0,good,"String id = request.getParameter(""id"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE id = ?"");
stmt.setString(1, id);
ResultSet rs = stmt.executeQuery();
",good
4030,146824-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_22b()).goodB2G2Sink(data);
",bad
4031,146824-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
4032,146824-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_22b()).badSink(data);
",bad
4033,146824-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_22b()).goodB2G1Sink(data );
",bad
4034,146824-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
4035,146696-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4036,146696-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4037,146696-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4038,146696-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4039,146696-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4040,146696-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4041,146364-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4042,146364-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
4043,146364-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4044,146364-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4045,146364-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4046,146364-v1.0.0,good,"for (int i = 0; i < names.length; i++) {
    String name = names[i].replaceAll(""[^a-zA-Z0-9_-]"", """"); // Remove any characters that are not alphanumeric, underscore, or hyphen
    sqlStatement.setString(1, name);
    sqlStatement.addBatch();
}
",good
4047,146387-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeBatch_53b()).badSink(data );
",bad
4048,148185-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4049,148185-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4050,148185-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4051,148185-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4052,146802-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeUpdate_73b()).badSink(dataLinkedList);
",bad
4053,146802-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
statement.setString(1, data);
statement.executeUpdate();
",good
4054,146411-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4055,146411-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4056,146411-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4057,146411-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4058,146411-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4059,146411-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change the above line to
sqlStatement.setString(1, sanitizeInput(data));
",good
4060,147873-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_71b()).badSink((Object)data);
",bad
4061,147873-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
4062,147020-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_67b()).badSink(dataContainer);
",bad
4063,147479-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4064,147479-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4065,147479-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4066,147479-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4067,147479-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4068,147479-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""UPDATE users SET status = 'updated' WHERE name = ?"");
",good
4069,146475-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4070,146475-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4071,146475-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4072,146475-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4073,146475-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4074,146475-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4075,146710-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4076,146710-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4077,148037-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4078,148037-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Add the following line to sanitize the input
data = data.replaceAll(""[';\\-]"", """");
",good
4079,148037-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4080,148037-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
4081,148037-v1.0.0,java,"data = System.getProperty(""user.home"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4082,148037-v1.0.0,good,"String data = System.getProperty(""user.home"");
data = data.replaceAll(""[^a-zA-Z0-9]"", """"); // Remove non-alphanumeric characters
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4083,147793-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_53b()).badSink(data);
",bad
4084,146426-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4085,146426-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4086,146414-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4087,146414-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4088,147089-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
4089,147089-v1.0.0,good,"// Validate and sanitize the cookie value
String value = cookieSources[0].getValue();
if (isValid(value)) {
    data = sanitize(value);
}
",good
4090,146663-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4091,146663-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4092,146663-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4093,146663-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
4094,146663-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4095,146663-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4096,140890-v1.0.0,java,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
4097,140890-v1.0.0,good,"preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",good
4098,146693-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4099,146693-v1.0.0,good,"String id = ""0""; // This should be replaced with a user input that is properly sanitized
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
4100,147554-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement.setString(1, names[i]);
",bad
4101,147554-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, sanitizeInput(names[i]));
    sqlStatement.addBatch();
}
",good
4102,147554-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4103,147554-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4104,147554-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4105,146202-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_53b()).badSink(data );
",bad
4106,146202-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
4107,147189-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4108,147189-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4109,147189-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4110,147189-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4111,147189-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4112,147189-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to the following to prevent SQL injection
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that sanitizes the input to prevent SQL injection
",good
4113,148282-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_73b()).badSink(dataLinkedList);
",bad
4114,148064-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4115,148064-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);

    int rowCount = preparedStatement.executeUpdate();

    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
}
finally {
    // Close the preparedStatement and dbConnection as before
}
",good
4116,147757-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_54b()).badSink(data );
",bad
4117,147928-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4118,147928-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4119,147928-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4120,147928-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4121,147928-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4122,147928-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4123,147947-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_execute_71b()).badSink((Object)data);
",bad
4124,147947-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
4125,147964-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4126,147964-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4127,146783-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4128,146783-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4129,146783-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4130,146783-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4131,146783-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4132,146783-v1.0.0,good,"// Validate and sanitize the data before setting it into the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
4133,147741-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4134,147741-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""'"", ""''""));
",good
4135,147741-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4136,147741-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
4137,147741-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4138,148286-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4139,148286-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4140,146205-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__connect_tcp_executeBatch_66b()).badSink(dataArray);
",bad
4141,146697-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4142,146697-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4143,146697-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4144,146697-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4145,146697-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4146,146697-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4147,147599-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4148,147599-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4149,147311-v1.0.0,java,"data = request.getParameter(""name"");
",bad
4150,147311-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4151,147177-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4152,147177-v1.0.0,good,"String sanitizedData = data.replace(""'"", ""''"");
sqlStatement.setString(1, sanitizedData);
",good
4153,147177-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4154,147177-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4155,147177-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4156,147177-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4157,147505-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_execute_73b()).badSink(dataLinkedList , request, response );
",bad
4158,147505-v1.0.0,good,"Connection conn = ... // obtain a database connection
String sql = ""INSERT INTO my_table (column1, column2) VALUES (?, ?)"";
PreparedStatement stmt = conn.prepareStatement(sql);
stmt.setString(1, dataLinkedList.get(0));
stmt.setString(2, dataLinkedList.get(1));
stmt.executeUpdate();
",good
4159,146735-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4160,146735-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4161,146735-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4162,146735-v1.0.0,java,"data = System.getenv(""ADD"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4163,146552-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4164,146552-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
4165,146552-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4166,146552-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
4167,146552-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4168,146552-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
4169,148231-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4170,148231-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4171,146558-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4172,146558-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
sqlStatement.addBatch();
",good
4173,146531-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4174,146531-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4175,146876-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_73b()).badSink(dataLinkedList);
",bad
4176,147730-v1.0.0,java,"data = token.substring(3);
",bad
4177,147730-v1.0.0,good,"data = request.getParameter(""id"");
",good
4178,146289-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4179,146289-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4180,146289-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4181,146289-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4182,146289-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4183,146289-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4184,148312-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_54b()).badSink(data );
",bad
4185,148312-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
4186,147398-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4187,147398-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4188,147565-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4189,147565-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4190,147615-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_72b()).badSink(dataVector , request, response );
",bad
4191,147615-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE id = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4192,146415-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4193,146415-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4194,147397-v1.0.0,java,"data = properties.getProperty(""data"");
...
baseObject.action(data );
",bad
4195,147397-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
4196,147829-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_52b()).badSink(data );
",bad
4197,147806-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4198,147806-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4199,147806-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4200,147806-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4201,147806-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4202,147806-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data); // No changes needed here as it's already using parameterized query
",good
4203,147837-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_72b()).badSink(dataVector);
",bad
4204,147220-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4205,147220-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4206,147220-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4207,147220-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4208,147220-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4209,147220-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add this line to prevent SQL injection
data = data.replace(""'"", ""''"");
",good
4210,148351-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__URLConnection_prepareStatement_66b()).badSink(dataArray);
",bad
4211,146290-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4212,146290-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4213,146290-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4214,146290-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4215,146290-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4216,146290-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4217,147197-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4218,147197-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4219,146650-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4220,146650-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
4221,146835-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_67b()).badSink(dataContainer);
",bad
4222,146835-v1.0.0,good,"PreparedStatement ps = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
ps.setString(1, data);
ps.executeUpdate();
",good
4223,148172-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_74b()).badSink(dataHashMap);
",bad
4224,146371-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4225,146371-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
4226,146371-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4227,146371-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
4228,146371-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4229,147497-v1.0.0,java,"data = request.getParameter(""name"");
",bad
4230,147497-v1.0.0,good,"String name = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, name);
ResultSet rs = stmt.executeQuery();
",good
4231,148004-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
4232,148004-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4233,148004-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4234,148004-v1.0.0,java,"String names[] = data.split(""-"");
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",bad
4235,148004-v1.0.0,good,"// Use a PreparedStatement with placeholders to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++)
{
    // Escape special characters in the name to prevent SQL injection
    sqlStatement.setString(1, escapeSpecialCharacters(names[i]));
    sqlStatement.addBatch();
}

// Method to escape special characters in a string
private static String escapeSpecialCharacters(String input) {
    if (input == null) {
        return null;
    }
    return input.replace(""'"", ""''"");
}
",good
4236,148161-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_51b()).badSink(data);
",bad
4237,146508-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_75b()).badSink(dataSerialized);
",bad
4238,147481-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4239,147481-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set status = 'updated' where name = ?"");
",good
4240,147481-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4241,147481-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4242,147481-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4243,148105-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4244,148105-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4245,148105-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4246,148105-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
4247,148105-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4248,148105-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4249,147224-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4250,147224-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4251,148251-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4252,148251-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4253,148251-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4254,148251-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4255,148251-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4256,148251-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4257,147843-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4258,147843-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4259,147843-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4260,147843-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowsAffected = preparedStatement.executeUpdate();
    if(rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    try {
        if (preparedStatement != null) {
            preparedStatement.close();
        }
    } catch (SQLException exceptSql) {
        IO.logger.log(Level.WARNING, ""Error closing PreparedStatement"", exceptSql);
    }

    try {
        if (dbConnection != null) {
            dbConnection.close();
        }
    } catch (SQLException exceptSql) {
        IO.logger.log(Level.WARNING, ""Error closing Connection"", exceptSql);
    }
}
",good
4261,147843-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4262,147843-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4263,147812-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4264,147812-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4265,147812-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4266,147812-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4267,147812-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4268,147812-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4269,147611-v1.0.0,java,"dataArray[2] = data;
(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_66b()).badSink(dataArray , request, response );
",bad
4270,147611-v1.0.0,good,"String query = ""SELECT * FROM table WHERE id = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
4271,146631-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4272,146631-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4273,146631-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4274,146631-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4275,146631-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4276,146631-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4277,146825-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4278,146825-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4279,148203-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeBatch_66b()).badSink(dataArray);
",bad
4280,147173-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
4281,147173-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
4282,147200-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
4283,147200-v1.0.0,good,"// Validate and sanitize the cookie value before using it in a SQL query
String data = """";
Cookie cookieSources[] = request.getCookies();
if (cookieSources != null) {
    for (Cookie cookie : cookieSources) {
        if (cookie.getName().equals(""expectedCookieName"")) {
            data = sanitizeInput(cookie.getValue());
            break;
        }
    }
}
",good
4284,146659-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4285,146659-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4286,146659-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4287,146659-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
4288,146659-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4289,146659-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4290,146904-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_52b()).badSink(data );
",bad
4291,146904-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
preparedStatement.setString(1, data);
preparedStatement.executeUpdate();
",good
4292,147413-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4293,147413-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4294,146541-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_71b()).badSink((Object)data);
",bad
4295,146292-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4296,146292-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
if (rowsAffected > 0) {
    IO.writeLine(""Name, "" + data + "", updated successfully"");
} else {
    IO.writeLine(""Unable to update records for user: "" + data);
}
",good
4297,146292-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4298,146292-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4299,146292-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4300,146292-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is sanitized or validated before using it in the query
",good
4301,146226-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4302,146226-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4303,146226-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4304,146226-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4305,146226-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4306,146226-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4307,147412-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4308,147412-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4309,147412-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4310,147412-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4311,147412-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4312,147412-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4313,147438-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4314,147438-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4315,147438-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4316,147438-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4317,147438-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4318,148113-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4319,148113-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4320,148113-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4321,148113-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4322,148113-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4323,148113-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4324,147932-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4325,147932-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4326,147768-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4327,147768-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4328,147638-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_22b()).goodB2G2Sink(data , request, response);
",bad
4329,147638-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
4330,147638-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeUpdate_22b()).badSink(data , request, response);
",bad
4331,147638-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE id = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
4332,147638-v1.0.0,java,"String data = token.substring(3);
",bad
4333,147638-v1.0.0,good,"String data = request.getParameter(""id"");
",good
4334,147373-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4335,147373-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4336,147373-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4337,147373-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4338,147373-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4339,147373-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4340,148138-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4341,148138-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4342,147291-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4343,147291-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4344,147291-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4345,147291-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4346,147291-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
4347,147291-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4348,146509-v1.0.0,java,"baseObject.action(data);
",bad
4349,147606-v1.0.0,java,"(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_51b()).badSink(data , request, response );
",bad
4350,147606-v1.0.0,good,"String data = request.getParameter(""id"");
if (data == null) {
    data = """";
}
(new CWE89_SQL_Injection__getQueryString_Servlet_executeQuery_51b()).badSink(data , request, response );
",good
4351,147323-v1.0.0,java,"data = request.getParameter(""name"");
baseObject.action(data , request, response);
",bad
4352,147323-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4353,146579-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4354,146579-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, userId);
",good
4355,146359-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_74b()).badSink(dataHashMap);
",bad
4356,146894-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4357,146894-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
4358,146894-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4359,146894-v1.0.0,good,"String query = ""update users set hitcount=hitcount+1 where name=?"";
PreparedStatement preparedStatement = dbConnection.prepareStatement(query);
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4360,146894-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4361,146792-v1.0.0,java,"data = System.getenv(""ADD"");
(new CWE89_SQL_Injection__Environment_executeUpdate_51b()).badSink(data);
",bad
4362,146792-v1.0.0,good,"String data = System.getenv(""ADD"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4363,147620-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4364,147620-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4365,147369-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4366,147369-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4367,147369-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4368,147369-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4369,147369-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4370,146453-v1.0.0,java,"goodB2G1Sink(data);
",bad
4371,146453-v1.0.0,good,"PreparedStatement preparedStatement = null;
String query = ""SELECT * FROM table WHERE column = ?"";
try {
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // Process result set
} catch (SQLException e) {
    // Handle exception
} finally {
    // Close resources
}
",good
4372,146262-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4373,146262-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
4374,147519-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4375,147519-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4376,147519-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4377,147519-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4378,147519-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4379,147519-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4380,146755-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeQuery_51b()).badSink(data);
",bad
4381,146755-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4382,146893-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4383,146893-v1.0.0,good,"sqlStatement.setString(1, escapeSpecialCharacters(names[i]));
",good
4384,146893-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4385,146893-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
4386,146893-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4387,147489-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response);
",bad
4388,147489-v1.0.0,good,"String name = request.getParameter(""name"");
String sql = ""SELECT * FROM users WHERE name = ?"";
PreparedStatement statement = connection.prepareStatement(sql);
statement.setString(1, name);
ResultSet resultSet = statement.executeQuery();
",good
4389,147489-v1.0.0,java,"goodB2G1Sink(data , request, response);
",bad
4390,148003-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4391,148003-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4392,148003-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4393,148003-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
4394,148003-v1.0.0,good,"try {
    dbConnection = IO.getDBConnection();
    for (int i = 0; i < names.length; i++) {
        sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
        sqlStatement.setString(1, names[i]);
        sqlStatement.executeUpdate();
    }
    // ...
} catch (SQLException exceptSql) {
    // ...
}
",good
4395,147035-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4396,147035-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4397,147035-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4398,147035-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4399,147035-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput is a function that properly escapes the input to prevent SQL injection.
",good
4400,147460-v1.0.0,java,"data = request.getParameter(""name"");
",bad
4401,147460-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
4402,148230-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_22b()).goodB2G2Sink(data );
",bad
4403,148230-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeQuery_22b()).badSink(data );
",bad
4404,148230-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
4405,147219-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4406,147219-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
",good
4407,147219-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4408,147219-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4409,147219-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4410,147219-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4411,147296-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4412,147296-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4413,147296-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4414,147296-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4415,147296-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4416,147296-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4417,146511-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4418,146511-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4419,146511-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4420,146511-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4421,146511-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4422,146511-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4423,146197-v1.0.0,java,"data = readerBuffered.readLine();
badSink(data);
",bad
4424,146254-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4425,146254-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4426,146254-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4427,146254-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4428,146254-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4429,148031-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4430,148031-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4431,148031-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4432,148031-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4433,148031-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4434,146711-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4435,146711-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4436,147613-v1.0.0,java,"data = token.substring(3);
",bad
4437,147613-v1.0.0,good,"data = token.substring(3).replaceAll(""'"", ""''"");
",good
4438,147417-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4439,147417-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4440,146347-v1.0.0,java,"data = readerBuffered.readLine();
",bad
4441,147670-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4442,147670-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4443,147670-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4444,147670-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4445,147670-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4446,147670-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4447,146423-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_52b()).badSink(data );
",bad
4448,146400-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4449,146400-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4450,146400-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4451,146400-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4452,146400-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
4453,146189-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4454,146189-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
4455,146189-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4456,146189-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
preparedStatement.setString(1, names[i]);
sqlStatement.addBatch(preparedStatement);
",good
4457,146189-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4458,146653-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4459,146653-v1.0.0,good,"String id = ""0""; // This should be replaced with user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
4460,147450-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4461,147450-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""UPDATE users SET status = ? WHERE name = ?"");
    preparedStatement.setString(1, ""updated"");
    preparedStatement.setString(2, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
}
catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
}
finally {
    // Close resources...
}
",good
4462,146454-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_22b()).goodB2G2Sink(data );
",bad
4463,146454-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
4464,146454-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_22b()).badSink(data );
",bad
4465,146454-v1.0.0,good,"import org.owasp.html.HtmlPolicyBuilder;
import org.owasp.html.PolicyFactory;
import org.owasp.html.Sanitizers;

// ...

String data = null;

// ...

data = readerBuffered.readLine();

// Sanitize the input using OWASP's Java HTML Sanitizer
PolicyFactory policy = new HtmlPolicyBuilder().toFactory();
data = policy.sanitize(data);

// ...

(new CWE89_SQL_Injection__console_readLine_executeUpdate_22b()).badSink(data);
",good
4466,146454-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeUpdate_22b()).goodB2G1Sink(data);
",bad
4467,146454-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
4468,146140-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4469,146140-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
4470,146632-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4471,146632-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowCount = sqlStatement.executeUpdate();
",good
4472,147190-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4473,147190-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4474,147190-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4475,147190-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4476,147190-v1.0.0,good,"// Validate and sanitize the data variable before using it in the SQL statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
4477,147996-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4478,147996-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4479,147996-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4480,147996-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
4481,147996-v1.0.0,good,"// Use a whitelist or a proper sanitization method to validate the input
String[] validNames = validateInput(data.split(""-""));
...
sqlStatement.setString(1, validNames[i]);
",good
4482,146213-v1.0.0,java,"baseObject.action(data );
",bad
4483,146213-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
4484,146911-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeBatch_71b()).badSink((Object)data);
",bad
4485,148215-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4486,148215-v1.0.0,good,"sqlStatement.setString(1, java.sql.DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""user"", ""password"").prepareStatement(""select * from users where name=?"").escapeSqlPattern(data));
",good
4487,148215-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4488,148215-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4489,148215-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4490,148215-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
4491,147154-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4492,147154-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4493,148178-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4494,148178-v1.0.0,good,"String pattern = ""[^a-zA-Z0-9_-]"";
String sanitizedName = names[i].replaceAll(pattern, """");
sqlStatement.setString(1, sanitizedName);
",good
4495,148178-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4496,148178-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
4497,148178-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4498,148178-v1.0.0,good,"String sanitizedName = sanitizeInput(names[i]);
sqlStatement.setString(1, sanitizedName);
",good
4499,148225-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4500,148225-v1.0.0,good,"// Use a PreparedStatement with a parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4501,148225-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4502,148225-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4503,148225-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4504,148225-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4505,147471-v1.0.0,java,"data = request.getParameter(""name"");
baseObject.action(data , request, response);
",bad
4506,147471-v1.0.0,good,"PreparedStatement pstmt = connection.prepareStatement(""SELECT * FROM table WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4507,147723-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_67b()).badSink(dataContainer , request, response );
",bad
4508,147723-v1.0.0,good,"// Use getParameter() to retrieve the id from the query string
String id = request.getParameter(""id"");

// Check if id is null or empty before using it
if (id != null && !id.isEmpty()) {
    Container dataContainer = new Container();
    dataContainer.containerOne = id;
    (new CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_67b()).badSink(dataContainer , request, response );
}
",good
4509,147275-v1.0.0,java,"data = request.getParameter(""name"");
",bad
4510,147275-v1.0.0,good,"String data = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4511,146584-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4512,146584-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4513,146680-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4514,146680-v1.0.0,good,"String id = getIdFromUserInput(); // Assume this function safely retrieves user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
4515,146679-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4516,146679-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowsAffected = preparedStatement.executeUpdate();
    if(rowsAffected > 0) {
        IO.writeLine(""Name, "" + data + "", updated successfully"");
    } else {
        IO.writeLine(""Unable to update records for user: "" + data);
    }
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close the preparedStatement and dbConnection here
}
",good
4517,146927-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4518,146927-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4519,146927-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4520,146927-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4521,146927-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4522,146927-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4523,146605-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4524,146605-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4525,147592-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
4526,147592-v1.0.0,good,"String id = request.getParameter(""id"");
data = id;
",good
4527,147592-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4528,147592-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
4529,147592-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken(); /* a token will be like ""id=foo"" */
    if(token.startsWith(""id="")) /* check if we have the ""id"" parameter"" */
    {
        data = token.substring(3); /* set data to ""foo"" */
        break; /* exit while loop */
    }
}
",bad
4530,147592-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
4531,146846-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4532,146846-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4533,146846-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4534,146846-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4535,146846-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4536,146846-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4537,147550-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4538,147550-v1.0.0,good,"String pattern = ""^[a-zA-Z0-9_]+$"";
if (names[i].matches(pattern)) {
    sqlStatement.setString(1, names[i]);
} else {
    // handle invalid input
}
",good
4539,147550-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4540,147550-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
4541,147550-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
4542,147550-v1.0.0,good,"// Validate and sanitize the input
String[] names = data.split(""-"");
for (int i = 0; i < names.length; i++) {
    names[i] = names[i].replaceAll(""[^a-zA-Z0-9_-]"", """"); // Remove any non-alphanumeric characters except underscore and hyphen
}
...
sqlStatement.setString(1, names[i]);
",good
4543,146520-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4544,146520-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4545,146520-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4546,146520-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4547,146520-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4548,146520-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4549,147294-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4550,147294-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4551,147294-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4552,147294-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4553,147294-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4554,147294-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before being used in the query.
// This can be done using a library or custom function to escape special characters.
",good
4555,147555-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4556,147555-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (String name : names) {
    sqlStatement.setString(1, sanitizeInput(name));
    sqlStatement.addBatch();
}
",good
4557,147555-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4558,147555-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4559,147555-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
4560,147555-v1.0.0,good,"for (int i = 0; i < names.length; i++) {
    sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
4561,148284-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_75b()).badSink(dataSerialized);
",bad
4562,146282-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_71b()).badSink((Object)data);
",bad
4563,146831-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_execute_53b()).badSink(data );
",bad
4564,146831-v1.0.0,good,"PreparedStatement stmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
stmt.setString(1, data);
ResultSet rs = stmt.executeQuery();
",good
4565,147584-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
4566,147584-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
4567,147584-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4568,147584-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4569,147584-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
4570,147584-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
} else {
    data = """";
}
",good
4571,147278-v1.0.0,java,"dataArray[2] = data;
(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_66b()).badSink(dataArray , request, response );
",bad
4572,147278-v1.0.0,good,"import org.owasp.html.HtmlPolicyBuilder;
import org.owasp.html.PolicyFactory;
import org.owasp.html.Sanitizers;

// Create a policy that allows only safe HTML tags and attributes
PolicyFactory policy = new HtmlPolicyBuilder().toFactory();

// Sanitize the input from request.getParameter(""name"")
String data = policy.sanitize(request.getParameter(""name""));

String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__getParameter_Servlet_executeBatch_66b()).badSink(dataArray , request, response );
",good
4573,146337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4574,146337-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data); // Change this line to
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
4575,146337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4576,146337-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4577,146337-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4578,146337-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4579,146413-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4580,146413-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4581,146413-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4582,146413-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4583,146413-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4584,146413-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4585,147548-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4586,147548-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    String name = names[i].replaceAll(""[';\\-]"", """"); // Remove any single quotes, semicolons, or hyphens
    sqlStatement.setString(1, name);
    sqlStatement.addBatch();
}
",good
4587,147548-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4588,147548-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4589,147548-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4590,147175-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
4591,147175-v1.0.0,good,"if (cookieSources != null && cookieSources.length > 0) {
    data = cookieSources[0].getValue();
    // Validate and sanitize data before using it in a SQL query
    // ...
}
",good
4592,147081-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4593,147081-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4594,147866-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_execute_52b()).badSink(data );
",bad
4595,147866-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""SELECT * FROM table WHERE column = ?"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
} finally {
    // close resources
}
",good
4596,147204-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
4597,147204-v1.0.0,good,"import java.sql.PreparedStatement;
import java.sql.SQLException;

// ...

PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4598,146274-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_51b()).badSink(data);
",bad
4599,146274-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
4600,147014-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_51b()).badSink(data);
",bad
4601,146409-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4602,146409-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4603,146409-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4604,146409-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4605,147437-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4606,147437-v1.0.0,good,"// Use a PreparedStatement to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4607,147437-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4608,147437-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4609,147437-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4610,147437-v1.0.0,good,"// Add input validation to ensure that the data variable only contains safe characters
String pattern = ""^[a-zA-Z0-9_]+$"";
if (!data.matches(pattern)) {
    // Handle invalid input
    // For example, return an error message to the user
    return;
}

// Use the validated data variable in the SQL statement
sqlStatement.setString(1, data);
",good
4611,147836-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeUpdate_71b()).badSink((Object)data);
",bad
4612,147108-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4613,147108-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped to prevent SQL injection
data = java.sql.DriverManager.getConnection(url, username, password).prepareStatement("""").quote(data);
sqlStatement.setString(1, data);
",good
4614,147108-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4615,147108-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4616,147108-v1.0.0,java,"data = cookieSources[0].getValue();
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4617,147108-v1.0.0,good,"// Use PreparedStatement with parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));

// Add a method to sanitize input
private String sanitizeInput(String input) {
    // Implement input sanitization logic here
    // This could include escaping special characters, whitelisting allowed characters, etc.
    // For example, using a library like OWASP's ESAPI can help with this
}
",good
4618,146223-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4619,146223-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4620,146223-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4621,146223-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4622,146223-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4623,146223-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped or parameterized to prevent SQL injection
",good
4624,147732-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4625,147732-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4626,147732-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
4627,147732-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4628,148134-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_73b()).badSink(dataLinkedList);
",bad
4629,148134-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table_name (column_name) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
4630,147019-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_66b()).badSink(dataArray);
",bad
4631,147988-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_75b()).badSink(dataSerialized);
",bad
4632,147988-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
statement.setString(1, new String(dataSerialized, StandardCharsets.UTF_8));
statement.executeUpdate();
",good
4633,146777-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4634,146777-v1.0.0,good,"sqlStatement.setString(1, data);
",good
4635,146777-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4636,146777-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4637,146777-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4638,146777-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4639,147761-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_68b()).badSink();
",bad
4640,147571-v1.0.0,java,"data = token.substring(3);
",bad
4641,147571-v1.0.0,good,"data = request.getParameter(""id"");
",good
4642,147295-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4643,147295-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4644,147295-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4645,147295-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4646,147295-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4647,146428-v1.0.0,java,"dataContainer.containerOne = data;
(new CWE89_SQL_Injection__console_readLine_executeQuery_67b()).badSink(dataContainer);
",bad
4648,147662-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4649,147662-v1.0.0,good,"// Use a whitelist or blacklist to validate the 'data' variable before using it in the SQL statement.
// For example, you could use a regular expression to ensure that 'data' only contains alphanumeric characters.
Pattern pattern = Pattern.compile(""^[a-zA-Z0-9]+$"");
Matcher matcher = pattern.matcher(data);
if (!matcher.matches()) {
    throw new IllegalArgumentException(""Invalid data"");
}
sqlStatement.setString(1, data);
",good
4650,147662-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4651,147662-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4652,147662-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4653,147662-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4654,147784-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4655,147784-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4656,146182-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4657,146182-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4658,146182-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
4659,146182-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4660,146182-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
4661,147495-v1.0.0,java,"data = request.getParameter(""name"");
",bad
4662,147495-v1.0.0,good,"// Use PreparedStatement to prevent SQL injection
String name = request.getParameter(""name"");
PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, name);
ResultSet rs = pstmt.executeQuery();
",good
4663,147889-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4664,147889-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4665,147889-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4666,147889-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4667,147889-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4668,147889-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4669,147818-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4670,147818-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4671,147818-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4672,147818-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4673,147818-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4674,148346-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_51b()).badSink(data);
",bad
4675,148346-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
4676,146603-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4677,146603-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4678,147859-v1.0.0,java,"goodB2G2Sink(data);
",bad
4679,146336-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4680,146336-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4681,147205-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
4682,147205-v1.0.0,good,"// Use a loop to iterate through all cookies and validate/sanitize the data
for (Cookie cookie : cookieSources) {
    if (cookie.getName().equals(""expectedCookieName"")) {
        data = validateAndSanitize(cookie.getValue());
        break;
    }
}
",good
4683,147574-v1.0.0,java,"data = token.substring(3);
",bad
4684,147574-v1.0.0,good,"data = java.net.URLDecoder.decode(token.substring(3), ""UTF-8"");
",good
4685,147833-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__listen_tcp_executeUpdate_66b()).badSink(dataArray);
",bad
4686,147833-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""INSERT INTO table_name (column_name) VALUES (?)"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    // Close preparedStatement and connection
}
",good
4687,147017-v1.0.0,java,"(new CWE89_SQL_Injection__File_execute_54b()).badSink(data );
",bad
4688,147017-v1.0.0,good,"PreparedStatement preparedStatement = null;
Connection connection = null;

try {
    connection = DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""user"", ""password"");
    String sql = ""SELECT * FROM users WHERE username = ?"";
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, data);
    ResultSet resultSet = preparedStatement.executeQuery();
    // process result set
} catch (SQLException e) {
    e.printStackTrace();
} finally {
    // close resources
}
",good
4689,147752-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4690,147752-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    pstmt.setString(1, names[i]);
    pstmt.addBatch();
}
int resultsArray[] = pstmt.executeBatch();
",good
4691,147183-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4692,147183-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4693,147183-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4694,147183-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4695,147183-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4696,147183-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4697,147299-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4698,147299-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4699,147299-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4700,147299-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4701,147299-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4702,146146-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4703,146146-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4704,146146-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4705,146146-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4706,146238-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_52b()).badSink(data );
",bad
4707,146813-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4708,146813-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4709,146813-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4710,146813-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.executeUpdate() > 0;
",good
4711,146813-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4712,146813-v1.0.0,good,"// Validate and sanitize the data before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
4713,146391-v1.0.0,java,"data = readerBuffered.readLine();
(new CWE89_SQL_Injection__console_readLine_executeBatch_67b()).badSink(dataContainer);
",bad
4714,146391-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
preparedStatement.setString(1, data);
preparedStatement.executeUpdate();
",good
4715,148176-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4716,148176-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
4717,148176-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4718,148176-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
4719,148176-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4720,148176-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
4721,146229-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4722,146229-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4723,147647-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4724,147647-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4725,147722-v1.0.0,java,"data = token.substring(3);
",bad
4726,147722-v1.0.0,good,"data = URLDecoder.decode(token.substring(3), ""UTF-8"");
",good
4727,146528-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_22b()).goodB2G2Sink(data );
",bad
4728,146528-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_22b()).badSink(data);
",bad
4729,146528-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
4730,146528-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_22b()).goodB2G1Sink(data );
",bad
4731,146528-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
4732,146589-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
",bad
4733,146589-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
4734,146589-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4735,146589-v1.0.0,good,"preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4736,146589-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",bad
4737,146589-v1.0.0,good,"String query = ""select name from users where id=?"";
preparedStatement = connection.prepareStatement(query);
preparedStatement.setInt(1, userId);
resultSet = preparedStatement.executeQuery();
data = resultSet.getString(1);
",good
4738,147421-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeUpdate_51b()).badSink(data);
",bad
4739,146500-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4740,146500-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4741,146521-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4742,146521-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4743,147166-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4744,147166-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4745,146565-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4746,146565-v1.0.0,good,"String id = ""0""; // This should be a user-provided input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
4747,146565-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4748,146565-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
4749,146565-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4750,146565-v1.0.0,good,"String id = ""0""; // Assume this value is provided by user input
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
4751,148038-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4752,148038-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
resultSet = sqlStatement.executeQuery();
",good
4753,146873-v1.0.0,java,"data = System.getenv(""ADD"");
(new CWE89_SQL_Injection__Environment_prepareStatement_68b()).badSink();
",bad
4754,146873-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4755,147084-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4756,147084-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
4757,146785-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4758,146785-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4759,146404-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4760,146404-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4761,146404-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4762,146404-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4763,146404-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4764,147644-v1.0.0,java,"data = token.substring(3);
",bad
4765,147644-v1.0.0,good,"data = request.getParameter(""id"");
",good
4766,146175-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_executeBatch_75b()).badSink(dataSerialized);
",bad
4767,147333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4768,147333-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4769,147333-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
4770,147333-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4771,148355-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_prepareStatement_72b()).badSink(dataVector);
",bad
4772,147487-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4773,147487-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4774,147288-v1.0.0,java,"data = request.getParameter(""name"");
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4775,147288-v1.0.0,good,"String name = request.getParameter(""name"");
if (name != null && !name.isEmpty()) {
    // Validate and sanitize the user input here
    // ...
    sqlStatement.setString(1, name);
} else {
    // Handle invalid input
    // ...
}
",good
4776,147288-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4777,147288-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""select * from users where name=?"");
pstmt.setString(1, data);
resultSet = pstmt.executeQuery();
",good
4778,147288-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4779,147003-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4780,147003-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
int rowsAffected = sqlStatement.executeUpdate();
if (rowsAffected > 0) {
    IO.writeLine(""Name, "" + data + "", updated successfully"");
} else {
    IO.writeLine(""Unable to update records for user: "" + data);
}
",good
4781,147003-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4782,147003-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
4783,147003-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4784,147003-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4785,146311-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_execute_51b()).badSink(data);
",bad
4786,146311-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
4787,147303-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4788,147303-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
    preparedStatement.setString(1, data);
    resultSet = preparedStatement.executeQuery();
    IO.writeLine(resultSet.getRow());
}
// Rest of the code remains the same
",good
4789,147010-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4790,147010-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4791,147038-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4792,147038-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4793,147038-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4794,147038-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4795,147038-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4796,147038-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4797,147181-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4798,147181-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4799,147181-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4800,147181-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4801,147181-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4802,146890-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4803,146890-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
4804,146890-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4805,146890-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    String query = ""update users set hitcount=hitcount+1 where name=?"";
    preparedStatement = dbConnection.prepareStatement(query);
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
4806,146890-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4807,147384-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_51b()).badSink(data);
",bad
4808,146436-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4809,146436-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4810,146539-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_prepareStatement_67b()).badSink(dataContainer);
",bad
4811,146539-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
4812,148281-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_executeUpdate_72b()).badSink(dataVector);
",bad
4813,147575-v1.0.0,java,"data = token.substring(3);
",bad
4814,147575-v1.0.0,good,"data = request.getParameter(""id"");
",good
4815,146956-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4816,146956-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4817,146956-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4818,146956-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
4819,146956-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4820,146956-v1.0.0,good,"// Validate and sanitize the data before using it in the prepared statement
String sanitizedData = sanitizeInput(data);
sqlStatement.setString(1, sanitizedData);
",good
4821,146184-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4822,146184-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
",good
4823,146184-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4824,146184-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
4825,146184-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4826,147708-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4827,147708-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4828,147708-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4829,147708-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4830,147708-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4831,147708-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Add input validation to ensure data is safe for SQL query
data = sanitizeInput(data);
",good
4832,147403-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4833,147403-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4834,147403-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4835,147403-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4836,147403-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4837,147403-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4838,146497-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_execute_52b()).badSink(data );
",bad
4839,147801-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeQuery_73b()).badSink(dataLinkedList);
",bad
4840,147801-v1.0.0,good,"PreparedStatement statement = null;
try {
    String query = ""INSERT INTO table (column) VALUES (?)"";
    statement = connection.prepareStatement(query);
    statement.setString(1, data);
    statement.executeUpdate();
} catch (SQLException e) {
    // handle exception
} finally {
    if (statement != null) {
        statement.close();
    }
}
",good
4841,147696-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4842,147696-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4843,147696-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4844,147696-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4845,147696-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4846,147696-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4847,148068-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4848,148068-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4849,148068-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4850,148068-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4851,148183-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4852,148183-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """")); // Remove any potentially harmful characters
",good
4853,148183-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4854,148183-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
for (int i = 0; i < names.length; i++) {
    preparedStatement.setString(1, names[i]);
    preparedStatement.addBatch();
}
int resultsArray[] = preparedStatement.executeBatch();
",good
4855,148183-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4856,148183-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
4857,147766-v1.0.0,java,"(new CWE89_SQL_Injection__listen_tcp_executeBatch_75b()).badSink(dataSerialized);
",bad
4858,146571-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4859,146571-v1.0.0,good,"String id = ""0""; // This value should be obtained from a safe source, such as user input that has been properly sanitized or escaped.
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
4860,148350-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4861,148350-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4862,147987-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_74b()).badSink(dataHashMap);
",bad
4863,140892-v1.0.0,java,"data = request.getParameter(""id"");
...
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setInt(1, id);
",bad
4864,140892-v1.0.0,good,"String data = request.getParameter(""id"");
...
preparedStatement = dBConnection.prepareStatement(""select * from invoices where uid=?"");
preparedStatement.setString(1, data);
",good
4865,147273-v1.0.0,java,"data = request.getParameter(""name"");
",bad
4866,147273-v1.0.0,good,"data = request.getParameter(""name"");
// Add validation or sanitization here to prevent SQL injection
// For example, using prepared statements or parameterized queries
",good
4867,146926-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4868,146926-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before being used in the SQL query
",good
4869,146926-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4870,146926-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4871,146926-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
4872,146926-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4873,146858-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4874,146858-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4875,146931-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
4876,146931-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4877,146931-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4878,146931-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4879,146931-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4880,146931-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly sanitized or validated before using it in the query
",good
4881,146451-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4882,146451-v1.0.0,good,"String sql = ""insert into users (status) values ('updated') where name=?"";
PreparedStatement preparedStatement = dbConnection.prepareStatement(sql);
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
4883,148040-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name='"" + data + ""'"");
",bad
4884,148040-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",good
4885,148040-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4886,148040-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4887,148040-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4888,148040-v1.0.0,good,"String sanitizedData = data.replaceAll(""[^a-zA-Z0-9]"", """");
sqlStatement.setString(1, sanitizedData);
",good
4889,147386-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_executeQuery_53b()).badSink(data);
",bad
4890,146729-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4891,146729-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
4892,147462-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4893,147462-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
    preparedStatement.setString(1, data);
    int rowCount = preparedStatement.executeUpdate();
    IO.writeLine(""Updated "" + rowCount + "" rows successfully."");
} catch (SQLException exceptSql) {
    IO.logger.log(Level.WARNING, ""Error getting database connection"", exceptSql);
} finally {
    // Close resources...
}
",good
4894,147236-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
4895,147236-v1.0.0,good,"if (cookieSources != null && cookieSources.length > 0) {
    data = cookieSources[0].getValue();
    // Validate and sanitize the data here
    data = sanitizeInput(data);
}
",good
4896,148114-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4897,148114-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
4898,148114-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4899,148114-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4900,148114-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4901,146564-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4902,146564-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
4903,146564-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4904,146564-v1.0.0,good,"String id = ""0""; // This should come from a trusted source and be properly sanitized
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, id);
",good
4905,146564-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4906,146564-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
4907,146196-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4908,146196-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
4909,147536-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4910,147536-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4911,148311-v1.0.0,java,"(new CWE89_SQL_Injection__URLConnection_execute_53b()).badSink(data );
",bad
4912,146833-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4913,146833-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.executeUpdate() > 0;
",good
4914,146191-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4915,146191-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
4916,146191-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4917,146191-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
4918,146191-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4919,146191-v1.0.0,good,"for (int i = 0; i < names.length; i++)
{
    sqlStatement.setString(1, names[i]);
    sqlStatement.addBatch();
}
int resultsArray[] = sqlStatement.executeBatch();
",good
4920,147513-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4921,147513-v1.0.0,good,"sqlStatement.setString(1, data);
",good
4922,147513-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4923,147513-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4924,147513-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4925,147513-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""UPDATE users SET status = 'updated' WHERE name = ?"");
sqlStatement.setString(1, data);
",good
4926,147978-v1.0.0,java,"(new CWE89_SQL_Injection__PropertiesFile_prepareStatement_53b()).badSink(data);
",bad
4927,148164-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_54b()).badSink(data );
",bad
4928,148164-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM Users WHERE home = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4929,146432-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_73b()).badSink(dataLinkedList);
",bad
4930,146432-v1.0.0,good,"// Import the necessary libraries
import org.owasp.html.HtmlPolicyBuilder;
import org.owasp.html.PolicyFactory;
import org.owasp.html.Sanitizers;

// Create a policy factory that allows only safe characters
PolicyFactory policy = new HtmlPolicyBuilder().toFactory();

// Sanitize the user input
String sanitizedData = policy.sanitize(data);

// Add the sanitized data to the linked list
dataLinkedList.add(0, sanitizedData);
dataLinkedList.add(1, sanitizedData);
dataLinkedList.add(2, sanitizedData);

// Pass the linked list to the badSink method
(new CWE89_SQL_Injection__console_readLine_executeQuery_73b()).badSink(dataLinkedList);
",good
4931,146917-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4932,146917-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4933,146356-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_prepareStatement_71b()).badSink((Object)data);
",bad
4934,147506-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_execute_74b()).badSink(dataHashMap , request, response );
",bad
4935,147506-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
4936,147106-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4937,147106-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4938,147106-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
4939,147106-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
4940,147106-v1.0.0,java,"data = cookieSources[0].getValue();
sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
4941,147106-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""select * from users where name = ?"");
sqlStatement.setString(1, data);
",good
4942,147093-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
4943,147093-v1.0.0,good,"// Validate and sanitize the data before using it in a SQL query
String sanitizedData = sanitizeInput(cookieSources[0].getValue());
data = sanitizedData;
",good
4944,146269-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_22b()).badSink(data );
",bad
4945,146269-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeUpdate_22b()).goodB2G1Sink(data );
",bad
4946,146269-v1.0.0,good,"PreparedStatement statement = null;
try {
    Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""username"", ""password"");
    statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    e.printStackTrace();
} finally {
    try {
        if (statement != null) {
            statement.close();
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }
}
",good
4947,146201-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeBatch_52b()).badSink(data );
",bad
4948,146201-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (Connection conn = DriverManager.getConnection(url, username, password);
     PreparedStatement pstmt = conn.prepareStatement(query)) {
    pstmt.setString(1, data);
    ResultSet rs = pstmt.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
4949,146676-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4950,146676-v1.0.0,good,"int id = 0; // This should be a variable that is properly sanitized
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, id);
",good
4951,146676-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4952,146676-v1.0.0,good,"String userId = ""0""; // This should be replaced with a dynamic value from a safe source
preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setString(1, userId);
",good
4953,146676-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
4954,146676-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
4955,146417-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_22b()).goodB2G2Sink(data );
",bad
4956,146417-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
4957,146417-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_22b()).badSink(data );
",bad
4958,146417-v1.0.0,good,"String query = ""SELECT * FROM table WHERE column = ?"";
try (PreparedStatement statement = connection.prepareStatement(query)) {
    statement.setString(1, data);
    ResultSet resultSet = statement.executeQuery();
    // process result set
} catch (SQLException e) {
    // handle exception
}
",good
4959,146417-v1.0.0,java,"(new CWE89_SQL_Injection__console_readLine_executeQuery_22b()).goodB2G1Sink(data );
",bad
4960,146417-v1.0.0,good,"PreparedStatement preparedStatement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
preparedStatement.setString(1, data);
ResultSet resultSet = preparedStatement.executeQuery();
",good
4961,147319-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_executeQuery_72b()).badSink(dataVector , request, response );
",bad
4962,146538-v1.0.0,java,"String[] dataArray = new String[5];
dataArray[2] = data;
(new CWE89_SQL_Injection__console_readLine_prepareStatement_66b()).badSink(dataArray);
",bad
4963,146538-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
4964,147994-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
4965,147994-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
4966,147994-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    String query = ""update users set hitcount=hitcount+1 where name=?"";
    preparedStatement = dbConnection.prepareStatement(query);
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // Rest of the code...
}
// Rest of the code...
",good
4967,147994-v1.0.0,java,"String names[] = data.split(""-"");
...
sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i]);
",bad
4968,147994-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
...
sqlStatement.setString(1, names[i].replaceAll(""[';\\-]"", """"));
",good
4969,147974-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4970,147974-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4971,148156-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_22b()).goodB2G2Sink(data);
",bad
4972,148156-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_22b()).badSink(data );
",bad
4973,148156-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE home = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4974,148156-v1.0.0,java,"(new CWE89_SQL_Injection__Property_prepareStatement_22b()).goodB2G1Sink(data);
",bad
4975,148156-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
4976,148342-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4977,148342-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4978,147543-v1.0.0,java,"(new CWE89_SQL_Injection__getParameter_Servlet_prepareStatement_74b()).badSink(dataHashMap , request, response );
",bad
4979,147543-v1.0.0,good,"PreparedStatement pstmt = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
pstmt.setString(1, data);
pstmt.executeUpdate();
",good
4980,146672-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4981,146672-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
4982,146672-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4983,146672-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
4984,146672-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4985,146672-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4986,147724-v1.0.0,java,"data = token.substring(3);
",bad
4987,147724-v1.0.0,good,"data = request.getParameter(""id"");
",good
4988,146703-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4989,146703-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4990,146703-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4991,146703-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4992,146703-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4993,146703-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4994,147908-v1.0.0,java,"data = readerBuffered.readLine();
...
dataContainer.containerOne = data;
...
(new CWE89_SQL_Injection__listen_tcp_prepareStatement_67b()).badSink(dataContainer);
",bad
4995,147908-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    String query = ""INSERT INTO table (column) VALUES (?)"";
    preparedStatement = connection.prepareStatement(query);
    preparedStatement.setString(1, data);
    preparedStatement.executeUpdate();
} catch (SQLException e) {
    // Handle exception
} finally {
    if (preparedStatement != null) {
        preparedStatement.close();
    }
}
",good
4996,147929-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
4997,147929-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
4998,147929-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
4999,147929-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
5000,147929-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5001,147929-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change to
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
5002,147534-v1.0.0,java,"data = request.getParameter(""name"");
",bad
5003,147534-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM users WHERE name = ?"");
pstmt.setString(1, data);
",good
5004,146665-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5005,146665-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5006,146665-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5007,146665-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
5008,146665-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5009,146665-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5010,146770-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5011,146770-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5012,146770-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5013,146770-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
5014,146770-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5015,146328-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5016,146328-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5017,146328-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5018,146328-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5019,146328-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5020,146328-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5021,147434-v1.0.0,java,"data = properties.getProperty(""data"");
baseObject.action(data);
",bad
5022,147529-v1.0.0,java,"data = request.getParameter(""name"");
badSink(data , request, response );
",bad
5023,147529-v1.0.0,good,"public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws SQLException {
    String sql = ""SELECT * FROM users WHERE name = ?"";
    try (Connection conn = DriverManager.getConnection(dbUrl, username, password);
         PreparedStatement pstmt = conn.prepareStatement(sql)) {
        pstmt.setString(1, data);
        ResultSet rs = pstmt.executeQuery();
        // process the result set
    }
}
",good
5024,146857-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5025,146857-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Ensure data is properly escaped or parameterized to prevent SQL injection
",good
5026,146857-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5027,146857-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5028,146857-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5029,146857-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5030,146979-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeUpdate_53b()).badSink(data );
",bad
5031,146979-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
statement.setString(1, data);
statement.executeUpdate();
",good
5032,146850-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5033,146850-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5034,146850-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5035,146850-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5036,146850-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5037,146850-v1.0.0,good,"// Use parameterized queries to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
5038,147178-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5039,147178-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
5040,147178-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5041,147178-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
5042,147178-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5043,146866-v1.0.0,java,"(new CWE89_SQL_Injection__Environment_prepareStatement_51b()).badSink(data);
",bad
5044,146866-v1.0.0,good,"PreparedStatement pstmt = conn.prepareStatement(""SELECT * FROM table WHERE column = ?"");
pstmt.setString(1, data);
ResultSet rs = pstmt.executeQuery();
",good
5045,146477-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5046,146477-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5047,146477-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5048,146477-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
Boolean result = pstmt.execute();
",good
5049,146477-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5050,146477-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
5051,146728-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
5052,146728-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
5053,148127-v1.0.0,java,"(new CWE89_SQL_Injection__Property_execute_54b()).badSink(data );
",bad
5054,148071-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5055,148071-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5056,148071-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
5057,148071-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5058,148071-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
5059,146551-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
5060,146551-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
5061,146551-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
5062,146551-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
5063,146551-v1.0.0,java,"preparedStatement = connection.prepareStatement(""select name from users where id=0"");
",bad
5064,146551-v1.0.0,good,"preparedStatement = connection.prepareStatement(""select name from users where id=?"");
preparedStatement.setInt(1, 0);
",good
5065,146524-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5066,146524-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5067,146524-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5068,146524-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5069,146524-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5070,146524-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, sanitizeInput(data));
",good
5071,147248-v1.0.0,java,"(new CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_75b()).badSink(dataSerialized , request, response );
",bad
5072,147306-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
5073,147306-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
5074,146265-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5075,146265-v1.0.0,good,"// Use parameterized query to prevent SQL injection
sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5076,146265-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5077,146265-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values (?) where name=?"");
preparedStatement.setString(1, ""updated"");
preparedStatement.setString(2, data);
int rowCount = preparedStatement.executeUpdate();
",good
5078,146265-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5079,146265-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5080,147596-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
5081,147596-v1.0.0,good,"String id = request.getParameter(""id"");
if (id != null) {
    data = id;
}
",good
5082,147596-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
5083,147596-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
    preparedStatement.setString(1, data);
    resultSet = preparedStatement.executeQuery();
    IO.writeLine(resultSet.getRow());
}
// ... rest of the code
",good
5084,147596-v1.0.0,java,"StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), ""&"");
while (tokenizer.hasMoreTokens())
{
    String token = tokenizer.nextToken();
    if(token.startsWith(""id=""))
    {
        data = token.substring(3);
        break;
    }
}
",bad
5085,147596-v1.0.0,good,"data = request.getParameter(""id"");
",good
5086,146734-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
5087,146734-v1.0.0,good,"data = data.replaceAll(""[^a-zA-Z0-9]"", """");
",good
5088,146734-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
5089,146734-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
5090,146734-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
5091,146734-v1.0.0,good,"sqlStatement.setString(1, sanitizeInput(data));
",good
5092,146935-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_22b()).goodB2G2Sink(data );
",bad
5093,146935-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_22b()).badSink(data );
",bad
5094,146935-v1.0.0,java,"(new CWE89_SQL_Injection__File_executeQuery_22b()).goodB2G1Sink(data);
",bad
5095,146935-v1.0.0,good,"PreparedStatement statement = connection.prepareStatement(""SELECT * FROM table WHERE column = ?"");
statement.setString(1, data);
ResultSet resultSet = statement.executeQuery();
",good
5096,147888-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5097,147888-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5098,147888-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5099,147888-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5100,147888-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5101,147888-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
// Change the above line to:
// sqlStatement.setString(1, sanitizeInput(data));
// where sanitizeInput() is a function that properly escapes the input to prevent SQL injection.
",good
5102,146677-v1.0.0,java,"Boolean result = sqlStatement.execute(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5103,146677-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
Boolean result = preparedStatement.execute();
",good
5104,148033-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
5105,148033-v1.0.0,java,"resultSet = sqlStatement.executeQuery(""select * from users where name='""+data+""'"");
",bad
5106,148033-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""select * from users where name=?"");
preparedStatement.setString(1, data);
resultSet = preparedStatement.executeQuery();
",good
5107,148033-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""select * from users where name=?"");
sqlStatement.setString(1, data);
",bad
5108,146623-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5109,146623-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5110,146623-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5111,146623-v1.0.0,good,"PreparedStatement preparedStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
preparedStatement.setString(1, data);
int rowCount = preparedStatement.executeUpdate();
",good
5112,146623-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5113,146623-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",good
5114,146776-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5115,146776-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name = ?"");
sqlStatement.setString(1, data);
",good
5116,146776-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5117,146776-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
5118,146776-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
sqlStatement.setString(1, data);
",bad
5119,146178-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
5120,146178-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
5121,146178-v1.0.0,good,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",good
5122,146178-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
5123,146178-v1.0.0,good,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, sanitizeInput(names[i]));
",good
5124,146790-v1.0.0,java,"int rowCount = sqlStatement.executeUpdate(""insert into users (status) values ('updated') where name='""+data+""'"");
",bad
5125,146790-v1.0.0,good,"PreparedStatement pstmt = dbConnection.prepareStatement(""insert into users (status) values ('updated') where name=?"");
pstmt.setString(1, data);
int rowCount = pstmt.executeUpdate();
",good
5126,147238-v1.0.0,java,"data = cookieSources[0].getValue();
",bad
5127,146246-v1.0.0,java,"(new CWE89_SQL_Injection__connect_tcp_executeQuery_72b()).badSink(dataVector);
",bad
5128,146246-v1.0.0,good,"Connection conn = null;
PreparedStatement stmt = null;
try {
    conn = DriverManager.getConnection(""jdbc:mysql://localhost/test"", ""user"", ""password"");
    stmt = conn.prepareStatement(""INSERT INTO table (column) VALUES (?)"");
    stmt.setString(1, data);
    stmt.executeUpdate();
} catch (SQLException e) {
    e.printStackTrace();
} finally {
    if (stmt != null) {
        stmt.close();
    }
    if (conn != null) {
        conn.close();
    }
}
",good
5129,146886-v1.0.0,java,"sqlStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
sqlStatement.setString(1, names[i]);
",bad
5130,146886-v1.0.0,java,"sqlStatement.addBatch(""update users set hitcount=hitcount+1 where name='"" + names[i] + ""'"");
",bad
5131,146886-v1.0.0,good,"PreparedStatement preparedStatement = null;
try {
    dbConnection = IO.getDBConnection();
    preparedStatement = dbConnection.prepareStatement(""update users set hitcount=hitcount+1 where name=?"");
    for (int i = 0; i < names.length; i++) {
        preparedStatement.setString(1, names[i]);
        preparedStatement.addBatch();
    }
    int resultsArray[] = preparedStatement.executeBatch();
    // rest of the code...
}
// rest of the code...
",good
